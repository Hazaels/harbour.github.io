<!DOCTYPE html>
<html lang="en">

<meta charset="utf-8">
<meta name="referrer" content="origin">
<meta name="viewport" content="initial-scale=1">

<meta name="generator" content="hbdoc">
<meta name="keywords" content="Harbour, Clipper, xBase, database, Free Software, GPL, compiler, cross-platform, 32-bit, 64-bit">

<title>Harbour Reference Guide · hbnf contrib</title>

<link rel="stylesheet" href="hbdoc.css">

<body>

<header>
<h1>Harbour Reference Guide<div>hbnf contrib</div></h1>
</header>

<main>

<section id="ft_aaddition">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/aading.txt">Improve this doc</a></span>
<h4><code>ft_AAddition()</code></h4>
<div class="d-ol">Add elements unique of source array to target array</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AAddition( &lt;aList1&gt;, &lt;aList2&gt; [, &lt;lTrimmer&gt; [, &lt;lCaseSens&gt; ] ] ) ;</code><code>&rarr; aNewArray</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aList1&gt; is the primary array.</div>
  <div>&lt;aList2&gt; is the secondary array.</div>
  <div>&lt;lTrimmer&gt; is a logical value denoting whether leading or</div>
  <div>trailing spaces should be included in the comparison. If .T., then ignores spaces in comparison, defaults to .T., .F. includes spaces.</div>
  <div>&lt;lCaseSens&gt; is a logical value denoting case sensitivity.</div>
  <div>If .T., then comparison is sensitive to case, defaults to .T., .F. ignores case.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">An array of the union of aList1 and aList2.</div>
<div class="d-d">Description</div>
<div class="d-it">This function will add the elements unique of aList2 with aList1. It returns a new array including all the elements of aList1 plus the unique elements of aList2.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
aList1 := { &quot;apple&quot;, &quot;orange&quot;, &quot;pear&quot; }
aList2 := { &quot;apple &quot;, &quot;banana&quot;, &quot;PEAR&quot; }

ft_AAddition( aList1, aList2 )
// ignores spaces, sensitive to case
// returns { &quot;apple&quot;, &quot;orange&quot;, &quot;pear&quot;, &quot;banana&quot;, &quot;PEAR&quot; }

ft_AAddition( aList1, aList2, , .F. )
// ignores spaces, not sensitive to case
// returns { &quot;apple&quot;, &quot;orange&quot;, &quot;pear&quot;, &quot;banana&quot; }

ft_AAddition( aList1, aList2, .F. , .F. )
// sensitive to spaces, not sensitive to case
// returns { &quot;apple&quot;, &quot;orange&quot;, &quot;pear&quot;, &quot;apple &quot;, &quot;banana&quot; }
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
</section>

<section id="ft_aavg">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/aavg.txt">Improve this doc</a></span>
<h4><code>ft_AAvg()</code></h4>
<div class="d-ol">Average numeric values in an array</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AAvg( &lt;aArray&gt; [, &lt;nStartIndex&gt; [, &lt;nEndIndex&gt; ] ] ) &rarr; nAverage</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is the array containing the elements to be averaged.</div>
  <div>&lt;nStartIndex&gt; is the first array item to include, defaults to first element.</div>
  <div>&lt;nEndIndex&gt; is the last array element to include, defaults to all elements.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The average of the specified array elements.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is used to get a numeric average of selected or all elements of an array.</div>
  <div><p>This routine requires ft_ASum().</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_AAvg( aSubTotals )          // Get Average of Entire Array
? ft_AAvg( aSubTotals, 5 )       // Get Average of 5th Element On
? ft_AAvg( aSubTotals, , 10 )    // Get Average of 1st 10 Elements
? ft_AAvg( aSubTotals, 5, 10 )   // Get Average of Elements 5-10
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
</section>

<section id="ft_adessort">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/adessort.txt">Improve this doc</a></span>
<h4><code>ft_ADesSort()</code></h4>
<div class="d-ol">Sort an array in descending order</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ADesSort( &lt;aArray&gt; [, &lt;nStartIndex&gt; [, &lt;nEndIndex&gt; ] ] ) &rarr; aSorted</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is the array to be sorted</div>
  <div>&lt;nStartIndex&gt; is the first array item to include in the sort, defaults to first element</div>
  <div>&lt;nEndIndex&gt; is the last array element to include in the sort, defaults to all elements</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The array, sorted in descending order.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is used to sort an array in descending order, i.e., Z-A</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_ADesSort( aNames )               // Sort the Entire Array

ft_ADesSort( aNames, 5 )            // Sort from the 5th Element On

ft_ADesSort( aNames, , 10 )         // Sort the 1st 10 Elements

ft_ADesSort( aNames, 5, 10 )        // Sort Elements 5-10
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
</section>

<section id="ft_aemaxlen">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/aemaxlen.txt">Improve this doc</a></span>
<h4><code>ft_AEMaxLen()</code></h4>
<div class="d-ol">Find longest element within an array</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AEMaxLen( &lt;aArray&gt; [, &lt;nDimension&gt; [, &lt;nStart&gt; [, &lt;nCount&gt; ] ] ] ) ;</code><code>&rarr; nMaxlen</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is the array containing the elements to be measured.</div>
  <div>&lt;nDimension&gt; is the array dimension to be measured,</div>
  <div>defaults to first dimension.</div>
  <div>&lt;nStart&gt; is the starting array element to include,</div>
  <div>defaults to first array element.</div>
  <div>&lt;nCount&gt; is the number of array elements to process from</div>
  <div>from &lt;nStart&gt;, defaults to remaining elements in array.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The length of the longest size element of an array.</div>
<div class="d-d">Description</div>
<div class="d-it">This function will measure each element of an array dimension and return the longest element.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_AEMaxLen( aArray )          // Measure the 1st dimension of an Array
? ft_AEMaxLen( aArray, 2 )       // Measure the 2nd dimension of an Array
? ft_AEMaxLen( aArray, 2, , 9 )  // Measure Elements 1-9 of the 2nd dimension or subarray
? ft_AEMaxLen( aArray, 3, 5, 9 ) // Measure Elements 5-9 of the 3rd dimension or subarray
? ft_AEMaxLen( aArray, 3, 5 )    // Measure Elements 5 to last in the 3rd dimension or subarray
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_aeminlen">ft_AEMinLen()</a></code></div>
</section>

<section id="ft_aeminlen">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/aeminlen.txt">Improve this doc</a></span>
<h4><code>ft_AEMinLen()</code></h4>
<div class="d-ol">Find shortest element within an array</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AEMinLen( &lt;aArray&gt; [, &lt;nDimension&gt; [, &lt;nStart&gt; [, &lt;nCount&gt; ] ] ] )</code><code>&rarr; nMinlen</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is the array containing the elements to be measured.</div>
  <div>&lt;nDimension&gt; is the array dimension to be measured,</div>
  <div>defaults to first dimension.</div>
  <div>&lt;nStart&gt; is the starting array element to include,</div>
  <div>defaults to first array element.</div>
  <div>&lt;nCount&gt; is the number of array elements to process from</div>
  <div>from &lt;nStart&gt;, defaults to remaining elements in array.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The length of the shortest size element of an array.</div>
<div class="d-d">Description</div>
<div class="d-it">This function will measure each element of an array dimension and return the shortest element.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_AEMinLen( aArray )          // Measure the 1st dimension of an Array
? ft_AEMinLen( aArray, 2 )       // Measure the 2nd dimension of an Array
? ft_AEMinLen( aArray, 2, , 9 )  // Measure Elements 1-9 of 2nd dimension
? ft_AEMinLen( aArray, 3, 5, 9 ) // Measure Elements 5-9 of 3rd dimension
? ft_AEMinLen( aArray, 3, 5 )    // Measure Elements 5 to end of 3rd dimension
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_aemaxlen">ft_AEMaxLen()</a></code></div>
</section>

<section id="ft_amedian">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/amedian.txt">Improve this doc</a></span>
<h4><code>ft_AMedian()</code></h4>
<div class="d-ol">Find middle value in array, or average of two middle values</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AMedian( &lt;aArray&gt; [, &lt;nStart&gt; [, &lt;nEnd&gt; ] ] )</code><code>&rarr; nMedian</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is the array containing the elements to be averaged.</div>
  <div>&lt;nStart&gt; is the first array element to include, defaults to first element.</div>
  <div>&lt;nEnd&gt; is the last array element to include, defaults to last element.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The median average of the array elements</div>
<div class="d-d">Description</div>
<div class="d-it">This function sorts the elements of a numeric array and then returns the value in the middle element of the sorted array.  If there is no exact middle value, then it returns the average of the two middle values.  Half of the elements are &gt; median and half are &lt; median.  A median average may more reflect a more useful average when there are extreme values in the set.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_AMedian( aArray )        // Return Median for entire array
? ft_AMedian( aArray, 2 )     // Return Median for elements from 2 to end
? ft_AMedian( aArray, , 9 )   // Return Median for 1st 9 elements
? ft_AMedian( aArray, 8, 40 ) // Return Median for elements 8 to 40
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
</section>

<section id="ft_anomatches">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/anomatch.txt">Improve this doc</a></span>
<h4><code>ft_ANoMatches()</code></h4>
<div class="d-ol">Find the number of array elements meeting a condition</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ANoMatches( &lt;aArray&gt;, &lt;bCompareBlock&gt; ;</code><code>[, &lt;nStartIndex&gt; [, &lt;nEndIndex&gt; ] ] ) &rarr; nNoOfMatches</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is the array to be searched</div>
  <div>&lt;bCompareBlock&gt; is a code block containing the expression for the array elements to be tested with.  Each element is passed as a parameter to the block.  If the block returns .T., the number of matches will be incremented by one.</div>
  <div>&lt;nStartIndex&gt; is the first array item to include in the search, defaults to first element.</div>
  <div>&lt;nEndIndex&gt; is the last array element to include in the search, defaults to all elements.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The number of elements that cause the code block to return .T.</div>
<div class="d-d">Description</div>
<div class="d-it">This function returns the number of array elements that, when passed to the supplied code block, cause that code block to return a .T. value.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Search the Entire Array
? ft_ANoMatches( aTries, {| x | x &lt;= 100 } )

// Search from the 5th Element On
? ft_ANoMatches( aCodes, {| x | Upper( x ) == cCurrentCode }, 5 )

// Search the 1st 10 Elements
? ft_ANoMatches( aDates, {| x | IS_BETWEEN( Date() - 7, x, Date() + 7 ) }, 10 )

// Search Elements 5-10
? ft_ANoMatches( aNames, {| x | x &lt;= cLastGoodName }, 5, 10 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
</section>

<section id="ft_aredit">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/aredit.txt">Improve this doc</a></span>
<h4><code>ft_ArEdit()</code></h4>
<div class="d-ol">2 dimensional array editing function using TBrowse</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ArEdit( &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt;, &lt;Array Name&gt;, ;</code><code>&lt;nElem&gt;, &lt;aHeadings&gt;, &lt;aBlocks&gt; [, &lt;bGetFunc&gt; ] ) &rarr; xElement</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt; are coordinates for TBrowse</div>
  <div>&lt;Array Name&gt; is name of 2 dimensional to array edit</div>
  <div>&lt;nElem&gt;      is pointer for element in array</div>
  <div>&lt;aHeadings&gt;  is array of column headings</div>
  <div>&lt;aBlocks&gt;    is array of blocks describing each array element</div>
  <div>[ &lt;bGetFunc&gt; ] is get editing function for handling individual elements</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">Value of element positioned on when exit ft_ArEdit() The type of this value depends on what is displayed.</div>
<div class="d-d">Description</div>
<div class="d-it">This function allows you to position yourself in an array, add and delete rows with the &lt;F7&gt; and &lt;F8&gt; keys, and pass a UDF with information to edit the individual gets.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_ArEdit( 3, 5, 18, 75, ar, @nElem, aHeadings, aBlocks )

// This example will allow you to browse a 2 dimensional array
// But you can't edit it since there is no GetBlock UDF
// It allows the user to hit ENTER to select an element or ESC to
// return 0

// This second example shows how to edit a 2 dimensional array
// as might be done to edit an invoice

LOCAL i, ar[ 3, 26 ], aBlocks[ 3 ], aHeadings[ 3 ]
LOCAL nElem := 1, bGetFunc

// Set up two dimensional array &quot;ar&quot;

FOR i := 1 TO 26
   ar[ 1, i ] := i                         //  1  -&gt;  26  Numeric
   ar[ 2, i ] := Chr( Asc( &quot;A&quot; ) + i - 1 ) // &quot;A&quot; -&gt; &quot;Z&quot;  Character
   ar[ 3, i ] := Chr( Asc( &quot;Z&quot; ) - i + 1 ) // &quot;Z&quot; -&gt; &quot;A&quot;  Character
NEXT

// SET UP aHeadings Array for column headings

aHeadings  := { &quot;Numbers&quot;, &quot;Letters&quot;, &quot;Reverse&quot; }

// Need to set up individual array blocks for each TBrowse column

aBlocks[ 1 ] := {|| Str( ar[ 1, nElem ], 2 ) } // prevent default 10 spaces
aBlocks[ 2 ] := {|| ar[ 2, nElem ] }
aBlocks[ 3 ] := {|| ar[ 3, nElem ] }

// set up TestGet() as the passed Get Function so ft_ArEdit() knows how
// to edit the individual gets.

bGetFunc   := {| b, ar, nDim, nElem | TestGet( b, ar, nDim, nElem ) }
SetColor( &quot;N/W, W/N, , , W/N&quot; )
CLS
ft_ArEdit( 3, 5, 18, 75, ar, @nElem, aHeadings, aBlocks, bGetFunc )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
</section>

<section id="ft_asum">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/asum.txt">Improve this doc</a></span>
<h4><code>ft_ASum()</code></h4>
<div class="d-ol">Sum the elements of an array</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ASum( &lt;aArray&gt; [, &lt;nStartIndex&gt; [, &lt;nEndIndex&gt; ] ] ) &rarr; nSum</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is the array containing the elements to be summed.</div>
  <div>&lt;nStartIndex&gt; is the first array item to include, defaults to first element.</div>
  <div>&lt;nEndIndex&gt; is the last array element to include, defaults to all elements.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The sum of the elements of the array or the lengths of the elements.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is to sum the elements of a numeric array or to sum the lengths of a character array.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_ASum( aSubTotals )               // Sum the Entire Array
? ft_ASum( aSubTotals, 5 )            // Sum from the 5th Element On
? ft_ASum( aSubTotals, , 10 )         // Sum the 1st 10 Elements
? ft_ASum( aSubTotals, 5, 10 )        // Sum Elements 5-10
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
</section>

<section id="ft_restarr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/savearr.txt">Improve this doc</a></span>
<h4><code>ft_RestArr()</code></h4>
<div class="d-ol">Restore a Clipper array from a disc file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RestArr( &lt;cFileName&gt;, &lt;nErrorCode&gt; ) &rarr; aArray</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cFileName&gt; is a DOS file name.</div>
  <div>&lt;nErrorCode&gt; will return any DOS file error.</div>
  <div>All arguments are required.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">Return an array variable.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_RestArr() restores an array which was saved to a disc file using ft_SaveArr().</div>
  <div><p>[1992-10-01 Librarian note:</div>
  <div><p>This function does not appear to work with multi-dimensional arrays.  If you'd care to modify it to support this feature, please do and send it to Glenn Scott 71620,1521.]</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
aArray := { ;
   { &quot;Invoice 1&quot;, hb_SToD( &quot;19910415&quot; ), 1234.32, .T. }, ;
   { &quot;Invoice 2&quot;, Date(), 234.98, .F. }, ;
   { &quot;Invoice 3&quot;, Date() + 1, 0, .T. } }
nErrorCode := 0
ft_SaveArr( aArray, &quot;invoice.dat&quot;, @nErrorCode )
IF nErrorCode == 0
   aSave := ft_RestArr( &quot;invoice.dat&quot;, @nErrorCode )
   IF nErrorCode != 0
      ? &quot;Error restoring array&quot;
   ENDIF
ELSE
   ? &quot;Error writing array&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_savearr">ft_SaveArr()</a></code></div>
</section>

<section id="ft_savearr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/savearr.txt">Improve this doc</a></span>
<h4><code>ft_SaveArr()</code></h4>
<div class="d-ol">Save Clipper array to a disc file.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SaveArr( &lt;aArray&gt;, &lt;cFileName&gt;, &lt;nErrorCode&gt; ) &rarr; lRet</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aArray&gt; is any Clipper array except those containing compiled code blocks.</div>
  <div>&lt;cFileName&gt; is a DOS file name.</div>
  <div>&lt;nErrorCode&gt; will return any DOS file error.</div>
  <div>All arguments are required.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">.F. if there was a DOS file error or the array contained code blocks, otherwise returns .T.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_SaveArr() saves any Clipper array, except those containing compiled code blocks, to a disc file.  The array can be restored from the disc file using ft_RestArr().</div>
  <div><p>[1992-10-01 Librarian note:</div>
  <div><p>This function does not appear to work with multi-dimensional arrays.  If you'd care to modify it to support this feature, please do and send it to Glenn Scott 71620,1521.]</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
aArray := { ;
   { &quot;Invoice 1&quot;, hb_SToD( &quot;19910415&quot; ), 1234.32, .T. }, ;
   { &quot;Invoice 2&quot;, Date(), 234.98, .F. }, ;
   { &quot;Invoice 3&quot;, Date() + 1, 0, .T. } }
nErrorCode := 0
ft_SaveArr( aArray, &quot;invoice.dat&quot;, @nErrorCode )
IF nErrorCode == 0
   aSave := ft_RestArr( &quot;invoice.dat&quot;, @nErrorCode )
   IF nErrorCode != 0
      ? &quot;Error restoring array&quot;
   ENDIF
ELSE
   ? &quot;Error writing array&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Array</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_restarr">ft_RestArr()</a></code></div>
</section>

<section id="ft_byt2bit">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/byt2bit.txt">Improve this doc</a></span>
<h4><code>ft_Byt2Bit()</code></h4>
<div class="d-ol">Convert byte to string of 1's and 0's</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Byt2Bit( &lt;cByte&gt; ) &rarr; cBitPattern</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cByte&gt; is the byte to convert.</div>
<div class="d-d">Returns</div>
<div class="d-it">9-character string, consisting of 1's and 0's, representing bits 0 through 7 of parameter byte, with space between bits 3 and 4.  Returns NIL if parameters are faulty.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Can be used to show results of bit manipulation, both before and after. Binary representation follows right-to-left convention of bit position numbering, 0 through 7.  Space between high and low nibbles for clarity and easy comparison to hexadecimal notation.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// These three code lines perform a bitwise AND on bytes with values of
// hb_BChar( 20 ) and hb_BChar( 36 ), and deliver the result as a string
// in binary (bit) format.

? ft_Byt2Bit( hb_BChar( 20 ) )    // byte1: '0001 0100'
? ft_Byt2Bit( hb_BChar( 36 ) )    // byte2: '0010 0100'
? ft_Byt2Bit( ft_ByteAnd( hb_BChar( 20 ), hb_BChar( 36 ) ) )  // result: '0000 0100'
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_byt2hex">ft_Byt2Hex()</a></code></div>
</section>

<section id="ft_byt2hex">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/byt2hex.txt">Improve this doc</a></span>
<h4><code>ft_Byt2Hex()</code></h4>
<div class="d-ol">Convert byte to hexadecimal version of its binary value</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Byt2Hex( cByte ) &rarr; cHexValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cByte&gt; is the byte to convert.</div>
<div class="d-d">Returns</div>
<div class="d-it">Three-character string, consisting of two digits of hexadecimal notation and letter 'h' to signify hex.  Returns NIL if parameters are faulty.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Can be used to show results of bit manipulation, both before and after.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// These three code lines perform a bitwise AND on bytes with values of
// hb_BChar( 20 ) and hb_BChar( 36 ), and deliver the result as a string
// in hexadecimal format, using 'h' to signify hexadecimal.

? ft_Byt2Hex( hb_BChar( 20 ) )    // byte1: '14h'
? ft_Byt2Hex( hb_BChar( 36 ) )    // byte2: '24h'
? ft_Byt2Hex( ft_ByteAnd( hb_BChar( 20 ), hb_BChar( 36 ) ) )  // result: '04h'
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_byt2bit">ft_Byt2Bit()</a></code></div>
</section>

<section id="ft_d2e">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/d2e.txt">Improve this doc</a></span>
<h4><code>ft_D2E()</code></h4>
<div class="d-ol">Convert decimal to scientific notation</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_D2E( &lt;nDec&gt;, &lt;nPrecision&gt; )  &rarr; &lt;cNumE&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nDec&gt;         Decimal number to convert</div>
  <div>&lt;nPrecision&gt;   Number of decimal places in result.</div>
  <div>Defaults to 6 decimal places.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;cNumE&gt;        A string representing a number in</div>
  <div>scientific notation</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Given a decimal number and the desired precision, a string representing the equivalent in scientific notation is returned.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_D2E( 12.345, 2 )     // -&gt; 1.23E1
? ft_D2E( -12.345, 3 )    // -&gt; -1.235E1
? ft_D2E( 0.00000543, 2 ) // -&gt; 5.43E-6
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_e2d">ft_E2D()</a></code></div>
</section>

<section id="ft_dec2bin">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/dectobin.txt">Improve this doc</a></span>
<h4><code>ft_Dec2Bin()</code></h4>
<div class="d-ol">Convert decimal to binary</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Dec2Bin( &lt;nNum&gt; ) &rarr; cBinaryNumber</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nNum&gt; is the numeric expression to be converted.</div>
<div class="d-d">Returns</div>
<div class="d-it">A character string representing &lt;nNum&gt; in binary format.</div>
<div class="d-d">Description</div>
<div class="d-it">This function can be used in conjunction with any bit-wise operations.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Dec2Bin( 255 )         // &quot;11111111&quot;
? ft_Dec2Bin( 2 )           // &quot;00000010&quot;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
</section>

<section id="ft_descend">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/descendn.txt">Improve this doc</a></span>
<h4><code>ft_Descend()</code></h4>
<div class="d-ol">Create a descending index key value</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Descend( &lt;exp&gt; ) &rarr; &lt;value&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;exp&gt; is any expression of character, numeric, date, or logical type.</div>
<div class="d-d">Returns</div>
<div class="d-it">The inverse of &lt;exp&gt;</div>
<div class="d-d">Description</div>
<div class="d-it">This function is a replacement for CA-Cl*pper's Descend() function, which is known to produce memory corruption occassionally.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Descend( 1 )      // Returns -1
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_xtoy">ft_XToY()</a></code></div>
</section>

<section id="ft_e2d">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/e2d.txt">Improve this doc</a></span>
<h4><code>ft_E2D()</code></h4>
<div class="d-ol">Convert scientific notation string to a decimal</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_E2D( &lt;cNumE&gt; )  &rarr; &lt;nDec&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cNumE&gt;   Scientific notation string to convert</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;nDec&gt;    Decimal number</div>
<div class="d-d">Description</div>
<div class="d-it">Given a string in the format  x.yEz, the decimal equivalent is returned.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_E2D( &quot;1.23E1&quot; )   // -&gt; 12.3

? ft_E2D( &quot;-1.235E1&quot; ) // -&gt; -12.35

? ft_D2E( &quot;5.43E-6&quot; )  // -&gt; 0.0000543
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_d2e">ft_D2E()</a></code></div>
</section>

<section id="ft_esccode">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/prtesc.txt">Improve this doc</a></span>
<h4><code>ft_EscCode()</code></h4>
<div class="d-ol">Convert Lotus style escape codes</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_EscCode( &lt;cASCII&gt; )  &rarr; &lt;cPrinterFormat&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cASCII&gt; is the ASCII representation of the printer control codes in Lotus 123 format (e.g. &quot;027E&quot; for hb_BChar( 27 ) + &quot;E&quot;)</div>
  <div>&quot;nnn&quot; will be converted to hb_BChar( nnn ) &quot;\&quot; will be converted to &quot;"</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The binary version of an ASCII coded printer setup string.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful for allowing the user to enter printer control codes in Lotus-style ASCII format, and then having this function convert that code to the format that the printer needs to receive.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
cSetup := &quot;\015&quot;         // default = Epson compressed print
UserInput( @cSetup )     // Let user modify setup code
SET DEVICE TO PRINTER    // get ready to print
?? ft_EscCode( cSetup )  // Output the converted code
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
</section>

<section id="ft_hex2dec">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/hex2dec.txt">Improve this doc</a></span>
<h4><code>ft_Hex2Dec()</code></h4>
<div class="d-ol">Convert a hex number to decimal</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Hex2Dec( &lt;cHexNum&gt; ) &rarr; nDecNum</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cHexNum&gt; is a character string representing a hex number.</div>
<div class="d-d">Returns</div>
<div class="d-it">A decimal number.</div>
<div class="d-d">Description</div>
<div class="d-it">Converts a hexadecimal number to a BASE 10 decimal number. Useful for using ft_int86().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_int86( ft_Hex2Dex( &quot;21&quot; ), aRegs )

// Converts 21h, the Dos Interrupt, to its decimal equivalent,
// 33, for use by ft_int86().
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
</section>

<section id="ft_invclr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/invclr.txt">Improve this doc</a></span>
<h4><code>ft_InvClr()</code></h4>
<div class="d-ol">Get the inverse of a color</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_InvClr( [ &lt;cDsrdColor&gt; ] ) &rarr; cColor</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDsrdColor&gt; is the color to get the inverse of.  Defaults to current color.</div>
<div class="d-d">Returns</div>
<div class="d-it">The inverse of the passed color.</div>
<div class="d-d">Description</div>
<div class="d-it">This function inverts a passed color (in the Clipper format: ??/??), e.g., &quot;W/N&quot; is converted to &quot;N/W&quot;.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_InvClr()             // Get Inverse of Current Color
? ft_InvClr( cErrColor )  // Get Inverse of cErrorColor
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
</section>

<section id="ft_ntow">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/ntow.txt">Improve this doc</a></span>
<h4><code>ft_NToW()</code></h4>
<div class="d-ol">Translate numeric value to words</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NToW( &lt;nNumber&gt; ) &rarr; cWords</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nNumber&gt;  An integer to translate</div>
<div class="d-d">Returns</div>
<div class="d-it">A text string representing &lt;nNumber&gt;</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Translates numeric input to a text string.</div>
  <div><p>ft_NToW() is intended to be used with integers only.  Since I don't know what your application will be, I can't assume the type of fraction you want returned (ninety nine cents, 99/100, .99, etc). If you want the fraction in words, just pass it as an integer.</div>
  <div><p>Do not pass a negative number!  Handle negative numbers any way you need to in your code.  (ie: CR, DB, Negative, Minus, etc.)</div>
  <div><p>Also, numeric 0 is returned as a null string.  You will need to make a decision how to output it (zero dollars, no dollars, etc).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_NToW( 999 )        // -&gt; Nine Hundred Ninety Nine

? ft_NToW( 1000 )       // -&gt; One Thousand

? ft_NToW( 23 ) + &quot; Dollars and &quot; + ft_NToW( 99 ) + &quot; Cents&quot;
      // -&gt; Twenty Three Dollars and Ninety Nine Cents

? ft_NToW( 23 ) + &quot; Dollars and &quot; + &quot;99/100&quot;
      // -&gt; Twenty Three Dollars and 99/100

x      := -23.99
cents  := Str( ( x - Int( x ) ) * 100, 2, 0 ) + &quot;/100&quot;
x      := Int( x )
string := iif( x &lt; 0, &quot;Credit of &quot;, &quot;Debit of &quot; )
? string + ft_NToW( Abs( x ) ) + &quot; Dollars and &quot; + &quot;99/100&quot;
      // -&gt; Credit of Twenty Three Dollars and 99/100
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
</section>

<section id="ft_sqzn">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/sqzn.txt">Improve this doc</a></span>
<h4><code>ft_Sqzn()</code></h4>
<div class="d-ol">Compress a numeric value into a character string</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Sqzn( &lt;nValue&gt; [, &lt;nSize&gt; [, &lt;nDecimals&gt; ] ] ) &rarr; cCompressed</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">nValue       - The numeric value to be compressed nSize        - Optional size of numeric field, defaults to 10 nDecimals    - Optional number of decimal places, defaults to 0</div>
<div class="d-d">Returns</div>
<div class="d-it">cCompressed  - Compressed string, 50% the size of nSize</div>
<div class="d-d">Description</div>
<div class="d-it">The ft_Sqzn() function allows a numeric value to be compressed when stored in the database.  The compression is 50% the storage space of the original number.  The companion function, ft_Unsqzn() returns the original number from the compressed string.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
TRANS-&gt;cust_id := ft_Sqzn( mcust_id, 8 )
TRANS-&gt;amount  := ft_Sqzn( mamount, 12, 2 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_unsqzn">ft_Unsqzn()</a></code></div>
</section>

<section id="ft_stod">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/stod.txt">Improve this doc</a></span>
<h4><code>ft_SToD()</code></h4>
<div class="d-ol">Convert a date string to a Clipper date data type</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SToD( &lt;cDateStr&gt; ) &rarr; dDateType</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDateStr&gt; is a Clipper string in the format &quot;CCYYMMDD&quot;.</div>
<div class="d-d">Returns</div>
<div class="d-it">A Clipper date type.</div>
<div class="d-d">Description</div>
<div class="d-it">This function allows the programmer to hard code a date into the program without knowing what the current date type is.  This function is the converse of the Clipper DToS() function.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_SToD( &quot;19901127&quot; )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
</section>

<section id="ft_unsqzn">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/sqzn.txt">Improve this doc</a></span>
<h4><code>ft_Unsqzn()</code></h4>
<div class="d-ol">Uncompress a numeric compressed by ft_Sqzn()</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Unsqzn( &lt;cCompressed&gt;, &lt;nSize&gt; [, &lt;nDecimals&gt; ] ) &rarr; nValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cCompressed&gt;  - Compressed string, obtained from ft_Sqzn()</div>
  <div>&lt;nSize&gt;        - Size of numeric field</div>
  <div>&lt;nDecimals&gt;    - Optional number of decimal places</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">nValue       - Uncompressed numeric value</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>The ft_Unsqzn() function returns the numeric value from the compressed string.  The compression is 50% the storage space of the original number.  The original number must have been compressed using the ft_Sqzn() function.</div>
  <div><p>This function, along with ft_Sqzn() can be used to reduce disk storage requirements for numeric fields in a database file.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Unsqzn( field-&gt;cust_id, 8 )
? ft_Unsqzn( field-&gt;amount, 12, 2 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_sqzn">ft_Sqzn()</a></code></div>
</section>

<section id="ft_xtoy">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/any2any.txt">Improve this doc</a></span>
<h4><code>ft_XToY()</code></h4>
<div class="d-ol">Convert from any data type to any other data type</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_XToY( &lt;xValueToConvert&gt;, &lt;cTypeToConvertTo&gt; ;</code><code>[, &lt;lWantYesNo&gt; ] ) &rarr; xResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;xValueToConvert&gt; is the value to convert.</div>
  <div>&lt;cTypeToConvertTo&gt; is the type of value to convert to (&quot;C&quot;,&quot;D&quot;,&quot;L&quot;,&quot;N&quot;,&quot;A&quot; or &quot;B&quot;).</div>
  <div>&lt;lWantYesNo&gt; is a logical to signal if 'Y' or 'N' is to be returned if Converting a logical, otherwise '.T.' or '.F.' will be returned for logicals.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The original value converted to the new type.</div>
<div class="d-d">Description</div>
<div class="d-it">This function converts a value of character, date, numeric, logical, array or code block type to any of the other type.  While it is guaranteed to return a value of the correct type, that value may not be meaningful (i.e., converting from a code block returns an Empty() value of the desired type).</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
nNumericValue := ft_XToY( cInputValue, &quot;N&quot; )
lLogicalValue := ft_XToY( nInputValue, &quot;L&quot; )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Conversion</div>
</section>

<section id="ft_acctadj">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/acctadj.txt">Improve this doc</a></span>
<h4><code>ft_AcctAdj()</code></h4>
<div class="d-ol">Adjust beginning or ending fiscal pd. dates to acctg. dates</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AcctAdj( [ &lt;dGivenDate&gt; ], [ &lt;lIsEnd&gt; ] ) &rarr; dDate</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any valid format. Defaults to Date() if not supplied.</div>
  <div>&lt;lIsEnd&gt; is a logical variable. .F. = adjust for beginning of period mode, .T. = adjust for end of period mode.  Defaults to beginning of period mode.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">An adjusted date dependent upon mode and work week start day.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Called by other ft_Acct*() functions. The algorithm is:</div>
  <div><p>Beginning of period mode:</div>
  <div><p>IF dGivenDate is in last 3 days of work week</div>
  <div><p>Return next week's start date</div>
  <div><p>ELSE</div>
  <div><p>Return this week's start date</div>
  <div><p>ENDIF</div>
  <div><p>End of period mode:</div>
  <div><p>IF dGivenDate is in last 4 days of work week</div>
  <div><p>Return this week's end date</div>
  <div><p>ELSE</div>
  <div><p>Return prior week's end date</div>
  <div><p>ENDIF</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
Beginning of period mode (lIsEnd == .F.)

  dDate := hb_SToD( &quot;19910131&quot; )  // In last 3 days of work week
  ? ft_AcctAdj( dDate )        // 1991-02-03 (next week's start)

  dDate := hb_SToD( &quot;19910331&quot; )  // Not in last 3 days of work week
  ? ft_AcctAdj( dDate )        // 1991-03-31 (this week's start)

End of period mode (lIsEnd == .T.)

  dDate := hb_SToD( &quot;19910131&quot; )  // In last 4 days of work week
  ? ft_AcctAdj( dDate, .T. )   // 1991-02-02 (this week's end)

  dDate := hb_SToD( &quot;19910331&quot; )  // Not in last 4 days of work week
  ? ft_AcctAdj( dDate, .T. )   // 1991-03-30 (prior week's end)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_daytobow">ft_DayToBoW()</a></code></div>
</section>

<section id="ft_acctmonth">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/acctmnth.txt">Improve this doc</a></span>
<h4><code>ft_AcctMonth()</code></h4>
<div class="d-ol">Return accounting month data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AcctMonth( [ &lt;dGivenDate&gt; ], [ &lt;nMonthNum&gt; ] ) &rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
  <div>&lt;nMonthNum&gt; is a number from 1 to 12 signifying a month. Defaults to current month if not supplied.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year and month as a character string &quot;YYYYMM&quot; aDateInfo[ 2 ] - The beginning date of the accounting month aDateInfo[ 3 ] - The ending date of the accounting month</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_AcctMonth() creates an array containing data about the accounting month containing the given date.</div>
  <div><p>An accounting period has the following characteristics:</div>
  <div><p>If the first week of the period contains 4 or more 'work' days, it is included in the period; otherwise, the first week was included in the prior period.</div>
  <div><p>If the last week of the period contains 4 or more 'work' days it is included in the period; otherwise, the last week is included in the next period.  This results in 13 week 'quarters' and 4 or 5 week 'months'.  Every 5 or 6 years, a 'quarter' will contain 14 weeks and the year will contain 53 weeks.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// get info about accounting month containing 1990-09-15
aDateInfo := ft_AcctMonth( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  199009       (9th month)
? aDateInfo[ 2 ]   //  1990-09-02   beginning of month 9
? aDateInfo[ 3 ]   //  1990-09-29   end of month 9

// get info about accounting month 5 in year containing 1990-09-15
aDateInfo := ft_AcctMonth( hb_SToD( &quot;19900915&quot; ), 5 )
? aDateInfo[ 1 ]   //  199005
? aDateInfo[ 2 ]   //  1990-04-29   beginning of month 5
? aDateInfo[ 3 ]   //  1990-06-02   end of month 5
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_acctweek">ft_AcctWeek()</a></code>, <code><a href="#ft_acctqtr">ft_AcctQtr()</a></code>, <code><a href="#ft_acctyear">ft_AcctYear()</a></code></div>
</section>

<section id="ft_acctqtr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/acctqtr.txt">Improve this doc</a></span>
<h4><code>ft_AcctQtr()</code></h4>
<div class="d-ol">Return accounting quarter data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AcctQtr( [ &lt;dGivenDate&gt; ], [ &lt;nQtrNum&gt; ] ) &rarr; aDateinfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
  <div>&lt;nQtrNum&gt; is a number from 1 to 4 signifying a quarter. Defaults to current quarter if not supplied.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year and qtr. as a character string &quot;YYYYQQ&quot; aDateInfo[ 2 ] - The beginning date of the accounting quarter aDateInfo[ 3 ] - The ending date of the accounting quarter</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_AcctQtr() creates an array containing data about the accounting quarter containing the given date.</div>
  <div><p>An accounting period has the following characteristics:</div>
  <div><p>If the first week of the period contains 4 or more 'work' days, it is included in the period; otherwise, the first week was included in the prior period.</div>
  <div><p>If the last week of the period contains 4 or more 'work' days it is included in the period; otherwise, the last week is included in the next period.  This results in 13 week 'quarters' and 4 or 5 week 'months'.  Every 5 or 6 years, a 'quarter' will contain 14 weeks and the year will contain 53 weeks.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// get info about accounting month containing 1990-09-15
aDateInfo := ft_AcctQtr( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  199003       (3rd quarter)
? aDateInfo[ 2 ]   //  1990-07-01   beginning of quarter 3
? aDateInfo[ 3 ]   //  1990-09-29   end of quarter 3

// get info about accounting qtr. 2 in year containing 1990-09-15
aDateInfo := ft_AcctQtr( hb_SToD( &quot;19900915&quot; ), 2 )
? aDateInfo[ 1 ]   //  199002
? aDateInfo[ 2 ]   //  1989-04-01   beginning of quarter 2
? aDateInfo[ 3 ]   //  1990-06-30   end of quarter 2
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_acctweek">ft_AcctWeek()</a></code>, <code><a href="#ft_acctmonth">ft_AcctMonth()</a></code>, <code><a href="#ft_acctyear">ft_AcctYear()</a></code></div>
</section>

<section id="ft_acctweek">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/acctweek.txt">Improve this doc</a></span>
<h4><code>ft_AcctWeek()</code></h4>
<div class="d-ol">Return accounting week data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AcctWeek( [ &lt;dGivenDate&gt; ], [ &lt;nWeekNum&gt; ] ) &rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
  <div>&lt;nWeekNum&gt; is a number from 1 to 52 signifying a week. Defaults to current week if not supplied.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year and week as a character string &quot;YYYYWW&quot; aDateInfo[ 2 ] - The beginning date of the accounting week aDateInfo[ 3 ] - The ending date of the accounting week</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_AcctWeek() returns an array containing data about the accounting week containing the given date.</div>
  <div><p>An accounting period has the following characteristics:</div>
  <div><p>If the first week of the period contains 4 or more 'work' days, it is included in the period; otherwise, the first week was included in the prior period.</div>
  <div><p>If the last week of the period contains 4 or more 'work' days it is included in the period; otherwise, the last week is included in the next period.  This results in 13 week 'quarters' and 4 or 5 week 'months'.  Every 5 or 6 years, a 'quarter' will contain 14 weeks and the year will contain 53 weeks.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// get info about accounting week containing 1990-09-15
aDateInfo := ft_AcctWeek( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  199037       (37th week)
? aDateInfo[ 2 ]   //  1990-09-09   beginning of week 37
? aDateInfo[ 3 ]   //  1990-09-15   end of week 37

// get info about accounting week 25 in year containing 1990-09-15
aDateInfo := ft_AcctWeek( hb_SToD( &quot;19900915&quot; ), 25 )
? aDateInfo[ 1 ]   //  199025
? aDateInfo[ 2 ]   //  1989-06-17   beginning of week 25
? aDateInfo[ 3 ]   //  1990-06-23   end of week 25
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_acctmonth">ft_AcctMonth()</a></code>, <code><a href="#ft_acctqtr">ft_AcctQtr()</a></code>, <code><a href="#ft_acctyear">ft_AcctYear()</a></code></div>
</section>

<section id="ft_acctyear">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/acctyear.txt">Improve this doc</a></span>
<h4><code>ft_AcctYear()</code></h4>
<div class="d-ol">Return accounting year data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AcctYear( [ &lt;dGivenDate&gt; ] ) &rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year as a character string &quot;YYYY&quot; aDateInfo[ 2 ] - The beginning date of the accounting year aDateInfo[ 3 ] - The ending date of the accounting year</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_AcctYear() creates an array containing data about the accounting year containing the given date.</div>
  <div><p>An accounting period has the following characteristics:</div>
  <div><p>If the first week of the period contains 4 or more 'work' days, it is included in the period; otherwise, the first week was included in the prior period.</div>
  <div><p>If the last week of the period contains 4 or more 'work' days it is included in the period; otherwise, the last week is included in the next period.  This results in 13 week 'quarters' and 4 or 5 week 'months'.  Every 5 or 6 years, a 'quarter' will contain 14 weeks and the year will contain 53 weeks.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// get info about accounting year containing 1990-09-15
aDateInfo := ft_AcctYear( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  1990
? aDateInfo[ 2 ]   //  1989-12-31    beginning of year
? aDateInfo[ 3 ]   //  1990-12-29    end of year
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_acctweek">ft_AcctWeek()</a></code>, <code><a href="#ft_acctmonth">ft_AcctMonth()</a></code>, <code><a href="#ft_acctqtr">ft_AcctQtr()</a></code></div>
</section>

<section id="ft_addwkdy">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/wda.txt">Improve this doc</a></span>
<h4><code>ft_AddWkDy()</code></h4>
<div class="d-ol">Return true number of days to add given number of workdays</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_AddWkDy( &lt;dStart&gt;, &lt;nWorkDays&gt; ) &rarr; nTrueDays</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dStart&gt; = date to start adding from &lt;nWorkDays&gt; = number of workdays to add</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;nTrueDays&gt; = Number of actual days to add to &lt;dStart&gt; in</div>
  <div>order to add the required &lt;nWorkDays&gt;</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Let's say you are given the problem:</div>
  <div><p>&quot;All invoices are due 10 working days from the date they are printed.  Please display the due date on the invoice.&quot;</div>
  <div><p>When is the due date?  Assuming you are printing the invoices today, your answer is:</div>
  <div><p>dDueDate := Date() + ft_addWkDay( Date(), 10 )</div>
  <div><p>A work day is defined as Monday through Friday.  Unfortunately this routine does <i>not</i> account for holidays.</div>
  <div><p>This documentation was written by Glenn Scott so if it's wrong, blame him.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Postdate 5 working days from the first of January
dPost := hb_SToD( &quot;19910101&quot; )
dPost += ft_AddWkDy( dPost, 5 )   // returns 7 true days
? dPost                           // 1991-01-08
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_workdays">ft_Workdays()</a></code></div>
</section>

<section id="ft_calendar">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/calendar.txt">Improve this doc</a></span>
<h4><code>ft_Calendar()</code></h4>
<div class="d-ol">Display date/time calendar, find a date, return calendar data.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Calendar( [ &lt;nRow&gt; ], [ &lt;nCol&gt; ], [ &lt;cColor&gt; ], [ &lt;lShadow&gt; ] ,</code><code>[ &lt;lShowHelp&gt; ] ) &rarr; aRetVal</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nRow&gt; is an optional screen row for calendar display,</div>
  <div>default row 1.</div>
  <div>&lt;nCol&gt; is an optional screen col for calendar display,</div>
  <div>default col 63.</div>
  <div>&lt;cColor&gt; is an optional color string for displayed messages,</div>
  <div>default is bright white text over green background.</div>
  <div>&lt;lShadow&gt; is an optional logical variable. If true (.T.),</div>
  <div>it uses ft_Shadow() to add a transparent shadow to the display, default (.F.).</div>
  <div>&lt;lShowHelp&gt; is an optional logical variable. If true, uses</div>
  <div>ft_XBox() to display  a four line help message if the F1 key is pressed, default (.F.).</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>aRetVal  is an 8 element array containing date, month, day, year,</div>
  <div>month (in character format), day of the week, julian day and current time.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Calendar() simply displays today's date, time and julian day in a two line display with an optional box shadow. Cursor keys may be used to page through the calendar by day, week, month or year increments. Returns an 8 element array of calendar data:</div>
  <div><p>Element  Value [ 1 ]    Date in current date format. [ 2 ]    Numeric month number. [ 3 ]    Numeric day number. [ 4 ]    Numeric year number. [ 5 ]    Month in character format. [ 6 ]    Day of the week in character format. [ 7 ]    Numeric Julian day. [ 8 ]    Current time in time format.</div>
  <div><p>WARNING: ft_Calendar() uses ft_Shadow() and ft_XBox()</div>
  <div><p>from the Nanforum Toolkit!</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL aRetVal := ft_Calendar( 10, 40, &quot;W+/RB&quot;, .T., .T. )
? aRetVal[ 1 ]      // Result: 1991-04-20
? aRetVal[ 2 ]      // Result:   4
? aRetVal[ 3 ]      // Result:  20
? aRetVal[ 4 ]      // Result:  1991
? aRetVal[ 5 ]      // Result: April
? aRetVal[ 6 ]      // Result: Saturday
? aRetVal[ 7 ]      // Result:        110
? aRetVal[ 8 ]      // Result: 12:45:20
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_dayofyr">ft_DayOfYr()</a></code></div>
</section>

<section id="ft_civ2mil">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/miltime.txt">Improve this doc</a></span>
<h4><code>ft_Civ2Mil()</code></h4>
<div class="d-ol">Convert usual civilian format time to military time.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Civ2Mil( &lt;cCIVTIME&gt; ) &rarr; cMILTIME</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cCIVTIME&gt;  character string of form hh:mm (am,pm,n or m),</div>
  <div>where 0&lt;hh&lt;12.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;cMILTIME&gt;  character string of form hhmm, where 0&lt;=hh&lt;24.</div>
<div class="d-d">Description</div>
<div class="d-it">Converts time from 12-hour civilian format to military.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Civ2Mil( &quot; 5:40 pm&quot; )  // 1740
? ft_Civ2Mil( &quot; 5:40 am&quot; )  // 0540
? ft_Civ2Mil( &quot;12:00 n&quot; )   // 1200
? ft_Civ2Mil( &quot;12:00 m&quot; )   // 0000

// Caution: leading blanks are irrelevant; p,a,n,m must be preceded by
//          one and only one space.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mil2civ">ft_Mil2Civ()</a></code>, <code><a href="#ft_sys2mil">ft_Sys2Mil()</a></code>, <code><a href="#ft_mil2min">ft_Mil2Min()</a></code>, <code><a href="#ft_min2mil">ft_Min2Mil()</a></code></div>
</section>

<section id="ft_datecnfg">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/datecnfg.txt">Improve this doc</a></span>
<h4><code>ft_DateCnfg()</code></h4>
<div class="d-ol">Set beginning of year/week for ft_*() date functions</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DateCnfg( [ &lt;cFYStart&gt; ], [ &lt;nDow&gt; ] ) &rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cFYStart&gt; is a character date string in the user's system date format, i.e., the same as the user would enter for CToD().  If this argument is NIL, the current value is unchanged.</div>
  <div>Note: The year portion of the date string must be present and be a valid year; however, it has no real meaning.</div>
  <div>&lt;nDow&gt; is a number from 1 to 7 (1 = Sunday) indicating the desired start of a work week.  If this argument is NIL, the current value is unchanged.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A 2-element array containing the following information:</div>
  <div>aDateInfo[ 1 ] - an ANSI date string indicating the beginning</div>
  <div>date of the year.  Only the month and day are meaningful.</div>
  <div>aDateInfo[ 2 ] - the number of the first day of the week</div>
  <div>(1 = Sunday)</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_DateCnfg() is called internally by many of the date functions in the library to determine the beginning of year date and beginning of week day.</div>
  <div><p>The default beginning of the year is January 1st and the default beginning of the week is Sunday (day 1).  Either or both of these settings may be changed by calling ft_DateCnfg() with the proper arguments.  They will retain their values for the duration of the program or until they are changed again by a subsequent call to ft_DateCnfg().</div>
  <div><p>It is not necessary to call ft_DateCnfg() unless you need to change the defaults.</div>
  <div><p>ft_DateCnfg() affects the following library functions:</div>
  <div><p>ft_Week()       ft_AcctWeek()       ft_DayToBoW() ft_Month()      ft_AcctMonth()      ft_DayOfYr() ft_Qtr()        ft_AcctQtr()        ft_AcctAdj() ft_Year()       ft_AcctYear()</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Configure library date functions to begin year on
//  July 1st.

Set( _SET_DATEFORMAT, &quot;yyyy-mm-dd&quot; )
ft_DateCnfg( &quot;1980-07-01&quot; )    // year is insignificant

// Examples of return values:

//                                         aArray[ 1 ]   aArray[ 2 ]
//  System date format: American

SET DATE TO AMERICAN
aArray := ft_DateCnfg()                //  &quot;1980.01.01&quot;     1 (Sun.)
aArray := ft_DateCnfg( &quot;07/01/80&quot; )    //  &quot;1980.07.01&quot;     1 (Sun.)
aArray := ft_DateCnfg( &quot;07/01/80&quot;, 2 ) //  &quot;1980.07.01&quot;     2 (Mon.)
aArray := ft_DateCnfg( , 2 )           //  &quot;1980.01.01&quot;     2 (Mon.)

//  System date format: British

SET DATE TO BRITISH
aArray := ft_DateCnfg( &quot;01/07/80&quot;, 2 ) //  &quot;1980.07.01&quot;     2 (Mon.)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_acctadj">ft_AcctAdj()</a></code></div>
</section>

<section id="ft_dayofyr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/dayofyr.txt">Improve this doc</a></span>
<h4><code>ft_DayOfYr()</code></h4>
<div class="d-ol">Return calendar, fiscal or accounting day data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DayOfYr( [ &lt;dGivenDate&gt; ], [ &lt;nDayNum&gt; ], [ &lt;lIsAcct&gt; ] )</code><code>&rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any valid format.  Defaults to current system date if not supplied.</div>
  <div>&lt;nDayNum&gt; is a number from 1 to 371, signifying a day of a year. Defaults to current day if not supplied.</div>
  <div>&lt;lIsAcct&gt; is a logical which specifies the type of year to base the return value on:  .F. = calendar or fiscal year, .T. = accounting year.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>If &lt;nDayNum&gt; is specified:</div>
  <div>aDateInfo[ 1 ] - The date of the specified day number aDateInfo[ 2 ] - The beginning date of the year aDateInfo[ 3 ] - The ending date of the year</div>
  <div>If &lt;nDayNum&gt; is not specified:</div>
  <div>aDateInfo[ 1 ] - The year and day as a character string &quot;YYYYDDD&quot; aDateInfo[ 2 ] - The beginning date of the year aDateInfo[ 3 ] - The ending date of the year</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_DayOfYr() returns an array containing data about a day in the calendar or fiscal year containing the given date.</div>
  <div><p>The beginning of year date defaults to January 1st but may be changed with ft_DateCnfg().</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
aDateInfo := ft_DayOfYr( hb_SToD( &quot;19910331&quot; ) )
? aDateInfo[ 1 ]        // 1991090    (90th day of year 1991)
? aDateInfo[ 2 ]        // 1991-01-01
? aDateInfo[ 3 ]        // 1991-12-31

aDateInfo := ft_DayOfYr( , 90 )    // assume current date is 3/31/91
? aDateInfo[ 1 ]        // 1991-03-31    (90th day of year)
? aDateInfo[ 2 ]        // 1991-01-01
? aDateInfo[ 3 ]        // 1991-12-31

aDateInfo := ft_DayOfYr( , 90, .T. )
? aDateInfo[ 1 ]        // 1991-03-29    (90th day of accounting year)
? aDateInfo[ 2 ]        // 1990-12-30    (1st day of accounting year)
? aDateInfo[ 3 ]        // 1991-12-28    (last day of accounting year)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code></div>
</section>

<section id="ft_daytobow">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/daytobow.txt">Improve this doc</a></span>
<h4><code>ft_DayToBoW()</code></h4>
<div class="d-ol">Calculate no. of days between date and beginning of week</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DayToBoW( [ &lt;dGivenDate&gt; ] ) &rarr; nDays</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dGivenDate&gt; is any valid date in any valid date format. Defaults to current date if not supplied.</div>
<div class="d-d">Returns</div>
<div class="d-it">A positive number of days to beginning of week, range 0 to 6.</div>
<div class="d-d">Description</div>
<div class="d-it">ft_DayToBoW() returns the number of days to the beginning of the week.  Normally this will be one less than the value that would be returned by the Clipper function DoW(), unless the day for the beginning of the week has been changed with ft_DateCnfg().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
dDate := hb_SToD( &quot;19900915&quot; )

? DoW( dDate )               // 7
? CDoW( dDate )              // Saturday
? ft_DayToBoW( dDate )       // 6

// change beginning of week to Friday  (yeah!)
ft_DateCnfg( , 6 )
? DoW( dDate )               // 7
? CDoW( dDate )              // Saturday
? ft_DayToBoW( dDate )       // 1
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_acctweek">ft_AcctWeek()</a></code>, <code><a href="#ft_week">ft_Week()</a></code></div>
</section>

<section id="ft_doy">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/woy.txt">Improve this doc</a></span>
<h4><code>ft_DoY()</code></h4>
<div class="d-ol">Find number of day within year</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DoY( &lt;dDate&gt; ) &rarr; &lt;nResult&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dDate&gt; is a date in the form &quot;mm/dd/yy&quot; or &quot;mm/dd/yyyy&quot;</div>
<div class="d-d">Returns</div>
<div class="d-it">Return numeric position of day within the year. Return NIL if parameter does not conform.</div>
<div class="d-d">Description</div>
<div class="d-it">Finds the day number, considering 01/01 as day 1 Handles dates with CENTURY ON|OFF, to allow for 21st century. Date validation must be external to this function.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// These code fragments find the day number, given a date.

// literal character date
dDate  := hb_SToD( &quot;19910101&quot; )
nDayNum := ft_DoY( dDate )            // result:  1

// presume DOS date to be 1991-01-06
nDayNum := ft_DoY( Date() )           // result:  6

// date input
dDate := hb_SToD()
@ 4, 10 GET cDate                     // input 1991-07-04
READ
nDayNum := ft_DoY( dDate )            // result: 185

// last day of year
nDayNum := ft_DoY( hb_SToD( &quot;19911231&quot; ) ) // result: 365
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
</section>

<section id="ft_easter">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/easter.txt">Improve this doc</a></span>
<h4><code>ft_Easter()</code></h4>
<div class="d-ol">Return the date of Easter</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Easter( &lt;xYear&gt; ) &rarr; dEdate</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">xYear can be a character, date or numeric describing the year for which you wish to receive the date of Easter.</div>
<div class="d-d">Returns</div>
<div class="d-it">The actual date that Easter occurs.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Returns the date of Easter for any year after 1582 up to Clipper's limit which the manual states is 9999, but the Guide agrees with the actual imposed limit of 2999.</div>
  <div><p>This function can be useful in calender type programs that indicate when holidays occur.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Easter( 1990 )     // returns 1990-04-15
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
</section>

<section id="ft_elapmin">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/elapmil.txt">Improve this doc</a></span>
<h4><code>ft_ElapMin()</code></h4>
<div class="d-ol">Return difference, in minutes, between two mil format times.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ElapMin( &lt;cTIME1&gt;, &lt;cTIME2&gt; ) &rarr; nMINUTES</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cTIME1, cTIME2&gt;  character strings of military form &quot;hhmm&quot;,</div>
  <div>where 0&lt;=hh&lt;24.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;nMINUTES&gt;</div>
<div class="d-d">Description</div>
<div class="d-it">Finds the arithmetic difference between time two times (time 2 - time 1). If time 2 is smaller than time 1, a NEGATIVE value is returned.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_ElapMin( &quot;1718&quot;, &quot;2040&quot; )  //  202
? ft_ElapMin( &quot;2040&quot;, &quot;1718&quot; )  // -202
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_eltime">ft_ElTime()</a></code>, <code><a href="#ft_mil2min">ft_Mil2Min()</a></code>, <code><a href="#ft_min2mil">ft_Min2Mil()</a></code></div>
</section>

<section id="ft_elapsed">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/elapsed.txt">Improve this doc</a></span>
<h4><code>ft_Elapsed()</code></h4>
<div class="d-ol">Return elapsed time between two days and/or times</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Elapsed([ &lt;dStart&gt; ], [ &lt;dEnd&gt; ], ;</code><code>&lt;cTimeStart&gt;, &lt;cTimeEnd&gt;) &rarr; aTimedata</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dStart&gt; is any valid date in any date format. Defaults to Date().</div>
  <div>&lt;dEnd&gt; is any valid date in any date format. Defaults to Date().</div>
  <div>&lt;cTimeStart&gt; is a valid Time string of the format 'hh:mm:ss' where hh is hours in 24-hour format.</div>
  <div>&lt;cTimeEnd&gt; is a valid Time string of the format 'hh:mm:ss' where hh is hours in 24-hour format.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">A two-dimensional array containing elapsed time data.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Elapsed() calculates the elapsed time between two Date/Time events.</div>
  <div><p>It returns an array which contains the following data:</div>
  <div><p>aRetVal[ 1, 1 ]  Integer Days      aRetVal[ 1, 2 ] Total Days    (nn.nnnn) aRetVal[ 2, 1 ]  Integer Hours     aRetVal[ 2, 2 ] Total Hours   (nn.nnnn) aRetVal[ 3, 1 ]  Integer Minutes   aRetVal[ 3, 2 ] Total Minutes (nn.nnnn) aRetVal[ 4, 1 ]  Integer Seconds   aRetVal[ 4, 2 ] Total Seconds (nn)</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_Elapsed( 0d19901128, 0d19901130, &quot;08:00:00&quot;, &quot;12:10:30&quot; )

// will return:
? aRetVal[ 1, 1 ] // -&gt;  2 ( Days )        aRetVal[ 1, 2 ] -&gt;    2.1740  Days
? aRetVal[ 2, 1 ] // -&gt;  4 ( Hours )       aRetVal[ 2, 2 ] -&gt;   52.1750  Hours
? aRetVal[ 3, 1 ] // -&gt; 10 ( Minutes )     aRetVal[ 3, 2 ] -&gt; 3130.5000  Minutes
? aRetVal[ 4, 1 ] // -&gt; 30 ( Seconds )     aRetVal[ 4, 2 ] -&gt; 187830     Seconds
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
</section>

<section id="ft_eltime">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/eltime.txt">Improve this doc</a></span>
<h4><code>ft_ElTime()</code></h4>
<div class="d-ol">Compute difference between times in hours, minutes, seconds.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ElTime( &lt;cTime1&gt;, &lt;cTime2&gt; ) &rarr; cDiff</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cTime1, cTime2&gt;  character strings representing times in</div>
  <div>hh:mm:ss format.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;cDiff&gt;  character string representing time difference in</div>
  <div>hh:mm:ss format.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Return the absolute difference between two times in hh:mm:ss format in character hours, minutes and seconds (hh:mm:ss).</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_ElTime( &quot;22:40:12&quot;, &quot;23:55:17&quot; )  // 01:15:05
? ft_ElTime( &quot;23:55:17&quot;, &quot;22:40:12&quot; )  // 01:15:05
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_elapmin">ft_ElapMin()</a></code>, <code><a href="#ft_mil2min">ft_Mil2Min()</a></code>, <code><a href="#ft_min2mil">ft_Min2Mil()</a></code></div>
</section>

<section id="ft_fday">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/firstday.txt">Improve this doc</a></span>
<h4><code>ft_FDay()</code></h4>
<div class="d-ol">Return first day of the month</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FDay( [ &lt;dDateToChk&gt; ] ) &rarr; dFirstDay</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dDateToChk&gt; is a date within a month for which you want to find the first date of that month.  If not passed or is an incorrect type, defaults to current system date.</div>
<div class="d-d">Returns</div>
<div class="d-it">A Clipper date value representing the first date of the month.</div>
<div class="d-d">Description</div>
<div class="d-it">This function will return the first day of the month of the date passed, or the first day of the current month if no argument is supplied.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_FDay( 0d19900915 )        // 1990-09-01
? ft_FDay()                    // 1991-03-01  (current month)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_lday">ft_LDay()</a></code></div>
</section>

<section id="ft_lday">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/lastday.txt">Improve this doc</a></span>
<h4><code>ft_LDay()</code></h4>
<div class="d-ol">Return last day of the month</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_LDay( [ &lt;dDateToChk&gt; ] ) &rarr; dLastDay</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dDateToChk&gt; is a date within a month for which you want to find the last date of that month.  If not passed or is an incorrect type, defaults to current system date.</div>
<div class="d-d">Returns</div>
<div class="d-it">A Clipper date value representing the last date of the month.</div>
<div class="d-d">Description</div>
<div class="d-it">This function will return the last day of the month of the date passed, or the last day of the current month if no argument is supplied.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_LDay( 0d19900915 )        // 1990-09-30
? ft_LDay()                    // 1991-03-31  (current month)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fday">ft_FDay()</a></code></div>
</section>

<section id="ft_madd">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/madd.txt">Improve this doc</a></span>
<h4><code>ft_MAdd()</code></h4>
<div class="d-ol">Add or subtract months to/from a date</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MAdd( [ &lt;dGivenDate&gt; ], [ &lt;nAddMonths&gt; ], [ &lt;lMakeEOM&gt; ] )</code><code>&rarr; dDate</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any date format. Defaults to current system date if not supplied.</div>
  <div>&lt;nAddMonths&gt; is the number of months to be added or subtracted. Defaults to 0 if not supplied.</div>
  <div>&lt;lMakeEOM&gt; is a logical variable indicating whether or not to force the returned date to the last date of the month.  It only affects the returned date if &lt;dGivenDate&gt; is an end-of-month date.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">A date.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_MAdd() adds or subtracts months to/from a given date.</div>
  <div><p>If MakeEOM is passed and dGivenDate is the last day of a month, it will return the EOM of calculated month.  Otherwise it will return the same day as the day of the passed date.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
dDate := 0d19900915
? ft_MAdd( dDate, 1 )        // 1990-10-15
? ft_MAdd( dDate, -2 )       // 1990-07-15

// force EOM
dDate := 0d19910430
? ft_MAdd( dDate, 1 )        // 1991-05-30
? ft_MAdd( dDate, 1, .T. )   // 1991-05-31  &lt;- forced EOM
? ft_MAdd( dDate, 2 )        // 1991-06-30
? ft_MAdd( dDate, 2, .T. )   // 1991-06-30  &lt;- June only has 30 days
? ft_MAdd( dDate, 3 )        // 1991-07-30
? ft_MAdd( dDate, 3, .T. )   // 1991-07-31  &lt;- forced EOM
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_dayofyr">ft_DayOfYr()</a></code>, <code><a href="#ft_daytobow">ft_DayToBoW()</a></code></div>
</section>

<section id="ft_mil2civ">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/miltime.txt">Improve this doc</a></span>
<h4><code>ft_Mil2Civ()</code></h4>
<div class="d-ol">Convert time in military format to civilian format.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Mil2Civ( &lt;cCIVTIME&gt; ) &rarr; dMILTIME</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cMILTIME&gt;  character string of form hhmm, where 0&lt;=hh&lt;24.</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;cCIVTIME&gt;  character string of form hh:mm (am,pm,n or m),</div>
  <div>where 0&lt;hh&lt;12.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Converts time from military to civilian format</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Mil2Civ( &quot;1640&quot; )  //  4:40 pm
? ft_Mil2Civ( &quot;0440&quot; )  //  4:40 am
? ft_Mil2Civ( &quot;1200&quot; )  // 12:00 n
? ft_Mil2Civ( &quot;0000&quot; )  // 12:00 m
? ft_Mil2Civ( &quot;2400&quot; )  // 12:00 m

Caution:  leading blanks are irrelevant.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_civ2mil">ft_Civ2Mil()</a></code>, <code><a href="#ft_sys2mil">ft_Sys2Mil()</a></code>, <code><a href="#ft_mil2min">ft_Mil2Min()</a></code>, <code><a href="#ft_min2mil">ft_Min2Mil()</a></code></div>
</section>

<section id="ft_mil2min">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/miltime.txt">Improve this doc</a></span>
<h4><code>ft_Mil2Min()</code></h4>
<div class="d-ol">Convert time in military format to number of minute of day.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Mil2Min( &lt;cMILTIME&gt; ) &rarr; nMINUTE</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cMILTIME&gt;  character string of form hhmm, where 0&lt;=hh&lt;24.</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;nMINOFDAY&gt;  numeric value representing minute of day.</div>
<div class="d-d">Description</div>
<div class="d-it">Converts time in military format to number of minute of the day.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Mil2Min( &quot;1729&quot; )  // 1049
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_min2mil">ft_Min2Mil()</a></code>, <code><a href="#ft_civ2mil">ft_Civ2Mil()</a></code>, <code><a href="#ft_mil2civ">ft_Mil2Civ()</a></code>, <code><a href="#ft_sys2mil">ft_Sys2Mil()</a></code></div>
</section>

<section id="ft_min2dhm">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/min2dhm.txt">Improve this doc</a></span>
<h4><code>ft_Min2Dhm()</code></h4>
<div class="d-ol">Convert numeric minutes to days, hours and minutes.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Min2Dhm( &lt;nMinutes&gt; ) &rarr; aDHM_</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nMinutes&gt;  the number of minutes.</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;aDHM_&gt;</div>
  <div>where:</div>
  <div>aDHM_[ 1 ] = cDAYS, aDHM_[ 2 ] = cHours, aDHM_[ 3 ] = cMinutes</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Converts numeric minutes into a character array containing days, hours &amp; minutes.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
aDHM_ := ft_Min2Dhm( 16789 )
? aDHM_[ 1 ]  // 11
? aDHM_[ 2 ]  // 15
? aDHM_[ 3 ]  // 49
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
</section>

<section id="ft_min2mil">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/miltime.txt">Improve this doc</a></span>
<h4><code>ft_Min2Mil()</code></h4>
<div class="d-ol">Convert minute of day to military format time.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Min2Mil( &lt;nMINUTE&gt; ) &rarr; cMILTIME</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nMINUTE&gt;  numeric integer representing minute of day.</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;cMILTIME&gt;  character string of form hhmm, where 0&lt;=hh&lt;24.</div>
<div class="d-d">Description</div>
<div class="d-it">Converts minute of the day to military format time.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Min2Mil( 279 )  // 0439
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mil2min">ft_Mil2Min()</a></code>, <code><a href="#ft_mil2civ">ft_Mil2Civ()</a></code>, <code><a href="#ft_civ2mil">ft_Civ2Mil()</a></code>, <code><a href="#ft_sys2mil">ft_Sys2Mil()</a></code></div>
</section>

<section id="ft_month">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/month.txt">Improve this doc</a></span>
<h4><code>ft_Month()</code></h4>
<div class="d-ol">Return Calendar or Fiscal Month Data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Month( [ &lt;dGivenDate&gt; ], [nMonthNum] ) &rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
  <div>&lt;nMonthNum&gt; is a number from 1 to 12 signifying a month. Defaults to current month if not supplied.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year and month as a character string &quot;YYYYMM&quot; aDateInfo[ 2 ] - The beginning date of the month aDateInfo[ 3 ] - The ending date of the month</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Month() returns an array containing data about the month containing the given date.</div>
  <div><p>Normally the return data will be based on a year beginning on January 1st with weeks beginning on Sunday.</div>
  <div><p>The beginning of year date and/or beginning of week day can be changed by using ft_DateCnfg(), which will affect all subsequent calls to ft_Month() until another call to ft_DateCnfg().</div>
  <div><p>The beginning of year date and beginning of week day may be reset to January 1 and Sunday by calling ft_DateCnfg() with no parameters.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// get info about month containing 1990-09-15
aDateInfo := ft_Month( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  199009       (9th month)
? aDateInfo[ 2 ]   //  1990-09-01   beginning of month 9
? aDateInfo[ 3 ]   //  1990-09-30   end of week month 9

// get info about month 5 in year containing 1990-09-15
aDateInfo := ft_Month( hb_SToD( &quot;19900915&quot; ), 5 )
? aDateInfo[ 1 ]   //  199005
? aDateInfo[ 2 ]   //  1990-05-01   beginning of month 5
? aDateInfo[ 3 ]   //  1990-05-31   end of month 5

// get info about month 5 in current year (1991)
aDateInfo := ft_Month( , 5 )
? aDateInfo[ 1 ]   //  199105
? aDateInfo[ 2 ]   //  1991-05-01   beginning of month 5
? aDateInfo[ 3 ]   //  1991-05-31   end of month 5
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_week">ft_Week()</a></code>, <code><a href="#ft_qtr">ft_Qtr()</a></code>, <code><a href="#ft_year">ft_Year()</a></code></div>
</section>

<section id="ft_qtr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/qtr.txt">Improve this doc</a></span>
<h4><code>ft_Qtr()</code></h4>
<div class="d-ol">Return Calendar or Fiscal Quarter Data.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Qtr( [ &lt;dGivenDate&gt; ], [ &lt;nQtrNum&gt; ] ) &rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
  <div>&lt;nQtrNum&gt; is a number from 1 to 4 signifying a quarter. Defaults to current quarter if not supplied.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year and quarter as a character string &quot;YYYYQQ&quot; aDateInfo[ 2 ] - The beginning date of the quarter aDateInfo[ 3 ] - The ending date of the quarter</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Qtr() returns an array containing data about the quarter containing the given date.</div>
  <div><p>Normally the return data will be based on a year beginning on January 1st with weeks beginning on Sunday.</div>
  <div><p>The beginning of year date and/or beginning of week day can be changed by using ft_DateCnfg(), which will affect all subsequent calls to ft_Qtr() until another call to ft_DateCnfg().</div>
  <div><p>The beginning of year date and beginning of week day may be reset to January 1 and Sunday by calling ft_DateCnfg() with no parameters.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// get info about quarter containing 1990-09-15
aDateInfo := ft_Qtr( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  199003       (3rd quarter)
? aDateInfo[ 2 ]   //  1990-07-01   beginning of quarter 3
? aDateInfo[ 3 ]   //  1990-09-30   end of week quarter 3

// get info about quarter 2 in year containing 1990-09-15
aDateInfo := ft_Qtr( hb_SToD( &quot;19900915&quot; ), 2 )
? aDateInfo[ 1 ]   //  199002
? aDateInfo[ 2 ]   //  1990-04-01   beginning of quarter 2
? aDateInfo[ 3 ]   //  1990-06-30   end of quarter 2

// get info about quarter 2 in current year (1991)
aDateInfo := ft_Qtr( , 2 )
? aDateInfo[ 1 ]   //  199102
? aDateInfo[ 2 ]   //  1991-04-01   beginning of quarter 2
? aDateInfo[ 3 ]   //  1991-06-30   end of quarter 2
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_week">ft_Week()</a></code>, <code><a href="#ft_month">ft_Month()</a></code>, <code><a href="#ft_year">ft_Year()</a></code></div>
</section>

<section id="ft_sys2mil">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/miltime.txt">Improve this doc</a></span>
<h4><code>ft_Sys2Mil()</code></h4>
<div class="d-ol">Convert system time to military time format.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Sys2Mil() &rarr; cMILTIME</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">none</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;cMILTIME&gt;  character string of form hhmm, where 0&lt;=hh&lt;24.</div>
<div class="d-d">Description</div>
<div class="d-it">Return current system time as character string in military format.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Sys2Mil()  // 1623
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mil2civ">ft_Mil2Civ()</a></code>, <code><a href="#ft_civ2mil">ft_Civ2Mil()</a></code></div>
</section>

<section id="ft_week">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/week.txt">Improve this doc</a></span>
<h4><code>ft_Week()</code></h4>
<div class="d-ol">Return calendar or fiscal week data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Week( [ &lt;dGivenDate&gt; ], [ &lt;nWeekNum&gt; ] ) &rarr; aDateinfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
  <div>&lt;nWeekNum&gt; is a number from 1 to 53 signifying a week. Defaults to current week if not supplied.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year and week as a character string &quot;YYYYWW&quot; aDateInfo[ 2 ] - The beginning date of the week aDateInfo[ 3 ] - The ending date of the week</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Week() returns an array containing data about the week containing the given date.</div>
  <div><p>Normally the return data will be based on a year beginning on January 1st with weeks beginning on Sunday.</div>
  <div><p>The beginning of year date and/or beginning of week day can be changed by using ft_DateCnfg(), which will affect all subsequent calls to ft_Week() until another call to ft_DateCnfg().</div>
  <div><p>The beginning of year date and beginning of week day may be reset to January 1 and Sunday by calling ft_DateCnfg() with no parameters.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// get info about week containing 1990-09-15
aDateInfo := ft_Week( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  199037       (37th week)
? aDateInfo[ 2 ]   //  1990-09-09   beginning of week 37
? aDateInfo[ 3 ]   //  1990-09-15   end of week 37

// get info about week 25 in year containing 1990-09-15
aDateInfo := ft_Week( hb_SToD( &quot;19900915&quot; ), 25 )
? aDateInfo[ 1 ]   //  199025
? aDateInfo[ 2 ]   //  1990-06-17   beginning of week 25
? aDateInfo[ 3 ]   //  1990-06-23   end of week 25

// get info about week 25 in current Year( 1991 )
aDateInfo := ft_Week( , 25 )
? aDateInfo[ 1 ]   //  199025
? aDateInfo[ 2 ]   //  1991-06-16   beginning of week 25
? aDateInfo[ 3 ]   //  1991-06-22   end of week 25
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_month">ft_Month()</a></code>, <code><a href="#ft_qtr">ft_Qtr()</a></code>, <code><a href="#ft_year">ft_Year()</a></code>, <code><a href="#ft_daytobow">ft_DayToBoW()</a></code></div>
</section>

<section id="ft_workdays">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/workdays.txt">Improve this doc</a></span>
<h4><code>ft_Workdays()</code></h4>
<div class="d-ol">Return number of work days between two dates</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Workdays( [ &lt;dStart&gt; ], [ &lt;dStop&gt; ] ) &rarr; nDays</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dStart&gt; is the beginning value for the date range.</div>
  <div>&lt;dStop&gt; is the ending value for the date range.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The number of work days (Monday through Friday) between two dates.</div>
<div class="d-d">Description</div>
<div class="d-it">ft_Workdays() returns a number indicating the number of work days between two dates.  Work days are considered Monday through Friday. (The five day work week none of us Clipper programmers have.)</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Workdays( hb_SToD( &quot;19910516&quot; ), hb_SToD( &quot;19910520&quot; ) ) // 3  (Th - Mo)
? ft_Workdays( hb_SToD( &quot;19910518&quot; ), hb_SToD( &quot;19910519&quot; ) ) // 0  (Sa - Su)
? ft_Workdays( hb_SToD( &quot;19910517&quot; ), hb_SToD( &quot;19910517&quot; ) ) // 1  (Fr - Fr)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
</section>

<section id="ft_woy">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/woy.txt">Improve this doc</a></span>
<h4><code>ft_WoY()</code></h4>
<div class="d-ol">Find number of week within year</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_WoY( &lt;dDate&gt; ) &rarr; &lt;nResult&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dDate&gt; is a date in the form &quot;mm/dd/yy&quot; or &quot;mm/dd/yyyy&quot;</div>
<div class="d-d">Returns</div>
<div class="d-it">Return numeric position of week within the year or NIL if parameter does not conform.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Considers a full week as starting on Sunday, ending on Saturday. First week of year (week 1) may start on any day, and thus</div>
  <div><p>contain any number of days.</div>
  <div><p>Final week of year (week 53) may contain any number of days. Handles dates with CENTURY ON|OFF, to allow for 21st century. Date validation must be external to this function.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// These code fragments find the week number, given a date.

// literal character date
dDate  := hb_SToD( &quot;19910101&quot; )
nWkNum := ft_WoY( dDate )            // result:  1

// presume DOS date to be 1991-01-06
nWkNum := ft_WoY( Date() )           // result:  2

// date input
dDate := hb_SToD()
@ 4, 10 GET cDate                    // input 1991-07-04
READ
nWkNum := ft_WoY( dDate )            // result: 27

// last day of year
nWkNum := ft_WoY( hb_SToD( &quot;19911231&quot; ) ) // result: 53
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
</section>

<section id="ft_year">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/year.txt">Improve this doc</a></span>
<h4><code>ft_Year()</code></h4>
<div class="d-ol">Return calendar or fiscal year data</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Year( [ &lt;dGivenDate&gt; ] ) &rarr; aDateInfo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;dGivenDate&gt; is any valid date in any date format.  Defaults to current system date if not supplied.</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A three element array containing the following data:</div>
  <div>aDateInfo[ 1 ] - The year as a character string &quot;YYYY&quot; aDateInfo[ 2 ] - The beginning date of the year aDateInfo[ 3 ] - The ending date of the year</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Year() returns an array containing data about the year containing the given date.</div>
  <div><p>Normally the return data will be based on a year beginning on January 1st.</div>
  <div><p>The beginning of year date can be changed by using ft_DateCnfg(), which will affect all subsequent calls to ft_Year() until another call to ft_DateCnfg().</div>
  <div><p>The beginning of year date may be reset to January 1 by calling ft_DateCnfg() with no parameters.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Get info about year containing 1990-09-15, assuming default
// beginning of year is January 1st.
aDateInfo := ft_Year( hb_SToD( &quot;19900915&quot; ) )
? aDateInfo[ 1 ]   //  1990
? aDateInfo[ 2 ]   //  1990-01-01   beginning of year
? aDateInfo[ 3 ]   //  1990-12-31   end of year

// get info about current year (1991).
aDateInfo := ft_Year()
? aDateInfo[ 1 ]   //  1991
? aDateInfo[ 2 ]   //  1991-01-01   beginning of year
? aDateInfo[ 3 ]   //  1991-12-31   end of year
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Date/Time</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_datecnfg">ft_DateCnfg()</a></code>, <code><a href="#ft_week">ft_Week()</a></code>, <code><a href="#ft_month">ft_Month()</a></code>, <code><a href="#ft_qtr">ft_Qtr()</a></code></div>
</section>

<section id="ft_chdir">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/chdir.txt">Improve this doc</a></span>
<h4><code>ft_ChDir()</code></h4>
<div class="d-ol">Change the current directory</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ChDir( &lt;cDirName&gt; ) &rarr; nResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDirName&gt; is the name of the desired directory.</div>
<div class="d-d">Returns</div>
<div class="d-it">0  if successful 3  if path not found 99 if invalid parameters passed</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Use this function if you prefer to change the active directory instead of relying on the SET PATH command.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_ChDir( &quot;harbour&quot; )
? ft_ChDir( hb_ps() )
? ft_ChDir( &quot;..&quot; + hb_ps() + &quot;hbnf&quot; )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_default">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/default.txt">Improve this doc</a></span>
<h4><code>ft_Default()</code></h4>
<div class="d-ol">Retrieve and optionally change the current default drive</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Default( [ &lt;cDrive&gt; ] ) &rarr; cDrive</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDrive&gt; is optional, and if specified is the new default drive.</div>
<div class="d-d">Returns</div>
<div class="d-it">The current default drive.  If a change of default drive is requested, the return value is the drive AFTER the change is made.  This allows you to make sure you specified a valid drive (i.e. if you attempt to change the default drive, and the function returns a different drive letter than the one you specified, then the drive does not exist).</div>
<div class="d-d">Description</div>
<div class="d-it">Useful any time you need to know or change the default drive.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
cDrive := ft_Default()  // Get the current drive
ft_Default( &quot;C&quot; )       // Switch to drive C

IF !( ft_Default( &quot;E&quot; ) == &quot;E&quot; )
   ? &quot;Drive E does not exist!&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_dosver">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/dosver.txt">Improve this doc</a></span>
<h4><code>ft_DosVer()</code></h4>
<div class="d-ol">Return the current DOS major and minor version as a string</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DosVer() &rarr; &lt;cVersion&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">A character string with the major version number first, a period (&quot;.&quot;), then the minor version number (e.g., &quot;3.30&quot;)</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_DosVer() invokes DOS interrupt 21h, service 30 in order to return the current DOS version.  It does this by setting up an array corresponding to machine registers and then calling the toolkit function ft_int86().</div>
  <div><p>It returns a character string corresponding to the DOS version, as follows:  The major version, a period (&quot;.&quot;), then the minor version.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? &quot;OS version:&quot;, ft_DosVer()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_dskfree">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/diskfunc.txt">Improve this doc</a></span>
<h4><code>ft_DskFree()</code></h4>
<div class="d-ol">Return the amount of available disk space</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DskFree( [ &lt;cDrive&gt; ] ) &rarr; nSpaceAvail</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDrive&gt; is the fixed disk to query. If no parameter is passed the operation will be performed on the default drive.  Do not include the &quot;:&quot;.</div>
<div class="d-d">Returns</div>
<div class="d-it">Integer representing the available disk space in bytes.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Function to return the available space on the passed drive letter or the default drive if no drive is passed.</div>
  <div><p>Uses ft_int86() through the internal function _ftDiskInfo().</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_DskFree()  // Returns free space on default drive.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_dsksize">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/diskfunc.txt">Improve this doc</a></span>
<h4><code>ft_DskSize()</code></h4>
<div class="d-ol">Return the maximum capacity of a fixed disk</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DskSize( [ &lt;cDrive&gt; ] ) &rarr; nMaxCapacity</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDrive&gt; is the fixed disk to query. If no drive is sent, the operation will be performed on the default drive. Send without the &quot;:&quot;.</div>
<div class="d-d">Returns</div>
<div class="d-it">An integer representing the maximum disk capacity in bytes.</div>
<div class="d-d">Description</div>
<div class="d-it">Function utilizing ft_int86() to return Maximum Disk Size. Uses ft_int86() through the internal function _ftDiskInfo().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_DskSize()      // Maximum capacity for default drive
? ft_DskSize( &quot;D&quot; ) // Maximum capacity for Drive D:
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_floptst">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/floptst.txt">Improve this doc</a></span>
<h4><code>ft_FlopTst()</code></h4>
<div class="d-ol">Test diskette drive status</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FlopTst( &lt;cDirectory|nDrive&gt; ) &rarr; nStatus</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nDrive&gt; is the diskette drive number, 0 = A:, 1 = B:</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>-1 - Wrong Parameters</div>
  <div>0 - Drive Loaded and ready to read or write 1 - Drive Door Open or Diskette inserted upside down 2 - Diskette is unformatted 3 - Write protected 4 - Undetermined</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_FlopTst() is designed as a full replacement for ISDRIVE().  Where ISDRIVE() returns just .T. or .F. depending if the diskette drive is ready or not, ft_FlopTst() returns a numeric code designating the diskette drive's status.</div>
  <div><p>ft_FlopTst() is particularly useful in backup and restore programs that need to test the floppy drive before writing/reading from a floppy disk.</div>
  <div><p>No testing has been performed on systems with more than 2 floppy drives.  If the third drive is &quot;C&quot; and the fourth &quot;D&quot; then there should be no problems.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
iStatus := ft_FlopTst( &quot;A:&quot; )
DO CASE
CASE iStatus == 1
   ? &quot;The door to drive A is open.&quot;
CASE iStatus == 2
   ? &quot;The diskette in drive A is not formatted.&quot;
CASE iStatus == 3
   ? &quot;The diskette in drive A is write-protected.&quot;
CASE iStatus == 4
   ? &quot;Something is wrong with drive A, but I don't know what.&quot;
ENDCASE
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_inp">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/inp.txt">Improve this doc</a></span>
<h4><code>ft_inp()</code></h4>
<div class="d-ol">Retrieve a byte from a specified I/O port</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_inp( &lt;nPort&gt; ) &rarr; nValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nPort&gt; is the port from which to retrieve the byte.  If it is invalid in any way, the function will return zero.</div>
<div class="d-d">Returns</div>
<div class="d-it">The byte retrieved.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>It may sometimes be useful to read a byte from a port without having to resort to C or assembler.  This function allows you to do so.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_inp( 100 )   // read a byte from port 100 (064h)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_outp">ft_outp()</a></code></div>
</section>

<section id="ft_int86">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/cint86.txt">Improve this doc</a></span>
<h4><code>ft_int86()</code></h4>
<div class="d-ol">Execute a software interrupt</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_int86( &lt;nInterruptNumber&gt;, &lt;aRegisterValues&gt; ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nInterruptNumber&gt; is the interrupt to execute.</div>
  <div>&lt;aRegisterValues&gt; is an array that contains values to be loaded into the various CPU registers.  The correspondence between registers and array elements is as follows:</div>
  <div>aElement[ 1 ]  ==  AX register aElement[ 2 ]  ==  BX register aElement[ 3 ]  ==  CX register aElement[ 4 ]  ==  DX register aElement[ 5 ]  ==  SI register aElement[ 6 ]  ==  DI register aElement[ 7 ]  ==  BP register aElement[ 8 ]  ==  DS register aElement[ 9 ]  ==  ES register aElement[ 10 ] ==  Flags register</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>.T. if all parameters valid and the function was able</div>
  <div>to execute the desired interrupt.</div>
  <div>.F. if invalid parameters passed.  If you call this function in</div>
  <div>protected mode, .F. may also be returned if an allocation of low DOS memory fails.</div>
  <div>n addition, the array elements will contain whatever values were in he CPU registers immediately after the interrupt was executed.  If ither of the string parameters were altered by the interrupt, these hanges will be reflected as well.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>It is occasionally useful to be able to call interrupts directly from Clipper, without having to write a separate routine in C or ASM.  This function allows you that capability.</div>
  <div><p>Given Clipper's high-level orientation, this function is necessarily somewhat messy to use.  First, declare an array of ten elements to hold the eight values for the CPU registers and two string parameters. Then initialize the array elements with the values that you want the CPU registers to contain when the interrupt is executed.  You need not initialize all the elements.  For example, if the interrupt requires you to specify values for AX, DX, and DS, you would only need to initialize elements 1, 4, and 8.</div>
  <div><p>Once you have done the required register setup, call ft_int86(), passing the interrupt number and the register array as parameters. The function will load the CPU with your specified values, execute the interrupt, and then store the contents of the CPU registers back into your array.  This will allow you to evaluate the results of the interrupt.</div>
  <div><p>Some interrupt services require you to pass the address of a string in a pair of registers.  This function is capable of handling these sorts of situations, but it will take a little work on your part.  If you need to pass a string that uses the DS register, store the string in element 8;  if you need to pass a string that uses the ES register, store the string in element 9.  ft_int86() will detect that you've supplied a string instead of a numeric value and will behave accordingly.</div>
  <div><p>That takes care of obtaining the segment portion of the pointer.  To specify which register is to contain the offset, use the values REG_DS and REG_ES which are defined in the ftint86.ch file.  When one of these values is found in an array element, it alerts ft_int86() to use the offset portion of a pointer instead of a numeric value.  REG_DS tells ft_int86() to use the offset of the string in element 8, while REG_ES tells ft_int86() to use the offset of the string in element 9.</div>
  <div><p>All the CPU registers are sixteen bits in size.  Some, however, are also split into two 8-bit registers.  This function is only capable of receiving and returning registers that are 16 bits in size.  To split a 16-bit register into two 8-bit values, you can use the pseudo-functions HighByte() and LowByte(), contained in the .ch file.</div>
  <div><p>To alter an 8-bit number so it will appear in the high-order byte of a register when passed to the ft_int86() function, use the MakeHI() pseudo-function contained in the .ch file.</div>
  <div><p>When run in real mode, this function is a shell for __ftint86(), which is written in assembler and does the actual work of executing the interrupt.  __ftint86() is callable from C, so feel free to incorporate it into any C routines for which it might be useful.  The source for __ftint86() can be found in the file AINT86.ASM.</div>
  <div><p>When run in protected mode, this function is a shell for cpmiInt86(), which is written in assembler and makes a DPMI call to drop into real mode and execute the interrupt.  cpmiInt86() is also callable from C, so feel free to incorporate it into any C routines for which it might be useful.  cpmiInt86() is part of the CPMI API.  See the CPMI documentation for more information.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This example shows how to call the DOS &quot;create file&quot; service.  Take
// special note of how to set up string parameters.

#include &quot;ftint86.ch&quot;

LOCAL aRegs[ 10 ]            // Declare the register array
aRegs[ AX ] := makehi( 60 )  // DOS service, create file
aRegs[ CX ] := 0             // Specify file attribute

// Pay attention here, this is crucial.  Note how to set up the string
// so it appears in DS:DX.

aRegs[ DS ] := &quot;my_file.ext&quot;
aRegs[ DX ] := REG_DS
ft_int86( 33, aRegs )        // Make the call to the DOS interrupt


// This example shows how to call the DOS &quot;get current directory&quot;
// service.  This one also uses a string parameter, but note that it
// uses a different offset register.

#include &quot;ftint86.ch&quot;

LOCAL aRegs[ 10 ]
aRegs[ AX ] := makehi( 71 )
aRegs[ DX ] := 0           // Choose default drive

// This service requires a 64-byte buffer whose address is in DS:SI.  DOS
// will fill the buffer with the current directory.

aRegs[ DS ] := Space( 64 )
aRegs[ SI ] := REG_DS
ft_int86( 33, aRegs )

? aRegs[ DS ]       // Display the directory name


// For the sake of completeness, here's an example that doesn't use a
// string.  This one changes the video mode.

#include &quot;ftint86.ch&quot;

LOCAL aRegs[ 10 ]

aRegs[ AX ] := 16          // Choose hi-res graphics
ft_int86( 16, aRegs )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_iamidle">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/iamidle.txt">Improve this doc</a></span>
<h4><code>ft_IAmIdle()</code></h4>
<div class="d-ol">Inform the operating system that the application is idle.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_IAmIdle() &rarr; lSuccess</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if supported, .F. otherwise.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Some multitasking operating environments (e.g. Windows or OS/2) can function more efficiently when applications release the CPU during idle states.  This function allows you &quot;announce&quot; to the operating system that your application is idle.</div>
  <div><p>Note that if you use this function in conjunction with ft_OnIdle(), you can cause Clipper to automatically release the CPU whenever Clipper itself detects an idle state.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
DO WHILE Inkey() != K_ESC
   ft_IAmIdle()         // Wait for ESC and announce idleness
ENDDO

// Here's another way to do it:

ft_OnIdle( {|| ft_IAmIdle() } )

Inkey( 0 )              // Automatically reports idleness until key is pressed!
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_onidle">ft_OnIdle()</a></code></div>
</section>

<section id="ft_isprint">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/isprint.txt">Improve this doc</a></span>
<h4><code>ft_IsPrint()</code></h4>
<div class="d-ol">Check printer status</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_IsPrint( [ &lt;cDevice&gt; ] ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDevice&gt; is optional and is the device to test (LPT2, COM1, etc.). If omitted, the function will default to the PRN device.</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>.T.  if device is ready for output. .F.  if one of the following conditions occurs:</div>
  <div>1)  The device is not ready. 2)  The device does not exist. 3)  DOS couldn't open the device for some reason</div>
  <div>(such as no file handles available).</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>The Clipper IsPrinter() function is somewhat limited because it only works with LPT1.  Furthermore, it talks directly to the hardware, so if you have redirected LPT1 via the DOS MODE command, the IsPrinter() function will return erroneous results.</div>
  <div><p>This function offers a better alternative.  Instead of talking to the hardware, it issues a DOS call that checks to see if the device is ready or not.  That gives DOS an opportunity to deal with any redirections, and since you pass the device name as a parameter, you can test any device, not just LPT1 (note that the function defaults to PRN if you fail to pass a valid parameter).</div>
  <div><p>The function also temporarily traps the DOS critical error handler so you don't get any nasty error messages if the device isn't ready.  It restores the old critical error handler before exiting.</div>
  <div><p>Note that although this function is mainly designed for testing printers, you can also check to see if a drive is ready.  Since DOS thinks the NUL device exists on every drive, you can pass a drive letter followed by NUL as a parameter.  If DOS is able to open the NUL device, then the drive is ready, otherwise the door is open or something else is wrong.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ! ft_IsPrint()
   ? &quot;PRN is not ready!&quot;
ENDIF

IF ! ft_IsPrint( &quot;COM2&quot; )
   ? &quot;Check the device on COM2.  Something is wrong.&quot;
ENDIF

IF ! ft_IsPrint( &quot;/dev/lp0&quot; )
   ? &quot;Oops, not available.&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_isshare">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/isshare.txt">Improve this doc</a></span>
<h4><code>ft_IsShare()</code></h4>
<div class="d-ol">Determine if DOS &quot;Share&quot; is installed</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_IsShare() &rarr; nRetCode</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>nRetcode will be set as follows on exit:</div>
  <div>0 if SHARE not loaded but ok to load 1 if SHARE not loaded and not ok to load</div>
  <div>255 if SHARE loaded</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Uses DOS interrupt 2Fh (MultiPlex interrupt), service 10h to determine if DOS SHARE.COM is loaded.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_IsShare() != 255
   ? &quot;SHARE must be loaded!&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_int86">ft_int86()</a></code></div>
</section>

<section id="ft_mkdir">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mkdir.txt">Improve this doc</a></span>
<h4><code>ft_MkDir()</code></h4>
<div class="d-ol">Create a subdirectory</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MkDir(  &lt;cDirName&gt; ) &rarr; nResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDirName&gt; is the name of the directory to create.</div>
<div class="d-d">Returns</div>
<div class="d-it">0   if successful 3   if Path Not Found 5   if Access Denied or directory already exists 99  if invalid parameters passed</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Use this function to create the subdirectories needed by your application.  It might be especially useful in an installation program.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_MkDir( &quot;harbour&quot; )
? ft_MkDir( hb_ps() + &quot;example&quot; )
? ft_MkDir( &quot;..&quot; + hb_ps() + &quot;source&quot; )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_outp">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/outp.txt">Improve this doc</a></span>
<h4><code>ft_outp()</code></h4>
<div class="d-ol">Write a byte to a specified I/O port</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_outp( &lt;nPort&gt;, &lt;nValue&gt; ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nPort&gt; is the port from which to retrieve the byte.</div>
  <div>&lt;nValue&gt; is the value between 0 and 255 to write to the port.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>.T. if all parameters were valid and the byte was written to</div>
  <div>the port.</div>
  <div>.F. if invalid parameters were passed.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>It may sometimes be useful to write a byte to a port without having to resort to C or assembler.  This function allows you to do so.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_outp( 0x64, 0 )  // send a hb_BChar( 0 ) to port 100 (0x64)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_inp">ft_inp()</a></code></div>
</section>

<section id="ft_peek">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/peek.txt">Improve this doc</a></span>
<h4><code>ft_Peek()</code></h4>
<div class="d-ol">Retrieve a byte from a specified memory location.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Peek( &lt;nSegment&gt;, &lt;nOffset&gt; ) &rarr; nValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nSegment&gt; is the segment of the desired memory address.</div>
  <div>&lt;nOffset&gt;  is the offset of the desired memory address.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;nValue&gt; will be a value from 0 to 255 if all parameters were valid and</div>
  <div>the function was able to retrieve the desired byte.</div>
  <div>&lt;nValue&gt; will be -1 if invalid parameters were passed.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Use this function if you have a need to examine a specific memory location.  The function will return the byte at the specified address as a numeric value.  If you need this value as a character, use the hb_BChar() function to convert it.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Peek( 0, 0x449 )  // Get the current video mode (MS-DOS)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_poke">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/poke.txt">Improve this doc</a></span>
<h4><code>ft_Poke()</code></h4>
<div class="d-ol">Write a byte to a specified memory location</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Poke( &lt;nSegment&gt;, &lt;nOffset&gt;, &lt;nValue&gt; ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nSegment&gt; is the segment of the desired memory address.</div>
  <div>&lt;nOffset&gt;  is the offset of the desired memory address.</div>
  <div>&lt;nValue&gt;   is the value to write to the desired memory address.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;lResult&gt; will be .T. if all parameters were valid and the function was</div>
  <div>able to write the desired byte.</div>
  <div>&lt;lResult&gt; will be .F. if invalid parameters were passed.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Use this function if you have a need to change the value at a specific memory location.  The function will write the specified byte to the specified address.  The value must be passed as a numeric; if the byte you wish to use is stored as a character, use the hb_BCode() function to convert it.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_Poke( 0, 0x417, 0x40 )  // Turn CapsLock on (MS-DOS)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_reboot">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/reboot.txt">Improve this doc</a></span>
<h4><code>ft_Reboot()</code></h4>
<div class="d-ol">Force a warm or cold boot</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Reboot( &lt;nBootType&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nBootType&gt; is used to indicate the type of reboot.  A value of zero will cause a cold boot, while any other value will cause a warm boot.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is valuable if you need to reboot the PC for some reason; e.g. an installation routine that modifies CONFIG.SYS or AUTOEXEC.BAT.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#define COLD 0
#define WARM 1

// Issue a warm boot

ft_Reboot( WARM )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_rmdir">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/rmdir.txt">Improve this doc</a></span>
<h4><code>ft_RmDir()</code></h4>
<div class="d-ol">Delete a subdirectory</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RmDir( &lt;cDirName&gt; ) &rarr; nResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cDirName&gt; is the name of the directory to delete.</div>
<div class="d-d">Returns</div>
<div class="d-it">0   if successful 3   if Path Not Found 5   if Access Denied (directory not empty) 16  if attempt to delete current directory. 99  if invalid parameters passed</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is useful if you need to remove a subdirectory for some reason.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_RmDir( &quot;harbour&quot; )
? ft_RmDir( hb_ps() + &quot;example&quot; )
? ft_RmDir( &quot;..&quot; + hb_ps() + &quot;source&quot; )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_setdate">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/setdate.txt">Improve this doc</a></span>
<h4><code>ft_SetDate()</code></h4>
<div class="d-ol">Set the DOS system date</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetDate( &lt;dDate&gt; ) &rarr; &lt;lResult&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;dDate&gt; is a Clipper date variable that you want to set the current DOS system date to.</div>
  <div>It is up to you to send in a valid date.  The year must be within the range 1980 through 2099.  If DOS thinks the date is not valid, it won't change the date.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;lResult&gt; is simply the result of ft_int86(), passed back to your program.</div>
<div class="d-d">Description</div>
<div class="d-it">ft_SetDate() uses NANFOR.LIB's ft_int86() function to invoke the DOS Set Date service (Interrupt 33, service 43).</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following program takes a date from the command-line and sets
// the DOS system date:

PROCEDURE Main( cDate )

   hb_default( @cDate, DToS( Date() ) )
   ? &quot;Setting date to:&quot;, cDate + &quot;... &quot;
   ft_SetDate( hb_SToD( cDate ) )
   ? &quot;Today is now:&quot;, Date()

   RETURN
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_settime">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/settime.txt">Improve this doc</a></span>
<h4><code>ft_SetTime()</code></h4>
<div class="d-ol">Set the DOS system time</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetTime( &lt;cTime&gt; ) &rarr; &lt;lResult&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cTime&gt; is a string in the form &lt;hh:mm:ss&gt; that you want to set the current DOS system time to.</div>
  <div>Use 24-hour time.  It is up to you to send in a valid time.  If DOS doesn't think it is valid, it won't reset the time anyway.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;lResult&gt; is simply the result of ft_int86(), passed back to your program.</div>
<div class="d-d">Description</div>
<div class="d-it">ft_SetTime() uses NANFOR.LIB's ft_int86() function to invoke the DOS Set Time service (Interrupt 33, service 45).</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following program takes a time string from the command-line and sets
// the DOS system time:

PROCEDURE Main( cTime )

   cTime := iif( cTime == NIL, Time(), cTime )
   ? &quot;Setting time to:&quot;, cTime + &quot;... &quot;
   ft_SetTime( cTime )
   ? &quot;Time is now:&quot;, Time()

   RETURN
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_sysmem">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/sysmem.txt">Improve this doc</a></span>
<h4><code>ft_SysMem()</code></h4>
<div class="d-ol">Determine the amount of conventional memory installed</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SysMem() &rarr; nMemSize</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">A numeric corresponding to the number of KiB memory.</div>
<div class="d-d">Description</div>
<div class="d-it">ft_SysMem() simply reports the amount of conventional memory installed.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? &quot;Conventional memory:&quot;, hb_ntos( ft_SysMem() ), &quot;KiB installed&quot;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_tempfil">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/tempfile.txt">Improve this doc</a></span>
<h4><code>ft_TempFil()</code></h4>
<div class="d-ol">Create a file with a unique name</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_TempFil( [ &lt;cPath&gt; ] [, &lt;lHide&gt; ] ) &rarr; cFileSpec</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cPath&gt; is the directory where you want to create the temporary file.  If you omit this argument, the root of the current drive is assumed (&quot;").</div>
  <div>If &lt;lHide&gt; is .T., then the file will be created with the hidden attribute set.  The default is .F.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;cFileSpec&gt; should be your path, including the name of the newly created unique file.  You are safe to create a new file with this filename.</div>
  <div>If a DOS error occurred when trying to create the file, a null string will be returned.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function uses DOS Interrupt 21, service 5Ah (Create temporary file) to create a unique filename in a directory you specify. There will be no extension.  After the file is created, you may do any I/O you need (see the test driver in the source code).</div>
  <div><p>This function requires ft_int86().</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Create a unique file in the root of the current drive:
? ft_TempFil()

// Create a unique file in the current directory and hide it:
? ft_TempFil( &quot;.&quot;, .T. )

// Create a unique file on another directory, but do not hide it:
? ft_TempFil( &quot;mytempdir&quot; )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">DOS/BIOS</div>
</section>

<section id="ft_gete">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/getenvrn.txt">Improve this doc</a></span>
<h4><code>ft_GetE()</code></h4>
<div class="d-ol">Return the entire current environment</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_GetE( [ @&lt;xReceiveVar&gt; ] ) &rarr; nNumStrings</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;xReceiveVar&gt; is the variable to receive the environment data.</div>
  <div>&lt;xReceiveVar&gt; can be a character type variable, in which case the function will place all environment strings in the variable separated by carriage return/line feeds (Chr( 13 ) + Chr( 10 )).</div>
  <div>&lt;xReceiveVar&gt; can be an array type, in which case the function will place each string in an array element.  The array MUST be declared with the proper number of elements prior to passing it to the function.  This can be done by calling ft_GetE() without parameters first to get the number of strings in the environment.</div>
  <div>Note that the argument MUST be passed by reference. Since arrays are by nature passed by reference, the &quot;@&quot; symbol is optional when passing an array.</div>
  <div>If no argument is passed, ft_GetE() merely returns the number of strings in the environment.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">ft_GetE() returns the total number of strings found in the current program's environment.</div>
<div class="d-d">Description</div>
<div class="d-it">This function stores ALL of the current program's environment variables in either a block of text lines or in an array.  It is useful for looking at the entire environment at once, or recording a snapshot of it to a file for later inspection, such as when a program error occurs.  If the value of ONE SPECIFIC variable is desired, use Clipper's built-in GetE() function.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Get the environment in text form and browse it:

cEnvBlock   := &quot;&quot;
nNumStrings := ft_GetE( @cEnvBlock )
@ 0, 0 TO MaxRow() - 1, MaxCol()
@ MaxRow(), 0 SAY 'Browse strings, press ESC to exit...'
MemoWrit( cEnvBlock, 1, 1, MaxRow() - 2, MaxCol() - 1, .F. )

// Get the environment in text form and write it to a file:

cEnvBlock := &quot;&quot;
ft_GetE( @cEnvBlock )
MemoWrit( &quot;environ.txt&quot;, cEnvBlock )

// Get the environment in Array form:
aEnvArray := Array( ft_GetE() )
ft_GetE( aEnvArray )
? aEnvArray[ 1 ]
? aEnvArray[ 2 ]
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Environment</div>
</section>

<section id="ft_linked">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/linked.txt">Improve this doc</a></span>
<h4><code>ft_Linked()</code></h4>
<div class="d-ol">Determine if a function was linked in</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Linked( &lt;cString&gt; ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cString&gt; is a character string containing one or more function</div>
  <div>calls</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if all functions within the string are currently linked into the application, .F. if one or more aren't.  See below for a definition of &quot;function.&quot;</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function would be used in data driven application to determine whether or not a macro compiled function was linked in.</div>
  <div><p>Several functions can be passed, and nested, in &lt;cString&gt;.</div>
  <div><p>Caveat: Some function calls are converted by the preprocessor into other function calls. You cannot have these types of functions in a macro compiled string as they never exist at runtime. ft_Linked() will correctly tell you that they are invalid.</div>
  <div><p>For instance: there is no function called SORT() in any of the Nantucket Libraries, but it is a valid CLIPPER command because the preprocessor will convert it to other function calls.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
cString := &quot;ft_GoodFunc( BadFunc( 3, 2 ) )&quot;
IF ft_Linked( cString )
   Eval( &amp;( &quot;{||&quot; + cString + &quot;}&quot; ) )
ELSE
   Alert( &quot;Error: &quot; + cString + &quot; was not linked in. Called by ft_Linked()&quot; )
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Environment</div>
</section>

<section id="ft_origin">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/origin.txt">Improve this doc</a></span>
<h4><code>ft_Origin()</code></h4>
<div class="d-ol">Report the drive, path and filename of the current program</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Origin() &rarr; cString</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">A string containing the full drive/directory/filename of the currently executing file.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Often users will install multiple copies of application software, especially on networks and in situations where the user is trying to get around a copy protection scheme.</div>
  <div><p>This function enables you to learn the name and source location of the currently executing file, so that you may take whatever action you need to.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF !( hb_FNameNameExt( ft_Origin() ) == &quot;myapp.exe&quot; )
   ? &quot;Incorrect startup file.  Please remove/rename and start again&quot;
   RETURN
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Environment</div>
</section>

<section id="ft_restsets">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/restsets.txt">Improve this doc</a></span>
<h4><code>ft_RestSets()</code></h4>
<div class="d-ol">Restore status of all SET command settings</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RestSets( [ &lt;aOldSets&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">aOldSets is an array of SET settings created by ft_SaveSets()</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This function &quot;restores&quot; the SET Settings, i.e., it sets them to the values in the array aOldSets.  The following SETs are not currently supported: FILTER, FORMAT, FUNCTION, INDEX, KEYS, MODE, ORDER, PROCEDURE, RELATION, TYPEAHEAD</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_RestSets( aOldSets )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Environment</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_savesets">ft_SaveSets()</a></code>, <code><a href="#ft_setcentury">ft_SetCentury()</a></code></div>
</section>

<section id="ft_savesets">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/savesets.txt">Improve this doc</a></span>
<h4><code>ft_SaveSets()</code></h4>
<div class="d-ol">Save the status of all the SET command settings</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SaveSets() &rarr; aOldSets</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">An array containing the values of the supported SETs.</div>
<div class="d-d">Description</div>
<div class="d-it">This function saves the SET Settings, i.e., it copies them into an array, aOldSets.  The following SETs are not currently supported: FILTER, FORMAT, FUNCTION, INDEX, KEYS, MODE, ORDER, PROCEDURE, RELATION, TYPEAHEAD</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
aOldSets := ft_SaveSets()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Environment</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_restsets">ft_RestSets()</a></code>, <code><a href="#ft_setcentury">ft_SetCentury()</a></code></div>
</section>

<section id="ft_setcentury">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/cntryset.txt">Improve this doc</a></span>
<h4><code>ft_SetCentury()</code></h4>
<div class="d-ol">Check/Set the CENTURY Setting</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetCentury( [ &lt;lNewSetState&gt; ] ) &rarr; &lt;lOldState&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>lNewSetState - Boolean to Set CENTURY</div>
  <div>.F. - Toggle CENTURY off .T. - Toggle CENTURY on If not specified, leave CENTURY as is</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The state of the CENTURY setting upon entry to the routine</div>
<div class="d-d">Description</div>
<div class="d-it">This function returns the state (ON/OFF, TRUE/FALSE) of the CENTURY and optionally sets it ON or OFF.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_SetCentury()       // Get current CENTURY Setting

? ft_SetCentury( .T. )  // Get the current CENTURY Setting
                        // and turn it on (set it to TRUE)

? ft_SetCentury( .F. )  // Get the current CENTURY Setting
                        // and turn it off (set it to FALSE)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Environment</div>
</section>

<section id="ft_idle">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/idle.txt">Improve this doc</a></span>
<h4><code>ft_Idle()</code></h4>
<div class="d-ol">Generate an idle event to allow incremental garbage collection.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Idle()</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>During memory-intensive operations that do not generate much in the way of idle states, the Clipper runtime may not get a chance to perform garbage collection of discarded memory.  This can eventually lead to any of a variety of memory-related internal errors.</div>
  <div><p>This function attempts to alleviate the problem by providing a mechanism by which an idle event can be artifically generated at will.  The idle event will cause the CA-Cl*pper runtime to perform an incremental memory scavenge.</div>
  <div><p>This function makes use of an undocumented interal routine.  If this this fact makes you uncomfortable then don't use this function, you miserable jello-spined lump of human debris.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
DO WHILE Whatever       // Some batch process
   Something()          // Create 'n' discard a bunch of stuff
   ft_Idle()            // Take out the garbage
ENDDO
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Event</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_onidle">ft_OnIdle()</a></code></div>
</section>

<section id="ft_ontick">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/ontick.txt">Improve this doc</a></span>
<h4><code>ft_OnTick()</code></h4>
<div class="d-ol">Evaluate a designated code block at a designated interval.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_OnTick( bCode, nInterval )</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;bCode&gt; is the code block to evaluate. &lt;nInterval&gt; is the number of clock ticks to wait between</div>
  <div>evaluations of the code block.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function effectively allows you to run tasks in the background by transparently and periodically calling a designated routine.</div>
  <div><p>To halt the execution of the background function, call ft_OnTick() with no arguments.</div>
  <div><p>This function makes heavy use of several undocumented internal routines.  If this fact makes you uncomfortable then don't use this function, you quivering sack of cowardly slime.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Set up a self-updating on-screen clock

ft_OnTick( &quot;CLOCK&quot;, 9 )

PROCEDURE Clock()

   LOCAL nRow := Row()
   LOCAL nCol := Col()

   @ 0, 0 SAY Time()

   SetPos( nRow, nCol )

   RETURN
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Event</div>
</section>

<section id="ft_dfclose">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/dfile.txt">Improve this doc</a></span>
<h4><code>ft_DFClose()</code></h4>
<div class="d-ol">Close file displayed by ft_DispFile()</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DFClose() &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">Closes the file opened by ft_DFSetup()</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#include &quot;inkey.ch&quot;

@ 4, 9 TO 11, 71

ft_DFSetup( &quot;test.txt&quot;, 5, 10, 10, 70, 1, 7, 15, ;
   { &quot;A&quot;, &quot;a&quot;, &quot;B&quot;, &quot;b&quot;, K_F3 }, .T., 5, 132, 4096 )

cKey := ft_DispFile()

ft_DFClose()

@ 20, 0 SAY &quot;Key that terminated ft_DispFile() was: &quot; + &quot;[&quot; + cKey + &quot;]&quot;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_dfsetup">ft_DFSetup()</a></code>, <code><a href="#ft_dispfile">ft_DispFile()</a></code></div>
</section>

<section id="ft_dfsetup">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/dfile.txt">Improve this doc</a></span>
<h4><code>ft_DFSetup()</code></h4>
<div class="d-ol">Set up parameters for ft_DispFile()</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DFSetup( &lt;cInFile&gt;, &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt;, ;</code><code>&lt;nStart&gt;, &lt;nCNormal&gt;, &lt;nCHighlight&gt;, &lt;cExitKeys&gt;,   ; &lt;lBrowse&gt;, &lt;nColSkip&gt;, &lt;nRMargin&gt;, &lt;nBuffSize&gt; ) &rarr; nResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cInFile&gt;     - text file to display (full path and filename) &lt;nTop&gt;        - upper row of window &lt;nLeft&gt;       - left col of window &lt;nBottom&gt;     - lower row of window &lt;nRight&gt;      - right col of window &lt;nStart&gt;      - line to place highlight at startup &lt;nCNormal&gt;    - normal text color     (numeric attribute) &lt;nCHighlight&gt; - text highlight color  (numeric attribute) &lt;cExitKeys&gt;   - terminating key list  (each byte of string is a</div>
  <div>key code)</div>
  <div>&lt;lBrowse&gt;     - act-like-a-browse-routine flag &lt;nColSkip&gt;    - col increment for left/right arrows &lt;nRMargin&gt;    - right margin - anything to right is truncated &lt;nBuffSize&gt;   - size of the paging buffer</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">0 if successful, FError() code if not</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Note: make sure you allocate a buffer large enough to hold enough data for the number of lines that you have in the window.  Use the following formula as a guideline:</div>
  <div><p>buffer size = (# of line) + 1 * RMargin</div>
  <div><p>This is the smallest you should make the buffer.  For normal use, 4096 bytes is recommended</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#include &quot;inkey.ch&quot;

@ 4, 9 TO 11, 71

ft_DFSetup( &quot;test.txt&quot;, 5, 10, 10, 70, 1, 7, 15, ;
   { &quot;A&quot;, &quot;a&quot;, &quot;B&quot;, &quot;b&quot;, K_F3 }, .T., 5, 132, 4096 )

cKey := ft_DispFile()

ft_DFClose()

@ 20, 0 SAY &quot;Key that terminated ft_DispFile() was: &quot; + &quot;[&quot; + cKey + &quot;]&quot;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_dispfile">ft_DispFile()</a></code>, <code><a href="#ft_dfclose">ft_DFClose()</a></code></div>
</section>

<section id="ft_dispfile">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/dispc.txt">Improve this doc</a></span>
<h4><code>ft_DispFile()</code></h4>
<div class="d-ol">Browse a text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DispFile() &rarr; cExitkey</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">The ASCII keystroke that terminated ft_DispFile()</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This routine displays a text file within a defined window using as little memory as possible.  The text file to display has to be present or an error value of 0 is returned (as a character.)</div>
  <div><p>Assumptions: The routine assumes that all lines are terminated</div>
  <div><p>with a CR/LF sequence (0x0d and 0x0a).</div>
  <div><p>Note:        Make sure you allocate a buffer large enough to hold</div>
  <div><p>enough data for the number of lines that you have in the window.  Use the following formula as a guideline - buffer size = (# of line) + 1 * RMargin this is the smallest you should make the buffer and for normal use I recommend 4096 bytes.</div>
  <div><p>Cursor Keys: Up, Down    - moves the highlight line</div>
  <div><p>Left, Right - moves the window over nColSkip col's Home        - moves the window to the far left End         - moves the window to the nRMargin column PgUp, PgDn  - moves the highlight one page Ctrl-PgUp   - moves the highlight to the file top Ctrl-PgDn   - moves the highlight to the file bottom Ctrl-Right  - moves the window 16 col's to the right Ctrl-Left   - moves the window 16 col's to the left</div>
  <div><p>Esc, Return - terminates the function</div>
  <div><p>All other keys are ignored unless they are specified within cExitKeys parameter.  This list will tell the routine what keys terminate the function.  Special keys must be passed by a unique value and that value can be found by looking in the keys.h file.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#include &quot;inkey.ch&quot;

@ 4, 9 TO 11, 71

ft_DFSetup( &quot;test.txt&quot;, 5, 10, 10, 70, 1, 7, 15, ;
   { &quot;A&quot;, &quot;a&quot;, &quot;B&quot;, &quot;b&quot;, K_F3 }, .T., 5, 132, 4096 )

cKey := ft_DispFile()

ft_DFClose()

@ 20, 0 SAY &quot;Key that terminated ft_DispFile() was: &quot; + &quot;[&quot; + cKey + &quot;]&quot;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_dfsetup">ft_DFSetup()</a></code>, <code><a href="#ft_dfclose">ft_DFClose()</a></code></div>
</section>

<section id="ft_fappend">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FAppend()</code></h4>
<div class="d-ol">Appends a line to the currently selected text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FAppend( [ &lt;nLines&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nLines&gt; is the number of lines that should be appended to the end of the currently selected text file.</div>
  <div>If &lt;nLines&gt; is omitted, one record is appended.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">lSuccess.  If FALSE, check ^bft_FError()^n for the error code.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function appends a line of text to the file in the currently selected text file workarea.  Text lines are delimited with a CRLF/LF.  The record pointer is moved to the last appended record.</div>
  <div><p>Multiple lines may be appended with one call to ft_FAppend().</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF. Each line appended with this function will be empty.</div>
  <div><p>NOTE:  Occasionally a text file may contain a non-CRLF/LF terminated line, at the end of the file (&quot;stragglers&quot;).  This function assumes these stragglers to be the last line of the file, and begins appending the new lines after this line.  In other words, if the last line in the text file is not terminated with a CRLF/LF prior to calling ft_FAppend(), the function will terminate that last line before appending any new lines.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// add a blank line of text to a file
ft_FUse( &quot;test.txt&quot; )

? ft_FRecNo()           // displays 5

ft_FAppend()

? ft_FRecNo()           // displays 6
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_fdelete">ft_FDelete()</a></code>, <code><a href="#ft_finsert">ft_FInsert()</a></code>, <code><a href="#ft_flastre">ft_FLastRe()</a></code></div>
</section>

<section id="ft_fbof">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FBof()</code></h4>
<div class="d-ol">Determine if attempt to skip past beginning of text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FBof() &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if an attempt was made to skip past the first record of the currently selected text file, otherwise .F.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is similar to the Clipper Bof() function.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_FUse( &quot;test.txt&quot; )

ft_FGoTop()

? ft_FBof()        // .F.

ft_FSkip( -1 )

? ft_FBof()        // .T.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fskip">ft_FSkip()</a></code>, <code><a href="#ft_feof">ft_FEof()</a></code>, <code><a href="#ft_fgotop">ft_FGoTop()</a></code></div>
</section>

<section id="ft_fdelete">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FDelete()</code></h4>
<div class="d-ol">Deletes a line from the currently selected text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FDelete( [ &lt;nLines&gt; ] ) &rarr; lSuccess</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>^b&lt;nLines&gt;^n is the number of lines to be eliminated, beginning with the current record position.</div>
  <div>If ^b&lt;nLines&gt;^n is omitted, the current record is deleted only.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">TRUE if successful, otherwise check ^bft_FError()^n for error code.</div>
<div class="d-d">Description</div>
<div class="d-it">This function deletes one or several lines of text from the file in the currently selected text file workarea.  Text lines are delimited with a CRLF/LF.  The record pointer is not moved, unless the deleted lines occur at the end of the file, in which case ^bft_FRecNo()^n will equal ^bft_FLastRe()^n and ^bft_FEof()^n will be set to TRUE.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// delete the next 4 lines from a file
ft_FUse( &quot;test.txt&quot; )

ft_FDelete( 4 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fappend">ft_FAppend()</a></code>, <code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_finsert">ft_FInsert()</a></code></div>
</section>

<section id="ft_feof">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FEof()</code></h4>
<div class="d-ol">Determine if end of text file has been encountered</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FEof() &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if an attempt was made to skip past the last record of the currently selected text file, otherwise .F.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is similar to the CLIPPER Eof() function.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_FUse( &quot;test.txt&quot; )

? ft_FEof()        // .F.

ft_FSkip()

? ft_FEof()        // .T.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fuse">ft_FUse()</a></code>, <code><a href="#ft_fskip">ft_FSkip()</a></code></div>
</section>

<section id="ft_ferror">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FError()</code></h4>
<div class="d-ol">Return the error code for a text file operation</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FError() &rarr; nErrorNo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">The DOS error code if one occurred.  See a reference on DOS error codes for an explanation of what the code means.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function returns the DOS error code associated with a file operation on the currently selected text file.</div>
  <div><p>Errors could stem from any open, create, read or write operation, among others.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#include &quot;fileio.ch&quot;
IF ft_FUse( &quot;test.txt&quot; ) != F_ERROR     // open text file
   err := ft_FError()
   ? &quot;Error opening file 'test.txt', error code (&quot; + ;
      hb_ntos( err ) + &quot;)&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
</section>

<section id="ft_fgobot">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FGoBot()</code></h4>
<div class="d-ol">Go to the last record in a text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FGoBot() &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function moves the record pointer to the last record of the file in the currently selected text file workarea.</div>
  <div><p>If a read error occurs ^bft_FError()^n will contain the error code.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// read last line
ft_FUse( &quot;test.txt&quot; )

ft_FGoBot()

? ft_FReadLn()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fselect">ft_FSelect()</a></code>, <code><a href="#ft_fuse">ft_FUse()</a></code>, <code><a href="#ft_fgotop">ft_FGoTop()</a></code>, <code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_freadln">ft_FReadLn()</a></code></div>
</section>

<section id="ft_fgoto">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FGoto()</code></h4>
<div class="d-ol">Move record pointer to specific record in a text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FGoto( nLine ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nLine&gt; is the record number to go to.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function moves the record pointer to a specific record in the file in the currently selected text file workarea.  If the record number requested is greater than the number of records in the file, the record pointer will be positioned at the last record.</div>
  <div><p>Internally, the function operates differently depending on how you invoke it.  Passing a value for ^b&lt;nLine&gt;^n results in what is effectively a skip operation, which is fairly quick.  However if you pass 0 for ^b&lt;nLine&gt;^n, e.g. ft_FGoto( 0 ), the function internally goes to the top of the file, then skips down the required number of records.  Hence if your file is relatively large and the current record is a high number, you may see some delay as ft_FGoto( 0 ) skips through the file.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// read 5th line of text from file

ft_FUse( &quot;test.txt&quot; )

ft_FGoto( 5 )

? ft_FReadLn()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_fgotop">ft_FGoTop()</a></code>, <code><a href="#ft_freadln">ft_FReadLn()</a></code></div>
</section>

<section id="ft_fgotop">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FGoTop()</code></h4>
<div class="d-ol">Go to the first record in a text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FGoTop() &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function moves the record pointer to the first record in the currently selected text file workarea.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_FUse( &quot;test.txt&quot; )      // open text file

DO WHILE ! ft_FEof()
   ? ft_FReadLn()        // read thru file
   ft_FSkip()
ENDDO

ft_FGoTop()              // go back to top

? ft_FRecNo()            // 1
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fselect">ft_FSelect()</a></code>, <code><a href="#ft_fuse">ft_FUse()</a></code>, <code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_fgobot">ft_FGoBot()</a></code></div>
</section>

<section id="ft_finsert">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FInsert()</code></h4>
<div class="d-ol">Inserts a line in the currently selected text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FInsert( [ &lt;nLines&gt; ] ) &rarr; lSuccess</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>^b&lt;nLines&gt;^n is the number of lines that should be inserted at the current record position.</div>
  <div>If ^b&lt;nLines&gt;^n is omitted, one record is inserted.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">^blSuccess^n is TRUE if the insert succeeded, FALSE if not.  If false check the return value of ^bft_FError()^n for the reason.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function inserts a line of text in the file in the currently selected text file workarea.  Text lines are delimited with a CRLF/LF.</div>
  <div><p>The record pointer is not moved.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF. Each line inserted with this function will be empty.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// add a couple of blank lines of text to a file
ft_FUse( &quot;test.txt&quot; )

ft_FGoto( 10 )

ft_FInsert( 5 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fappend">ft_FAppend()</a></code>, <code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_fdelete">ft_FDelete()</a></code>, <code><a href="#ft_flastre">ft_FLastRe()</a></code></div>
</section>

<section id="ft_flastre">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FLastRe()</code></h4>
<div class="d-ol">Get the no. of records in the currently selected text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FLastRe() &rarr; nLastRecordNum</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">An integer containing the number of records in the text file in the currently selected text file workarea, or zero if no file is currently open in the workarea.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function returns the number of the last record in a text file.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_FUse( &quot;test.txt&quot; )

? ft_FLastRe()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fuse">ft_FUse()</a></code>, <code><a href="#ft_frecno">ft_FRecNo()</a></code></div>
</section>

<section id="ft_freadln">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FReadLn()</code></h4>
<div class="d-ol">Read a line from the currently selected text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FReadLn() &rarr; cLine</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">A string containing the current record in a text file.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function returns a line of text read from the file in the currently selected text file workarea.  Text lines are delimited with a CRLF/LF.  The record pointer is not moved.</div>
  <div><p>Currently the maximum record size is 4096 characters.  You may increase the maximum record size by changing the value of ^b#define ^bBUFFSIZE^n in the C source and recompiling, however you should consider the performance implications if you do (all read and writes use this buffer size, including ft_FSkip()'s and ft_FGoto()'s).</div>
  <div><p>If a read error occurs ^ft_FError()^n will contain the error code.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// display each record of a text file

ft_FUse( &quot;test.txt&quot; )

DO WHILE ! ft_FEof()
   ? ft_FReadLn()
   ft_FSkip()
ENDDO
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fuse">ft_FUse()</a></code>, <code><a href="#ft_fwriteln">ft_FWriteLn()</a></code>, <code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_fgotop">ft_FGoTop()</a></code></div>
</section>

<section id="ft_frecno">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FRecNo()</code></h4>
<div class="d-ol">Return the current record number of a text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FRecNo() &rarr; nRecNo</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">The current record number of a text file or 0 if no file is open.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function returns the current record number of the file open in the currently selected text file workarea.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_FUse( &quot;test.txt&quot; )      // open text file

DO WHILE ! ft_FEof()
   ? ft_FReadLn()        // read thru file
   ft_FSkip()
ENDDO

ft_FGoTop()              // go back to top

? ft_FRecNo()            // 1
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fselect">ft_FSelect()</a></code>, <code><a href="#ft_fuse">ft_FUse()</a></code>, <code><a href="#ft_fgotop">ft_FGoTop()</a></code>, <code><a href="#ft_fgobot">ft_FGoBot()</a></code></div>
</section>

<section id="ft_fselect">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FSelect()</code></h4>
<div class="d-ol">Select a text file workarea</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FSelect( [ &lt;nNewArea&gt; ] ) &rarr; nPreviousArea</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">^b&lt;nNewArea&gt;^n is the text file workarea to select.</div>
<div class="d-d">Returns</div>
<div class="d-it">The current selected text file area.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function selects a text file &quot;workarea&quot; from 1 to 10.  A file may or may not be open in the selected area.</div>
  <div><p>Passing 0 for ^b&lt;nNewArea&gt;^n selects the next available workarea, similar to Clipper's SELECT 0 command.  If no more workareas are available the current workarea is not changed.</div>
  <div><p>Each file is opened in its own &quot;workarea&quot;, similar to the concept used by dbf files.  As provided, a maximum of 10 files (in 10 workareas) can be opened (assuming there are sufficient file handles available).  That number may be increased by modifying the #define TEXT_WORKAREAS in the C source code and recompiling.</div>
  <div><p>All the ft_F*() file functions operate on the file in the currently selected text file workarea.</div>
  <div><p>Text file workareas are separate from and independent of Clipper's database workareas.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_FSelect( 1 )

nFile1 := ft_FUse( &quot;temp.c&quot; )

? ft_FLastRe()                 // no. of lines in temp.c

ft_FSelect( 2 )

nFile2 := ft_FUse( &quot;temp.h&quot; )

? ft_FLastRe()                 // no. of lines in temp.h
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fuse">ft_FUse()</a></code></div>
</section>

<section id="ft_fskip">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FSkip()</code></h4>
<div class="d-ol">Move the record pointer to a new position in a text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FSkip( [ &lt;nLines&gt; ] ) &rarr; nLinesSkipped</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nLines&gt; is the number of lines to skip.  Defaults to 1 if not specified.</div>
<div class="d-d">Returns</div>
<div class="d-it">The number of lines actually skipped.  If the file's EOF or BOF was encountered before ^b&lt;nLines&gt;^n could be skipped, the return value will be less than ^b&lt;nLines&gt;^n.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function moves the text file record pointer, similar to the CLIPPER SKIP command.</div>
  <div><p>Use the return value to determine how many records were actually skipped, for example to write a custom skipper function for TBrowse'g text files.</div>
  <div><p>If a read error occurs ^ft_FError()^n will contain the error code.</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// display each record of a text file

ft_FUse( &quot;test.txt&quot; )

DO WHILE ! ft_FEof()
   ? ft_FReadLn()
   ft_FSkip()
ENDDO
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_fgotop">ft_FGoTop()</a></code></div>
</section>

<section id="ft_fuse">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FUse()</code></h4>
<div class="d-ol">Open or close a text file for use by the ft_F*() functions</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FUse( [ &lt;cFile&gt; ] [, &lt;nMode&gt; ] ) &rarr; nHandle | 0</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>^b&lt;cFile&gt;^n is the text file you want to open.  If not specified, the file currently open, if any, will be closed.</div>
  <div>^b&lt;nMode&gt;^n is the open mode for the file.  Please refer to the discussion of file open modes in fileio.ch for a list of allowable open modes.  If not specified, the file will be opened with a mode of FO_READ + FO_SHARED.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>If ^b&lt;cFile&gt;^n is passed and the file is opened successfully, an integer containing the text file's workarea.  If the file cannot be opened, F_ERROR (-1) will be returned.  In this case, check the return value of ^bft_FError()^n for the cause of the error.</div>
  <div>If ft_FUse() is called without any arguments, it will close the text file in the current &quot;text area&quot; and return 0.</div>
  <div>If a read error occurs ^ft_FError()^n will contain the error code.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>The ft_F*() file functions are for reading text files, that is, files where each line (record) is delimited by a CRLF/LF.</div>
  <div><p>Each file is opened in its own &quot;workarea&quot;, similar to the concept use by dbf files.  As provided, a maximum of 10 files (in 10 workareas) can be opened (assuming there are sufficient file handles available).  That number may be increased by modifying the #define TEXT_WORKAREAS in the C source code and recompiling.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#include &quot;fileio.ch&quot;

// open a text file for reading
ft_FUse( &quot;test.txt&quot; )

// open a text file for reading and writing
ft_FUse( &quot;test.txt&quot;, FO_READWRITE + FO_SHARED )

// close file
ft_FUse()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fuse">ft_FUse()</a></code>, <code><a href="#ft_fselect">ft_FSelect()</a></code></div>
</section>

<section id="ft_fwriteln">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/fttext.txt">Improve this doc</a></span>
<h4><code>ft_FWriteLn()</code></h4>
<div class="d-ol">Write a line to the currently selected text file</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FWriteLn( &lt;cData&gt;, [ &lt;lInsert&gt; ] ) &rarr; lSuccess</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cData&gt; is a string of data to write to the file at the current</div>
  <div>record position.</div>
  <div>&lt;lInsert&gt; is a logical indicating whether the contents of the current record are to be preserved, that is, if lInsert evaluates to .T., the a new record is inserted at the current position.  The current record then is pushed down to ft_FRecNo()+1.</div>
  <div>If lInsert is .F. or omitted, the current record is replaced by cData.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">TRUE if successful, otherwise check ^ft_FError()^n for error code.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function writes a line of text to the file in the currently selected text file workarea.  Text lines are delimited with a CRLF/LF.  The record pointer is not moved.</div>
  <div><p>The contents of the current record are updated to reflect the new new line written, unless the Insert option is selected.</div>
  <div><p>Writing a null string has the effect of clearing the current line if in overstrike mode, else inserting a new line (same as ft_FInsert()).</div>
  <div><p>A text file &quot;record&quot; is a line of text terminated by a CRLF/LF.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// write a line of text to a file

ft_FUse( &quot;config.sys&quot; )

DO WHILE ! hb_LeftEqI( ft_FReadLn(), &quot;FILES=&quot; ) .AND. ! ft_FEof()
   ft_FSkip()
ENDDO

ft_FWriteLn( &quot;FILES=30&quot;, ft_FEof() )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">File I/O</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_freadln">ft_FReadLn()</a></code>, <code><a href="#ft_frecno">ft_FRecNo()</a></code>, <code><a href="#ft_finsert">ft_FInsert()</a></code>, <code><a href="#ft_fdelete">ft_FDelete()</a></code></div>
</section>

<section id="ft_pegs">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/pegs.txt">Improve this doc</a></span>
<h4><code>ft_Pegs()</code></h4>
<div class="d-ol">PEGS GAME (all work and no play...)</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Pegs() &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This function can be used to alleviate boredom.  The object is to remove all pegs except one.  This is done by jumping over adjacent pegs.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_Pegs()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Game</div>
</section>

<section id="ft_alt">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/alt.txt">Improve this doc</a></span>
<h4><code>ft_Alt()</code></h4>
<div class="d-ol">Determine status of the Alt key</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Alt() &rarr; lValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if Alt key is pressed, .F. if otherwise.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful for times you need to know whether or not the Alt key is pressed, such as during a MemoEdit().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_Alt()
   @ 0, 0 SAY &quot;Alt&quot;
ELSE
   @ 0, 0 SAY &quot;   &quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_caplock">ft_CapLock()</a></code>, <code><a href="#ft_ctrl">ft_Ctrl()</a></code>, <code><a href="#ft_numlock">ft_NumLock()</a></code>, <code><a href="#ft_prtscr">ft_PrtScr()</a></code>, <code><a href="#ft_shift">ft_Shift()</a></code></div>
</section>

<section id="ft_caplock">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/caplock.txt">Improve this doc</a></span>
<h4><code>ft_CapLock()</code></h4>
<div class="d-ol">Determine and optionally change the status of CapLock key</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_CapLock([ &lt;lNewSetting&gt; ]) &rarr; lCurrentSetting</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;lNewSetting&gt; is optional and if supplied is the new setting for the CapLock key.  Specify .T. to turn CapLock on, or .F. to turn it off.</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>.T. if CapLock is set, .F. if it isn't set.  The value returned</div>
  <div>represents the setting in effect prior to any changes that might by made by &lt;lNewSetting&gt;.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful if you need to know or set the status of the CapLock key for some reason.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_CapLock()
   ? &quot;CapLock is active&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_alt">ft_Alt()</a></code>, <code><a href="#ft_ctrl">ft_Ctrl()</a></code>, <code><a href="#ft_numlock">ft_NumLock()</a></code>, <code><a href="#ft_prtscr">ft_PrtScr()</a></code>, <code><a href="#ft_shift">ft_Shift()</a></code></div>
</section>

<section id="ft_ctrl">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/ctrl.txt">Improve this doc</a></span>
<h4><code>ft_Ctrl()</code></h4>
<div class="d-ol">Determine status of the Ctrl key</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Ctrl() &rarr; lValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if Ctrl key is pressed, .F. if otherwise.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful for times you need to know whether or not the Ctrl key is pressed, such as during a MemoEdit().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_Ctrl()
   @ 0, 0 SAY &quot;Ctrl&quot;
ELSE
   @ 0, 0 SAY &quot;    &quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_caplock">ft_CapLock()</a></code>, <code><a href="#ft_numlock">ft_NumLock()</a></code>, <code><a href="#ft_prtscr">ft_PrtScr()</a></code>, <code><a href="#ft_shift">ft_Shift()</a></code>, <code><a href="#ft_alt">ft_Alt()</a></code></div>
</section>

<section id="ft_lastkey_001">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/setlastk.txt">Improve this doc</a></span>
<h4><code>ft_LastKey()</code></h4>
<div class="d-ol">Force LastKey() to return a programmer-defined value.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_LastKey( &lt;nKey&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nKey&gt; is the Inkey() value of the desired key.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>It is occasionally useful to force LastKey() to return a known value. This is easily accomplishing by using the KEYBOARD command, but this has undesireable side effects (the keyboard buffer is cleared, and the keystroke is processed whether you needed it to be or not).  This function accomplishes the same task but without the side effects.  It does so by directly modifying the memory location where Clipper stores the LastKey() value.</div>
  <div><p>Some highly unorthodox programming techniques, not to mention rather strange use of Clipper internals, was necessary to make this function work.  If this makes you uncomfortable, then don't use this function, you worthless crybaby.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
hb_keyPut( K_ESC )

? LastKey()  // returns 27

ft_LastKey( K_F1 )

? LastKey()  // now returns 28
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_lastkey">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/setkeys.txt">Improve this doc</a></span>
<h4><code>ft_LastKey()</code></h4>
<div class="d-ol">Force LastKey() to return a programmer-defined value.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_LastKey( &lt;nKey&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nKey&gt; is the Inkey() value of the desired key.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>It is occasionally useful to force LastKey() to return a known value. This is easily accomplishing by using the KEYBOARD command, but this has undesireable side effects (the keyboard buffer is cleared, and the keystroke is processed whether you needed it to be or not).  This function accomplishes the same task but without the side effects.  It does so by directly modifying the memory location where Clipper stores the LastKey() value.</div>
  <div><p>Some highly unorthodox programming techniques, not to mention rather strange use of Clipper internals, was necessary to make this function work.  If this makes you uncomfortable, then don't use this function, you worthless crybaby.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
hb_keyPut( K_ESC )

? LastKey()  // returns 27

ft_LastKey( K_F1 )

? LastKey()  // now returns 28
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_mbutprs">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MButPrs()</code></h4>
<div class="d-ol">Retrieve button press status</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MButPrs( &lt;nButton&gt; [, @nButPrs [, @nX [, @nY] ] ] ) &rarr; nButStatus</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nButton&gt; is the mouse button number:</div>
  <div>0 - Left   Button 1 - Right  Button 2 - Middle Button [if applicable]</div>
  <div>&lt;nButPrs&gt; is the number of times the specified button was pressed</div>
  <div>since the last call to this routine. PASSED BY REFERENCE.</div>
  <div>&lt;nX&gt; is the X position of the cursor when the last press occurred.</div>
  <div>PASSED BY REFERENCE.</div>
  <div>&lt;nY&gt; is the Y position of the cursor when the last press occurred.</div>
  <div>PASSED BY REFERENCE.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>An integer representing the button status:</div>
  <div>0 - no buttons pressed 1 - left button pressed 2 - right button pressed 3 - left and right pressed 4 - middle pressed 5 - left and middle pressed 6 - middle and right buttons pressed 7 - all 3 buttons pressed</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Retrieves the mouse button status and the position of the cursor when a button was last pressed.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF Empty( ft_MButPrs( 1 ) )
   ? &quot;No Item selected&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mbutrel">ft_MButRel()</a></code>, <code><a href="#ft_mdblclk">ft_MDblClk()</a></code></div>
</section>

<section id="ft_mbutrel">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MButRel()</code></h4>
<div class="d-ol">Get mouse button release information</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MButRel( nButton [, @nButRel [, @nX [, @nY] ] ]) &rarr; nBStat</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nButton&gt; is the mouse button number</div>
  <div>0 - Left   Button 1 - Right  Button 2 - Middle Button [if applicable]</div>
  <div>&lt;nButRel&gt; is the number of times the specified button was released</div>
  <div>since the last call to this routine. PASSED BY REFERENCE.</div>
  <div>&lt;nX&gt; is the X position of the cursor when the last release occurred.</div>
  <div>PASSED BY REFERENCE.</div>
  <div>&lt;nY&gt; is the Y position of the cursor when the last release occurred.</div>
  <div>PASSED BY REFERENCE.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;nBStat&gt;  - an integer representing button release status</div>
  <div>0 - None 1 - Left 2 - Right 3 - Middle</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">This function returns the release status of the mouse buttons and the coordinates of the last release.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_MButRel( 0 ) == 1
   ? &quot;Left button released&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mbutprs">ft_MButPrs()</a></code>, <code><a href="#ft_mdblclk">ft_MDblClk()</a></code></div>
</section>

<section id="ft_mconoff">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MCOnOff()</code></h4>
<div class="d-ol">Turn mouse cursur off if in specified region</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MCOnOff( &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt; )</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nTop&gt;, &lt;nLeft&gt; &lt;nBottom&gt; &lt;nRight&gt; are the four corners of the</div>
  <div>screen region in row and column coordinates.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function tells the mouse driver to hide the cursor if it is in the given region. The driver hides the cursor by decrementing the cursor flag. A call to ft_MShowCrs() is required to turn the cursor back on. Calling ft_MShowCrs() also disables this function.</div>
  <div><p>See ft_MShowCrs() for a discussion of the cursor display flag.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MCOnOff( 10, 10, 11, 20 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mshowcrs">ft_MShowCrs()</a></code>, <code><a href="#ft_mhidecrs">ft_MHideCrs()</a></code>, <code><a href="#ft_mxlimit">ft_MXLimit()</a></code>, <code><a href="#ft_mylimit">ft_MYLimit()</a></code>, <code><a href="#ft_minregion">ft_MInRegion()</a></code></div>
</section>

<section id="ft_mcursor">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MCursor()</code></h4>
<div class="d-ol">Set the mouse cursor</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MCursor( [ &lt;lState&gt; ] ) &rarr; lCursorState</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;lState&gt; is a logical indicating whether to set the mouse cursor on.</div>
  <div>.T. - set mouse cursor on .F. - set mouse cursor off If omitted, no change is made to cursor state</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">A logical indicating the previous mouse cursor state.</div>
<div class="d-d">Description</div>
<div class="d-it">This function works like most Clipper state functions.  If no value is sent to ft_MCursor() it will return the state of the mouse cursor.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ! ft_MCursor()
   ft_MCursor( .T. )
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_mdblclk">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MDblClk()</code></h4>
<div class="d-ol">Return true if a double click was detected</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MDblClk( [ &lt;nClick&gt; [, &lt;nButton&gt; [, &lt;nInterval&gt; [, &lt;nRow&gt; [, &lt;nCol&gt;;</code><code>[, &lt;nTime&gt; ] ] ] ] ] ] ) &rarr; lIsDoubleClk</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nClick&gt; is a numeric value.  If it is zero ft_MDblClk() will not</div>
  <div>check for the first press but rather will simply wait the specified period for a single press. This is useful if this routine is called from one which in turn responded to a button press. If it is not present or not equal to 0, then ft_MDblClk() will wait for two presses of the specified button.</div>
  <div>&lt;nButton&gt; is the mouse button number</div>
  <div>0 - Left   Button 1 - Right  Button 2 - Middle Button [if applicable]</div>
  <div>&lt;nInterval&gt; is the interval to wait for the first click if requested</div>
  <div>and the time to wait for the second. If not present then defaults to 0.5 second.</div>
  <div>&lt;nRow&gt; is the row number for the mouse cursor location for a double click</div>
  <div>to be valid. If not present then the current position is taken as the valid location.</div>
  <div>&lt;nCol&gt; is the column number for the mouse cursor location for a double</div>
  <div>click to be valid. If not present, then the current position is taken as the valid location.</div>
  <div>&lt;nTime&gt; is an optional start time for the waiting period for the first</div>
  <div>click (of either one or two requested). If not given then the time is set at entry into this routine. This is useful when this routine is called from another routine which was called in response to a mouse click but needs to know if a double click has occurred</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if a double click was detected.</div>
<div class="d-d">Description</div>
<div class="d-it">This is a mouse meta function that checks for the presence of a double click.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_MIsRegion( 10, 10, 11, 20 ) .AND. ;
   ft_MDblClk( 0, 1,, ft_MGetX(), ft_MGetY() ) // double click, right button
                                               // at current location with
                                               // default interval

   MnuItem1()
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mbutprs">ft_MButPrs()</a></code>, <code><a href="#ft_mbutrel">ft_MButRel()</a></code></div>
</section>

<section id="ft_mdefcrs">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MDefCrs()</code></h4>
<div class="d-ol">Define the mouse cursor</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MDefCrs( &lt;nCrsType&gt;, &lt;nScrMask&gt;, &lt;nCrsMask&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nCrsType&gt; is the cursor type. A value of 0 indicates the software cursor</div>
  <div>(the default) and a value of 1 indicates the hardware cursor.</div>
  <div>&lt;nScrMask&gt; is the screen mask for the software cursor or the first scan</div>
  <div>line of the hardware cursor. See the description for more information.</div>
  <div>&lt;nCrsMask&gt; is the cursor mask for the software cursor of the last scan</div>
  <div>line of the hardware cursor. See the description for more information.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>In text mode the mouse cursor can either be a software generated or the actual hardware cursor. This routine allows one choose between them. The software cursor is the default and its effect on the character it covers is determined by the screen mask and the cursor mask. Both of these masks are 16-bit values (which in Clipper are passed as standard numerical values). The 16-bit masks are arranged in a manner identical to the way information is stored for each character cell on the screen. The low order 8 bits represent the actual character displayed while the high order bits represent the display atributes such as blinking, intensity and forground and background colors. The mask is represented in the diagram below:</div>
  <div><p>Bit:     │15    │14      12│11       │10       8│7       0│ Function:│blink │background│intensity│foreground│character│</div>
  <div><p>Blinking and high intensity are on when the bit is 1. The background and foreground indicate which colors are used for each. The software mouse cursor uses these two values by taking the mask from the screen cell it is on and performing a logical AND on each bit with the screen mask value. The result is then logically XOR'ed with the cursor mask value. Thus to keep the character the same but invert the foreground and background colors the following values would be used:</div>
  <div><p>Bit:     │15    │14      12│11       │10       8│7       0│ Function:│blink │background│intensity│foreground│character│ screen:  │  0   │   111    │    0    │   111    │11111111 │ =30719 cursor:  │  0   │   111    │    0    │   111    │00000000 │ =30464</div>
  <div><p>The hardware cursor is the text cursor provided by the video board. One specifies the range of scan lines which are on using &lt;nScrMask&gt; and &lt;nCrsMask&gt;. The range of values is dependant upon the type of monitor. The first scan line is 0.</div>
</div>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_mgetcoord">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MGetCoord()</code></h4>
<div class="d-ol">Get mouse cursor position (text coord.) and button status</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MGetPos( @&lt;nX&gt;, @&lt;nY&gt; ) &rarr; nButtonStatus</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nX&gt; is a variable that will receive the mouse X position in text screen coordinates.  It must be passed by reference.</div>
  <div>&lt;nY&gt; is a variable that will receive the mouse Y position in text screen coordinates.  It must be passed by reference.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>an integer representing button status</div>
  <div>- 0 for no button pressed - 1 for left pressed - 2 for right pressed - 3 for left and right pressed - 4 for middle pressed - 5 for left and middle pressed - 6 for right and middle pressed - 7 for all three buttons pressed</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Loads cursor position into x and y coordinates passed by reference and returns the button status.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL nX, nY
LOCAL nButton := ft_MGetCoord( @nX, @nY )
? &quot;Mouse Row    :&quot;, nX
? &quot;Mouse Column :&quot;, nY
? &quot;Button Status:&quot;, nButton
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetpos">ft_MGetPos()</a></code>, <code><a href="#ft_msetpos">ft_MSetPos()</a></code>, <code><a href="#ft_mdefcrs">ft_MDefCrs()</a></code>, <code><a href="#ft_mgetx">ft_MGetX()</a></code>, <code><a href="#ft_mgety">ft_MGetY()</a></code></div>
</section>

<section id="ft_mgetpage">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MGetPage()</code></h4>
<div class="d-ol">Get the display page for the mouse pointer</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MGetPage() &rarr; &lt;nPage&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;nPage&gt;  is the display page on which the mouse is currently being</div>
  <div>displayed</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">This function gets the display page for the mouse cursor. The valid values of nPage is dependent upon the display mode. See ft_SetVPg() for changing the current video page</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
nPage := ft_MGetPage( )  // Gets the mouse cursor display page
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_msetpage">ft_MSetPage()</a></code></div>
</section>

<section id="ft_mgetpos">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MGetPos()</code></h4>
<div class="d-ol">Get mouse cursor position and button status</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MGetPos( @&lt;nX&gt;, @&lt;nY&gt; ) &rarr; nButtonStatus</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nX&gt; is a variable that will receive the mouse X position in virtual screen coordinates.  It must be passed by reference.</div>
  <div>&lt;nY&gt; is a variable that will receive the mouse Y position in virtual screen coordinates.  It must be passed by reference.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>an integer representing button status</div>
  <div>- 0 for no button pressed - 1 for left pressed - 2 for right pressed - 3 for left and right pressed - 4 for middle pressed - 5 for left and middle pressed - 6 for right and middle pressed - 7 for all three buttons pressed</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Loads cursor position into x and y coordinates passed by reference and returns the button status. The coordinate system in text mode has eight virtual coordinates per character cell. Thus x=16 means that you are in the Row 2. The values returned by this routine when in text mode and with mouse driver versions 6 and above are multiples of 8. We have experience with drivers prior to that version</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL nX, nY
LOCAL nButton := ft_MGetPos( @nX, @nY )
? &quot;Mouse Row    :&quot;, nX
? &quot;Mouse Column :&quot;, nY
? &quot;Button Status:&quot;, nButton
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetcoord">ft_MGetCoord()</a></code>, <code><a href="#ft_msetpos">ft_MSetPos()</a></code>, <code><a href="#ft_mdefcrs">ft_MDefCrs()</a></code>, <code><a href="#ft_mgetx">ft_MGetX()</a></code>, <code><a href="#ft_mgety">ft_MGetY()</a></code></div>
</section>

<section id="ft_mgetsens">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MGetSens()</code></h4>
<div class="d-ol">Get the mouse sensitivity parameters</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MGetSens( &lt;@nHoriz&gt;, &lt;@nVert&gt;, &lt;@nDouble&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nHoriz&gt;  is the percentage of maximum horizontal sensitivity. PASSED</div>
  <div>BY REFERENCE.</div>
  <div>&lt;nVert&gt;   is the percentage of maximum vertical sensitivity. PASSED BY</div>
  <div>REFERENCE.</div>
  <div>&lt;nDouble&gt; is the percentage of maximum sensitivity for doubling the</div>
  <div>mouse cursor's speed on the screen. PASSED BY REFERENCE.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This function returns the current values of the mouse movement sensitivity parameters. The first two arguments control the amount of movement necessary to move the cursor a given amount. The third argument determines the threshold above which the mouse moves at twice the normal speed. For further discussion of these values see ft_MSetSens()</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MGetSens( @nHoriz, @nVert, @nDouble )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_msetsens">ft_MSetSens()</a></code></div>
</section>

<section id="ft_mgetx">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MGetX()</code></h4>
<div class="d-ol">Get mouse cursor row position</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MGetX() &rarr; nRowPos</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">NONE</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>&lt;nRowPos&gt; which is the row position of mouse in virtual screen</div>
  <div>coordinates.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Retrieves mouse's row position in virtual screen coordinates. The values returned are multiples of 8 when in text mode and with at least Microsoft drivers 6 and above.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_MGetX()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetcoord">ft_MGetCoord()</a></code>, <code><a href="#ft_mdefcrs">ft_MDefCrs()</a></code>, <code><a href="#ft_mgetpos">ft_MGetPos()</a></code>, <code><a href="#ft_mgety">ft_MGetY()</a></code></div>
</section>

<section id="ft_mgety">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MGetY()</code></h4>
<div class="d-ol">Get mouse cursor column position</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MGetY() &rarr; nColPos</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">NONE</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;nColPos&gt; Column position of mouse in virtual screen coordinates</div>
<div class="d-d">Description</div>
<div class="d-it">Retrieves mouse's column position in virtual screen coordinates. The values returned are multiples of 8 when in text mode and with at least Microsoft drivers 6 and above.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_MGetY()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetcoord">ft_MGetCoord()</a></code>, <code><a href="#ft_mdefcrs">ft_MDefCrs()</a></code>, <code><a href="#ft_mgetpos">ft_MGetPos()</a></code>, <code><a href="#ft_mgetx">ft_MGetX()</a></code></div>
</section>

<section id="ft_mhidecrs">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MHideCrs()</code></h4>
<div class="d-ol">Decrement internal mouse cursor flag and hide mouse cursor</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MHideCrs() &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">NONE</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Hides the mouse cursor. Make sure to turn the mouse cursor off when redrawing screens.  The mouse cursor dutifully saves the screen under it, so if you draw over the mouse cursor it will create a &quot;hole&quot; in your screen when you move the mouse cursor.</div>
  <div><p>Note: A call to ft_MHideCrs() decrements a mouse driver variable which indicates whether the cursor is shown. The cursor is visible only when the variable = 0. Thus multiple calls to ft_MHideCrs() require an equal number of calls to ft_MShowCrs() before the cursor will again be visible. Once the variable is 0 calls to ft_MShowCrs() does not increment the varaible above 0.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MHideCrs()
@ 10, 10 TO 20, 20
ft_MShowCrs()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mshowcrs">ft_MShowCrs()</a></code>, <code><a href="#ft_mconoff">ft_MCOnOff()</a></code></div>
</section>

<section id="ft_minit">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MInit()</code></h4>
<div class="d-ol">Initialize the mouse driver, vars and return status of mouse</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MInit() &rarr; lMouseStatus</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">NONE</div>
<div class="d-d">Returns</div>
<div class="d-it">An logical representing the mouse status (.F. == mouse not installed)</div>
<div class="d-d">Description</div>
<div class="d-it">Initializes the mouse drive, associated variables and returns mouse status. It checks to see if the mouse has been previously initialized and if so it does not reinitialize. The row and column limits of mouse movement is set to the maximum for the current video mode. Use ft_MShowCrs() to display the mouse cursor.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ! ft_MInit()
   ? &quot;No mouse driver is installed&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mreset">ft_MReset()</a></code></div>
</section>

<section id="ft_minregion">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MInRegion()</code></h4>
<div class="d-ol">Test if the mouse cursor is in the passed region</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MInRegion( &lt;nT&gt;, &lt;nL&gt;, &lt;nB&gt;, &lt;nR&gt; ) &rarr; lInRegion</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nT&gt;, &lt;nL&gt; &lt;nB&gt; &lt;nR&gt; are the four corners of the screen region.</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if mouse is in specified region.</div>
<div class="d-d">Description</div>
<div class="d-it">This function will check to see if the mouse cursor is within the confines of the specified region.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_MInRegion( 10, 10, 11, 20 )
   nChoice := 1
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mxlimit">ft_MXLimit()</a></code>, <code><a href="#ft_mylimit">ft_MYLimit()</a></code>, <code><a href="#ft_minregion">ft_MInRegion()</a></code></div>
</section>

<section id="ft_mmickeys">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MMickeys()</code></h4>
<div class="d-ol">Get mickeys</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MMickeys( @&lt;nX&gt;, @&lt;nY&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nX&gt; is a variable that will receive the vertical mickey count.</div>
  <div>&lt;nY&gt; is a variable that will receive the horizontal mickey count.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">&lt;nX&gt; and &lt;nY&gt; must be passed by reference to receive the mouse position in Mickeys.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MMickeys( @nX, @nY )
? nX
? nY
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_mreset">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MReset()</code></h4>
<div class="d-ol">Reset mouse driver and return status of mouse</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MReset() &rarr; nMouseStatus</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">NONE</div>
<div class="d-d">Returns</div>
<div class="d-it">An integer representing the mouse status (0 == mouse not installed)</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Resets the mouse driver and returns mouse status. Use ft_MShowCrs() to display the mouse cursor. The mouse is set to allow it to cover the complete screen (as defined by MaxCol() and MaxRow()). This is necessary because at least some versions of the mouse drivers do not operate according to the documentation when confronted with a 43 or 50 line screen.</div>
  <div><p>Normally, ft_MInit() should be used to initialize the mouse since it will not reinitialize if already done.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF Empty( ft_MReset() )
   ? &quot;No mouse driver is installed&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_minit">ft_MInit()</a></code>, <code><a href="#ft_mshowcrs">ft_MShowCrs()</a></code></div>
</section>

<section id="ft_msetcoord">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MSetCoord()</code></h4>
<div class="d-ol">Position the mouse cursor using text screen coordinates</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MSetPos( &lt;nX&gt;, &lt;nY&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nX&gt; is the desired mouse row.</div>
  <div>&lt;nY&gt; is the desired mouse column.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">Positions mouse cursor on screen using text (normal row and column) coordinates.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MSetCoord( 10, 20 )     // position mouse cursor at row 10, col 20
                           // in text screen coordinates
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetpos">ft_MGetPos()</a></code>, <code><a href="#ft_mgetcoord">ft_MGetCoord()</a></code>, <code><a href="#ft_msetpos">ft_MSetPos()</a></code>, <code><a href="#ft_mdefcrs">ft_MDefCrs()</a></code>, <code><a href="#ft_mgetx">ft_MGetX()</a></code>, <code><a href="#ft_mgety">ft_MGetY()</a></code></div>
</section>

<section id="ft_msetpage">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MSetPage()</code></h4>
<div class="d-ol">Set the display page for the mouse pointer</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MSetPage( &lt;@nPage&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nPage&gt; is the desired display page.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This function sets the display page for the mouse cursor. The valid values of nPage is dependent upon the display mode. See ft_SetVPg() for changing the current video page</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MSetPage( 1 )  // Sets the mouse cursor to page 1
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetpage">ft_MGetPage()</a></code></div>
</section>

<section id="ft_msetpos">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MSetPos()</code></h4>
<div class="d-ol">Position the mouse cursor using virtual screen coordinates</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MSetPos( &lt;nX&gt;, &lt;nY&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nX&gt; is the desired mouse row.</div>
  <div>&lt;nY&gt; is the desired mouse column.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">Positions mouse cursor on screen. The virtual coordinate system in text mode has eight virtual coordinates per character cell. Thus x=16 means that you are in the Row 2.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MSetPos( 10, 20 )     // position mouse cursor at row 10, col 20
                         // in virtual screen coordinates
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetpos">ft_MGetPos()</a></code>, <code><a href="#ft_mgetcoord">ft_MGetCoord()</a></code>, <code><a href="#ft_msetcoord">ft_MSetCoord()</a></code>, <code><a href="#ft_mgetx">ft_MGetX()</a></code>, <code><a href="#ft_mgety">ft_MGetY()</a></code></div>
</section>

<section id="ft_msetsens">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MSetSens()</code></h4>
<div class="d-ol">Set the mouse sensitivity parameters</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MSetSens( &lt;nHoriz&gt;, &lt;nVert&gt;, &lt;nDouble&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nHoriz&gt;  is the sensitivity of the mouse on the horizontal axis. This</div>
  <div>value is the integer percentage of highest sensitivity and thus has a range of 1 to 100. The default value is 50 and at this setting about 3.2 inches of mouse movement will move the mouse cursor across the screen. If NIL, the current value is used.</div>
  <div>&lt;nVert&gt;   is the relative sensitivity of the mouse on the vertical axis.</div>
  <div>The value is an integer percentage of the highest sensitivity and thus has a range of 1 to 100. The default value is 50 and requires about 2 inches of mouse movement will move from top to bottom of the screen.If NIL, the current value is used.</div>
  <div>&lt;nDouble&gt; is the relative sensitivity of the mouse to doubling the ratio</div>
  <div>of cursor movement to mouse movement. The default value is 50. If NIL, the current value is used.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function allows one to control the mouse movement sensitivity. The first two arguments control the amount of movement necessary to move the cursor a given amount. The values are the percentage of full sensitivity and the default values after installing the mouse driver is 50 which represents approximately 3.2 inches of horizontal and 2 inches of vertical mouse movement to cover the entire screen. A value of 100 requires about 0.9 inches of horizontal mouse movement to cover the screen from one side to the other.</div>
  <div><p>The third argument changes the threshold above which the mouse moves at twice the normal speed. The value is a percentage of full sensitivity with the default (50) providing doubling at 64 mickeys per second.</div>
  <div><p>NOTE: These values are NOT restored after resetting the mouse driver/ hardware. A well behaved application should reset them to the original value upon exiting.</div>
  <div><p>NOTE: The above description is counter to all of the documentation I have available. However, it does not work the way it is documented with Microsoft drivers versions 6.16, 6.24, 7.04 and 8.20. The above movement values are documented to be the number of mickeys per 8 pixels and the double speed value as the number mickeys per second required to double the speed. Each of these values should range from 1 to 32000 but the driver forces a maximum of 100. Also the documentation states that resetting the mouse will reset these values. This is not the case.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MSetSens( 75, 75, 50 )     // a little less mouse movement necessary.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mgetsens">ft_MGetSens()</a></code></div>
</section>

<section id="ft_mshowcrs">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MShowCrs()</code></h4>
<div class="d-ol">Increment internal cursor flag and display mouse cursor</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MShowCrs() &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">NONE</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Displays the mouse cursor. Make sure to turn the mouse cursor off when redrawing screens.  The mouse cursor dutifully saves the screen under it, so if you draw over the mouse cursor it will create a &quot;hole&quot; in your screen when you move the mouse cursor.</div>
  <div><p>Note: A call to ft_MHideCrs() decrements a mouse driver variable which indicates whether the cursor is shown. The cursor is visible only when the variable = 0. Thus multiple calls to ft_MHideCrs() require an equal number of calls to ft_MShowCrs() before the cursor will again be visible. Once the variable is 0 calls to ft_MShowCrs() does not increment the variable above 0.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF Empty( ft_MReset() )
   ft_MShowCrs()
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mhidecrs">ft_MHideCrs()</a></code>, <code><a href="#ft_mconoff">ft_MCOnOff()</a></code></div>
</section>

<section id="ft_mversion">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MVersion()</code></h4>
<div class="d-ol">Get the mouse driver version</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MVersion( &lt;@nMinor&gt;, &lt;@nType&gt;, &lt;@nIRQ&gt;  ) &rarr; &lt;nMajor&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nMinor&gt;  is the Minor version number. PASSED BY REFERENCE. &lt;nType&gt;   is the Mouse type. PASSED BY REFERENCE.</div>
  <div>1 = Bus Mouse 2 = Serial Mouse 3 = InPort Mouse 4 = PS/2 Mouse 5 = HP Mouse</div>
  <div>&lt;nIRQ&gt;    is the IRQ number used for the mouse. PASSED BY REFERENCE.</div>
  <div>0 = PS/2 2,3,4,5 or 7 = IRQ number</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">&lt;nMajor&gt; which is the major version number of the mouse driver.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function returns the current values of the mouse driver version number and type. The major version would be 6 and the minor version would be 10 if the driver were version 6.10. The mouse type and IRQ numbers are also returned.</div>
  <div><p>NOTE: It appears that the values reported when one starts the mouse driver actually have the minor version in hexadecimal! Thus on bootup my screen showed 6.24 but this routine returned 30 for the minor version number!</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
nMajor := ft_MVersion( @nMinor )
IF ( nMajor + nMinor / 100 ) &lt; 7.2
   ? &quot;Sorry mouse driver version too old&quot;
   RETURN
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_msetsens">ft_MSetSens()</a></code></div>
</section>

<section id="ft_mxlimit">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MXLimit()</code></h4>
<div class="d-ol">Set vertical bounds of mouse using virtual screen coord.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MXLimit( &lt;nX1&gt;, &lt;nX2&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nX1&gt; is the top row limit.</div>
  <div>&lt;nX2&gt; is the bottom row limit.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">Set maximum vertical bounds of mouse using virtual screen coordinates.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MXLimit( 10, 20 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mylimit">ft_MYLimit()</a></code>, <code><a href="#ft_minregion">ft_MInRegion()</a></code></div>
</section>

<section id="ft_mylimit">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/mouse1.txt">Improve this doc</a></span>
<h4><code>ft_MYLimit()</code></h4>
<div class="d-ol">Set horiz. bounds of mouse using virtual screen coordinates</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_MYLimit( &lt;nY1&gt;, &lt;nY2&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nY1&gt; is the left column limit.</div>
  <div>&lt;nY2&gt; is the right column limit.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">Set maximum horizontal bounds of mouse using virtual screen coordinates.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_MYLimit( 10, 20 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_mxlimit">ft_MXLimit()</a></code>, <code><a href="#ft_minregion">ft_MInRegion()</a></code></div>
</section>

<section id="ft_numlock">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/numlock.txt">Improve this doc</a></span>
<h4><code>ft_NumLock()</code></h4>
<div class="d-ol">Return status of NumLock key</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NumLock( [ &lt;lNewSetting&gt; ] ) &rarr; lCurrentSetting</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;lNewSetting&gt; is optional and if supplied is the new setting for the CapLock key.  Specify .T. to turn CapLock on, or .F. to turn it off.</div>
<div class="d-d">Returns</div>
<div class="d-it">lValue is .T. if NumLock is set, .F. if it isn't set.  The value returned represents the setting in effect prior to any changes that might by made by &lt;lNewSetting&gt;.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful if you need to know or set the status of the NumLock key for some reason.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_NumLock()
   ? &quot;NumLock is active&quot;
ENDIF

// Another one, slightly strange, courtesy of Glenn Scott:

#include &quot;inkey.ch&quot;

FUNCTION numBlink()
   LOCAL lOldNum := ft_NumLock()

   DO WHILE Inkey( 0.5 ) != K_ESC
      ft_NumLock( ! ft_NumLock() )
   ENDDO

   RETURN ft_NumLock( lOldNum )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_caplock">ft_CapLock()</a></code>, <code><a href="#ft_ctrl">ft_Ctrl()</a></code>, <code><a href="#ft_prtscr">ft_PrtScr()</a></code>, <code><a href="#ft_shift">ft_Shift()</a></code>, <code><a href="#ft_alt">ft_Alt()</a></code></div>
</section>

<section id="ft_prtscr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/prtscr.txt">Improve this doc</a></span>
<h4><code>ft_PrtScr()</code></h4>
<div class="d-ol">Enable or disable the Print Screen key</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_PrtScr( [ &lt;lSetStat&gt; ] ) &rarr; lCurStat</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;lSetStat&gt; set to .T. will enable the Print Screen key, .F. will disable it.  If omitted, leaves status as is.</div>
<div class="d-d">Returns</div>
<div class="d-it">The current state: .T. if enabled, .F. if disabled.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is valuable if you have a need to disable the printscreen key.  It works by fooling the BIOS into thinking that a printscreen is already in progress.  The BIOS will then refuse to invoke the printscreen handler.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_PrtScr( .F. )       // Disable the printscreen key
ft_PrtScr( .T. )       // Enable the printscreen key
MemVar := ft_PrtScr()  // Get the current status
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_caplock">ft_CapLock()</a></code>, <code><a href="#ft_ctrl">ft_Ctrl()</a></code>, <code><a href="#ft_numlock">ft_NumLock()</a></code>, <code><a href="#ft_shift">ft_Shift()</a></code>, <code><a href="#ft_alt">ft_Alt()</a></code></div>
</section>

<section id="ft_putkey">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/putkey.txt">Improve this doc</a></span>
<h4><code>ft_PutKey()</code></h4>
<div class="d-ol">Stuff a keystroke into the keyboard buffer</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_PutKey( &lt;nKeyValue&gt; ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nKeyValue&gt; is the Inkey() value of the keystroke to be stuffed.</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if the keystroke was put into the keyboard buffer. .F. if nKeyValue was invalid or the buffer was full.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is similar to the KEYBOARD command, with a few exceptions. First, this function does not clear the keyboard buffer before inserting the keystroke.  In addition, since it uses the Inkey() value, you can stuff any key, including function keys, into the keyboard buffer. However, this also means that unlike the KEYBOARD command, you can only stuff one keystroke at a time.</div>
  <div><p>You can easily create a User-Defined Command that makes this function even more like the KEYBOARD command.  For example,</div>
  <div><p>#xcommand KEYSTROKE &lt;key&gt; =&gt; ft_PutKey( &lt;key&gt; )</div>
  <div><p>will create a command called KEYSTROKE that could be used as a companion command to KEYBOARD.  The only difference is that it would insert a single keystroke instead of a string.</div>
  <div><p>Be aware that this function makes use of Clipper's internal event handler.  If you don't like using internals, then don't use this function, you sniveling coward.</div>
  <div><p>This function is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, rearrange the SEGMENT and PROC directives and make any other necessary changes to the source code.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_PutKey( -9 )   //  Stuff the F10 key
ft_PutKey( 276 )  //  Stuff the Alt+T key
KEYBOARD 28       //  Stuff the F1 key using a User-Defined Command
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_scancode">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/scancode.txt">Improve this doc</a></span>
<h4><code>ft_ScanCode()</code></h4>
<div class="d-ol">Wait for keypress and return keyboard scan code</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ScanCode() &rarr; cCode</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">A two-character string, corresponding to the keyboard scan code.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_ScanCode() enables you to distinguish the different scancodes of similar keys (such as Grey minus versus regular minus), thus increasing the number of keys your input routine can recognize.</div>
  <div><p>It works like Inkey(), in that it waits for a key to be pressed. The scan code consists of two bytes, which are returned as a two-character string.</div>
  <div><p>For example, calling ft_ScanCode() and pressing the Grey-minus key will return a two character string:</div>
  <div><p>hb_BChar( 45 ) + hb_BChar( 74 )</div>
  <div><p>LastKey() is not updated by ft_ScanCode(), so don't try to test LastKey() to see what was pressed during an ft_ScanCode() call.  Simply assign the return value to a variable and test that (see the test driver below).</div>
  <div><p>*  This was adapted from a short C routine posted by John Kaster on</div>
  <div><p>NANFORUM.  It was written in Clipper to help demonstrate the ft_int86() function of the Nanforum Toolkit.</div>
  <div><p>This program requires ft_int86().</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_ScanCode()

// &lt;grey-&gt; returns: hb_BChar( 45 ) + hb_BChar( 74 )
// &lt;-&gt;     returns: hb_BChar( 45 ) + hb_BChar( 12 )
// &lt;grey+&gt; returns: hb_BChar( 43 ) + hb_BChar( 78 )
// &lt;+&gt;     returns: hb_BChar( 43 ) + hb_BChar( 13 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_setrate">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/kspeed.txt">Improve this doc</a></span>
<h4><code>ft_SetRate()</code></h4>
<div class="d-ol">Set the keyboard delay and repeat rate on PC/AT &amp; PS/2</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetRate( [ &lt;nDelayTime&gt; ] [, &lt;nRepeatRate&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nDelayTime&gt; is the keyboard delay time.</div>
  <div>&lt;nRepeatRate&gt; is the keyboard repeat rate.</div>
  <div>┌───────────────────────┐  ┌────────────────────────┐ │ nDelayTime      DELAY │  │ RepeatRate      SPEED  │ ├───────────────────────┤  ├────────────────────────┤ │     0           250ms │  │    0           30.0cps │ │     1 (default) 500ms │  │    1           26.7cps │ │     2           750ms │  │    2           24.0cps │ │     3          1000ms │  │    3           21.8cps │ └───────────────────────┘  │    4           20.0cps │</div>
  <div>│    5           18.5cps │ │    6           17.1cps │ │    7           16.0cps │ │    8           15.0cps │ │    9           13.3cps │ │   10           12.0cps │ │   11           10.9cps │ │   12 (default) 10.0cps │ │   13            9.2cps │ │   14            8.6cps │ │   15            8.0cps │ │   16            7.5cps │ │   17            6.7cps │ │   18            6.0cps │ │   19            5.5cps │ │   20            5.0cps │ │   21            4.6cps │ │   22            4.3cps │ │   23            4.0cps │ │   24            3.7cps │ │   25            3.3cps │ │   26            3.0cps │ │   27            2.7cps │ │   28            2.5cps │ │   29            2.3cps │ │   30            2.1cps │ │   31            2.0cps │ └────────────────────────┘</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This routine is used to adjust the IBM PC/AT and PS/2 &quot;typematic&quot; repeat and delay feature.  This is used to allow the users of your application to adjust these speeds to the most comfortable level.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_SetRate( 0, 0 )    // Set keyboard to fastest possible settings
ft_SetRate()          // Set keyboard to AT defaults (10.9cps,500ms delay)
ft_SetRate( 11, 1 )   // Set keyboard to PS/2 defaults (10cps,500ms delay)
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_shift">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/shift.txt">Improve this doc</a></span>
<h4><code>ft_Shift()</code></h4>
<div class="d-ol">Determine status of shift key</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Shift() &rarr; lValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if a shift key is pressed, .F. if otherwise.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful for times you need to know whether or not the shift key is pressed, such as during a MemoEdit().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_Shift()
   @ 0, 0 SAY &quot;Shift&quot;
ELSE
   @ 0, 0 SAY &quot;     &quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_caplock">ft_CapLock()</a></code>, <code><a href="#ft_ctrl">ft_Ctrl()</a></code>, <code><a href="#ft_numlock">ft_NumLock()</a></code>, <code><a href="#ft_prtscr">ft_PrtScr()</a></code>, <code><a href="#ft_alt">ft_Alt()</a></code></div>
</section>

<section id="ft_sinkey">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/sinkey.txt">Improve this doc</a></span>
<h4><code>ft_SInkey()</code></h4>
<div class="d-ol">Replacement for Inkey() that tests for SET KEY procedures</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SInkey( [ &lt;nWaitTime&gt; ] ) &rarr; nKey</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nWaitTime&gt; is the number of seconds to wait.  If zero, ft_SInkey() will wait indefinitely for a keypress.  If not passed, ft_SInkey() does not wait for a keypress.  If NIL, it is treated the same as 0.</div>
<div class="d-d">Returns</div>
<div class="d-it">The Inkey() value of the key pressed.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_SInkey() is similar to the function provided by Nantucket in keyboard.prg, with one significant difference: you can pass NIL to Inkey(), which will be treated as a zero (i.e., wait indefinitely for keypress).  Therefore, it is necessary to differentiate between an explicit NIL and one that is a result of a formal parameter NOT being received.</div>
  <div><p>ft_SInkey() differs from the standard Inkey() in that it will respond to any keys set with SET KEY TO or SetKey().</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
SetKey( K_F1, {| n, l, r | HELP( n, l, r ) } )
? ft_SInkey( 0 )       // HELP() will be called if F1 pressed
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Keyboard/Mouse</div>
</section>

<section id="ft_gcd">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/gcd.txt">Improve this doc</a></span>
<h4><code>ft_GCD()</code></h4>
<div class="d-ol">Calculate greatest common divisor of two numbers</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_GCD( &lt;nNumber1&gt;, &lt;nNumber2&gt; ) &rarr; nGCD</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nNumber1&gt; is the first number to find the GCD of.</div>
  <div>&lt;nNumber2&gt; is the second number to find the GCD of.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The greatest common divisor of the 2 numbers, or 0 if either is 0.</div>
<div class="d-d">Description</div>
<div class="d-it">This function calculates the greatest common divisor between 2 numbers, i.e., the largest number that will divide into both numbers evenly.  It will return zero (0) if either number is zero.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_GCD( 10, 15 )                  // Result: 5
? ft_GCD( 108, 54 )                 // Result: 54
? ft_GCD( 102, 54 )                 // Result: 6
? ft_GCD( 111, 17 )                 // Result: 1
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Math</div>
</section>

<section id="ft_netpv">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/netpv.txt">Improve this doc</a></span>
<h4><code>ft_NetPV()</code></h4>
<div class="d-ol">Calculate net present value</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NetPV( &lt;nInitialInvestment&gt;, &lt;nInterestRate&gt;, &lt;aCashFlow&gt; ;</code><code>[, &lt;nNoOfCashFlows&gt; ] ) &rarr; nNetPV</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nInitialInvestment&gt; is the amount of cash invested for purposes of generating the cash flows.</div>
  <div>&lt;nInterestRate&gt; is the annual interest rate used to discount expected cash flows (10.5% = 10.5, not .105).</div>
  <div>&lt;aCashFlow&gt; is an array of the expected cash receipts each year.</div>
  <div>&lt;nNoOfCashFlows&gt; is the number of years cash flows are expected (optional, Len( aCashFlow ) ).</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The difference between the initial investment and the discounted cash flow in dollars.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function calculates the net present value, the difference between the cost of an initial investment and the present value of the expected cash flow(s) from the investment.  The present value of the expected cashflow(s) is calculated at the specified interest rate, which is often referred to as the &quot;cost of capital&quot;.</div>
  <div><p>This function can be used to evaluate alternative investments. The larger the NPV, the more profitable the investment.  See also the FutureValue and PresentValue for further explanations. The formula to calculate the net present value is:</div>
  <div><p>NetPresentValue := SUM( CashFlow[ i ] / ( ( 1 + InterestRate ) ^ i ) ) FOR i := 1 TO NoOfCashFlows</div>
  <div><p>//</div>
  <div><p>NEXT</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_NetPV( 10000, 10, { 10000, 15000, 16000, 17000 } )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Math</div>
</section>

<section id="ft_rand1">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/rand1.txt">Improve this doc</a></span>
<h4><code>ft_Rand1()</code></h4>
<div class="d-ol">Generate a random number</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Rand1( &lt;nMax&gt; ) &rarr; nRand</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nMax&gt;  Maximum limit of value to be produced.</div>
<div class="d-d">Returns</div>
<div class="d-it">nRand is a random number between 0 (inclusive) and &lt;nMax&gt; (exclusive).</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Generates a non-integer random number based on the Linear Congruential Method.</div>
  <div><p>If you need a random number between 1 and &lt;nMax&gt; inclusive, Int() the result and add 1.</div>
  <div><p>If you need a random number between 0 and &lt;nMax&gt; inclusive, then you should Round() the result.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? Int( ft_Rand1( 100 ) ) + 1    // 1 &lt;= nResult &lt;= 100
? Round( ft_Rand1( 100 ), 0 )   // 0 &lt;= nResult &lt;= 100
? ft_Rand1( 1 )                 // 0 &lt;= nResult &lt; 1
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Math</div>
</section>

<section id="ft_round">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/round.txt">Improve this doc</a></span>
<h4><code>ft_Round()</code></h4>
<div class="d-ol">Rounds a number to a specific place</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Round( &lt;nNumber&gt; [, &lt;nRoundToAmount&gt;           ;</code><code>[, &lt;cRoundType&gt;  [, &lt;cRoundDirection&gt;   ; [, &lt;nAcceptableError&gt; ] ] ] ] )            &rarr; nNumber</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nNumber&gt; is the number to round</div>
  <div>&lt;nRoundToAmount&gt; is the fraction to round to or the number of places, default is 2.</div>
  <div>&lt;cRoundType&gt; is the type of rounding desired</div>
  <div>&quot;D&quot; for Decimal       (3 for thousandth, 1/1000)  (default) &quot;F&quot; for Fraction      (3 for thirds, 1/3) &quot;W&quot; for Whole numbers (3 for thousand, 1000)</div>
  <div>&lt;cRoundDirection&gt; is the direction to round the number toward</div>
  <div>&quot;U&quot; to round Up      1.31 &rarr;  1.4</div>
  <div>-1.31 &rarr; -1.4</div>
  <div>&quot;D&quot; to round Down    1.36 &rarr;  1.3</div>
  <div>-1.36 &rarr; -1.3</div>
  <div>&quot;N&quot; to round Normal  1.5  &rarr;  2</div>
  <div>-1.5  &rarr; -2</div>
  <div>1.49 &rarr;  1</div>
  <div>-1.49 &rarr; -1</div>
  <div>&lt;nAcceptableError&gt; is the amount that is considered acceptable to be within, i.e., if you're within this amount of the number you don't need to round</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The number, rounded as specified.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function will allow you to round a number.  The following can be specified:</div>
  <div><p>a. Direction (up, down or normal - normal is 4/5 convention) b. Type (whole, decimal, fraction) c. Amount (100's, 5 decimals, 16th, etc.)</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// round normal to 2 decimal places
? ft_Round( nDollars )

// round normal to 6 decimal places
? ft_Round( nIntRate, 6 )

// round to nearest thousands
? ft_Round( nPrice, 3, NEAREST_WHOLE_NUMBER )

// round Up to nearest third
? ft_Round( nAmount, 3, NEAREST_FRACTION, ROUND_UP )

// round down to 3 decimals Within .005
? ft_Round( nAvg, 3, , ROUND_DOWN, .005 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Math</div>
</section>

<section id="ft_adder">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/popadder.txt">Improve this doc</a></span>
<h4><code>ft_Adder()</code></h4>
<div class="d-ol">Pop up a simple calculator</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Adder()</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>NIL .... but optionally places Total of calculation in active</div>
  <div>Get variable using oGet:varPut()</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>PopAdder() gives you an adding machine inside your Clipper 5.2 application. It has the basic functions add, subtract, multiply, and divide. You may move it from one side of the screen to the other. It even displays a scrollable tape, if you want it.</div>
  <div><p>There are a few HOT Keys while using the Adder:</div>
  <div><p>&lt;D&gt;ecimals - change # of decimals &lt;M&gt;ove     - the Adder from right display to left &lt;T&gt;ape     - turn the Tape Display On or Off &lt;S&gt;croll   - the tape display &lt;DEL&gt; <hr>-- 1st Clear entry</div>
  <div><p>+-- 2nd Clear ADDER</div>
  <div><p>&lt;ESC&gt;      - Quit &lt;F10&gt;      - return a &lt;TOTAL&gt; to the active get</div>
  <div><p>A couple of notes about the adder:</div>
  <div><p>1. It was designed to be used on an Enhanced keyboard with</div>
  <div><p>separate &lt;DELETE&gt; key. &lt;DELETE&gt; is used to clear the adder. However, it will still work on a Standard keyboard.</div>
  <div><p>2. You do not have to display the tape. You may turn it on</div>
  <div><p>at any time by pressing &lt;T&gt;. You may SCROLL back through the tape once there are more than 16 entries in the adder, by pressing &lt;S&gt;.</div>
  <div><p>3. To Quit the Adder just press &lt;ESC&gt;. To return your Total</div>
  <div><p>to the application press &lt;F10&gt;. The adder will place the Total in the active GET variable using oGet:varPut(). The adder will only return a Total to a numerical GET!</div>
  <div><p>4. There are many support functions that you might find</div>
  <div><p>interesting. They are part of my personal library, but are necessary to the operation of the adder. You might want to pull these out to reduce the overall size of the adder. Many are worth at least a little time studying.</div>
  <div><p>5. To make ft_Adder() a Hot key from inside your application</div>
  <div><p>at the beginning of your application add the line:</div>
  <div><p>SetKey( K_ALT_A, {|| ft_Adder() } )</div>
  <div><p>This will make &lt;ALT-A&gt; a key &quot;Hot&quot; and permit you to Pop - Up the adder from anywhere in the application.</div>
  <div><p>6. If you use ft_SInkey(), you can even have active hotkeys</div>
  <div><p>in an Inkey().</div>
</div>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_blink">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/blink.txt">Improve this doc</a></span>
<h4><code>ft_Blink()</code></h4>
<div class="d-ol">Display a blinking message on the screen</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Blink( &lt;cMsg&gt;, [ &lt;nRow&gt; ], [ &lt;nCol&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cMsg&gt; is the string to blink.</div>
  <div>&lt;nRow&gt; is an optional screen row for @...SAY, default current.</div>
  <div>&lt;nCol&gt; is an optional screen col for @...say, default current.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">A quick way to blink a msg on screen in the CURRENT colors. Restores colors on return.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_Blink( &quot;WAIT&quot;, 5, 10 )   // Blinks &quot;WAIT&quot; in current colors @ 5,10

@ 5, 10 SAY &quot;WAIT - Printing Report&quot;
ft_Blink( &quot;...&quot; )           //  Blink &quot;...&quot; after wait message...
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_brwswhl">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/tbwhile.txt">Improve this doc</a></span>
<h4><code>ft_BrwsWhl()</code></h4>
<div class="d-ol">Browse an indexed database limited to a while condition</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_BrwsWhl( &lt;aFields&gt;, &lt;bWhileCond&gt;, &lt;cKey&gt;,                  ;</code><code>[ &lt;nFreeze&gt; ], [ &lt;lSaveScrn&gt; ], [ &lt;cColorList&gt; ], ; [ &lt;cColorShadow&gt; ], [ &lt;nTop&gt; ], [ &lt;nLeft&gt; ],      ; [ &lt;nBottom&gt; ], [ &lt;nRight&gt; ] &rarr; nRecno</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aFields&gt; is array of field blocks of fields you want to display.</div>
  <div>Example to set up last name and first name in array: aFields := {} AAdd( aFields, { &quot;Last Name&quot; , {|| Names&rarr;Last }  } ) AAdd( aFields, { &quot;First Name&quot;, {|| Names&rarr;First } } )</div>
  <div>&lt;bWhileCond&gt; is the limiting WHILE condition as a block.</div>
  <div>Example 1: {|| Names&rarr;Last == &quot;JONES&quot; } Example 2: {|| Names&rarr;Last == &quot;JONES&quot; .AND. Names&rarr;First == &quot;A&quot;  }</div>
  <div>&lt;cKey&gt; is the key to find top condition of WHILE.</div>
  <div>cLast  := &quot;JONES     &quot; cFirst := &quot;A&quot; Example 1: cKey := cLast Example 2: cKey := cLast + cFirst</div>
  <div>&lt;nFreeze&gt; is number of fields to freeze in TBrowse.  Defaults to 0 if not passed.</div>
  <div>&lt;lSaveScrn&gt; is a logical indicating whether or not you want to save the screen from the calling program.  Defaults to .T. if not passed.</div>
  <div>&lt;cColorList&gt; is a list of colors for the TBrowse columns. The 1st color is used as SAY/TBrowse Background and the 3rd and 4th colors are used as part of column:defColor := { 3, 4 }</div>
  <div>Thus if you pass a cColorList, you MUST pass at least 4 colors. Defaults to &quot;N/W, N/BG, B/W, B/BG, B/W, B/BG, R/W, B/R&quot; if not passed.</div>
  <div>&lt;cColorShad&gt; is the color of the TBrowse box shadow.  Defaults to &quot;N/N&quot; if not passed.</div>
  <div>&lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt; are the coordinates of the area to display the TBrowse in.  Defaults to 2, 2, MaxRow() - 2, MaxCol() - 2 with shadowed box, i.e. full screen.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">nRecno is the number of the record selected by the &lt;Enter&gt; key. 0 is returned if there are either no records matching the WHILE condition or an &lt;Esc&gt; is pressed instead of an &lt;Enter&gt;</div>
<div class="d-d">Description</div>
<div class="d-it">This is a demonstration of TBrowse with a WHILE condition for an indexed database.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This example will only show those people with last name of &quot;JONES&quot;
// in the TBNames.dbf which contains at least the fields:
// Last, First, City AND is indexed on Last + First.
LOCAL nRecSel    := 0
LOCAL aFields    := {}
LOCAL bWhile     := {|| TBNames-&gt;Last = &quot;JONES&quot; }
LOCAL cKey       := &quot;JONES&quot;
LOCAL nFreeze    := 1
LOCAL lSaveScrn  := .T.
LOCAL cColorList := &quot;N/W, N/BG, B/W, B/BG, B/W, B/BG, R/W, B/R&quot;
LOCAL cColorShad := &quot;N/N&quot;

USE tbnames INDEX tbnames NEW  // indexed on Last + First

// Pass Heading as character and Field as Block including Alias
// To eliminate the need to use FieldWBlock() function in ft_BrwsWhl()
AAdd( aFields, { &quot;Last Name&quot; , {|| TBNames-&gt;Last }  } )
AAdd( aFields, { &quot;First Name&quot;, {|| TBNames-&gt;First } } )
AAdd( aFields, { &quot;City&quot;      , {|| TBNames-&gt;City }  } )

IF ft_BrwsWhl( aFields, bWhile, cKey, nFreeze, lSaveScrn, ;
   cColorList, cColorShad, 3, 6, MaxRow() - 2, MaxCol() - 6 ) == 0
   ? &quot;Sorry, No records were selected&quot;
ELSE
   ? &quot;You Selected:&quot;, TBNames-&gt;Last, TBNames-&gt;First, TBNames-&gt;City
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_clrsel">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/clrsel.txt">Improve this doc</a></span>
<h4><code>ft_ClrSel()</code></h4>
<div class="d-ol">User Selectable Color Routine</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ClrSel( &lt;aClrData&gt;, [ &lt;lClrMode&gt; ], [ &lt;cTestChr&gt; ]  &rarr; aClrData</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aClrData&gt; is an array of subarrays, with each subarray containing</div>
  <div>information about the color settings.</div>
  <div>The subarray has the following structure:</div>
  <div>[ 1 ] cName    is the name of this color setting i.e. &quot;Pick List&quot;</div>
  <div>Maximum length is 20 bytes</div>
  <div>[ 2 ] cClrStr  is the current color string</div>
  <div>Default is &quot;W/N,N/W,N/N,N/N,N/W&quot;</div>
  <div>If Setting type is &quot;M&quot; (Menu) the colors are...</div>
  <div>1.  Prompt Color 2.  Message Color 3.  HotKey Color 4.  LightBar Color 5.  LightBar HotKey Color</div>
  <div>Note: While there are many ways to code the individual</div>
  <div>color combinations,  they should be in the same format that gets returned from SetColor(), so the defaults can be found in the color palette.</div>
  <div>foreground [+] / background [*] i.e. &quot;GR+/BG*, N/W*, N+/N, , W/N&quot;</div>
  <div>[ 3 ] cType  is the type of color setting</div>
  <div>Default is &quot;W&quot; (Window)</div>
  <div>T = Title     Only 1 color element D = Desktop   Background color and character M = Menu      For ft_MenuTo() style menus W = Window    Windows with radio buttons G = Get       For use with @ SAY... B = Browse    For TBrowse() and *dbEdit() A = aChoice   Pick-lists etc...</div>
  <div>W/G/B/A are functionally the same but will provide a more appropriate test display.</div>
  <div>[ 4 ] cFillChar  is the character (for desktop background only)</div>
  <div>Default is &quot;▒▒▒▒▒▒▒▒▒▒▒▒▒▒&quot;</div>
  <div>&lt;lClrMode&gt;   .T.  use color palette</div>
  <div>.F.  use monochrome palette</div>
  <div>Default is the IsColor() setting</div>
  <div>&lt;cTestChr&gt;  2 Byte character string for color test display</div>
  <div>Default is &quot;■■&quot;</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">An array identical to the one passed, with new selected colors</div>
<div class="d-d">Description</div>
<div class="d-it">This function allows users to select their own color combinations for all the different types of screen I/O in a typical application. This facilitates an easy implementation of Ted Means' replacement of the  @..PROMPT/MENU TO found in the NanForum Toolkit.  If you are not using ft_MenuTo(), you can specify &quot;A&quot; for setting type and have a normal color string returned.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL aClrs
LOCAL lColor := IsColor()

Set( _SET_SCOREBOARD, .F. )
SetBlink( .F. )       // Allow bright backgrounds

// .... a typical application might have the following different settings
//      normally these would be stored in a .dbf/.dbv
aClrs := { ;
   { &quot;Desktop&quot;,        &quot;N/BG&quot;,                          &quot;D&quot;, &quot;▒&quot; }, ;
   { &quot;Title&quot;,          &quot;N/W&quot;,                           &quot;T&quot;      }, ;
   { &quot;Top Menu&quot;,       &quot;N/BG,N/W,W+/BG,W+/N,GR+/N&quot;,     &quot;M&quot;      }, ;
   { &quot;Sub Menu&quot;,       &quot;W+/N*,GR+/N*,GR+/N*,W+/R,G+/R&quot;, &quot;M&quot;      }, ;
   { &quot;Standard Gets&quot;,  &quot;W/B,  W+/N,,, W/N&quot;,             &quot;G&quot;      }, ;
   { &quot;Nested Gets&quot;,    &quot;N/BG, W+/N,,, W/N&quot;,             &quot;G&quot;      }, ;
   { &quot;Help&quot;,           &quot;N/G,  W+/N,,, W/N&quot;,             &quot;W&quot;      }, ;
   { &quot;Error Messages&quot;, &quot;W+/R*,N/GR*,,,N/R*&quot;,            &quot;W&quot;      }, ;
   { &quot;Database Query&quot;, &quot;N/BG, N/GR*,,,N+/BG&quot;,           &quot;B&quot;      }, ;
   { &quot;Pick List&quot;,      &quot;N/GR*,W+/B,,, BG/GR*&quot;,          &quot;A&quot;      } }

aClrs := ft_ClrSel( aClrs, lColor )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_dispmsg">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/dispmsg.txt">Improve this doc</a></span>
<h4><code>ft_DispMsg()</code></h4>
<div class="d-ol">Display a message and optionally waits for a keypress</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_DispMsg( &lt;aMessageArray&gt;, [ &lt;cKey2Check&gt; ],</code><code>[ &lt;nTopBoxRow&gt; ], [ &lt;nLeftBoxColumn&gt; ], [ &lt;cnBoxType&gt; ], [ &lt;lShadow&gt; ] ) &rarr; lKeyMatch</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aMessageArray&gt; is a multidimensional array of messages to be displayed and the color attributes for each message.</div>
  <div>The first dimension of the array contains one or more elements, each representing one line in the message box, up to the maximum number of rows on the screen.</div>
  <div>Within each line of the message individual characters or groups of characters may be delimited with braces ([]).  The braces will be stripped out and the character(s) inside those braces will be highlighted.</div>
  <div>The second dimension of the array contains a color attribute for the corresponding element in dimension one, plus one additional element for the color of the box border.  Dimension two will always contain one more element than dimension one.  If an attribute is omitted, the last color selected will be used.</div>
  <div>&lt;Key2Check&gt; is a character string of one or more keys to check for.  If omitted, the message is displayed and control is returned to the calling procedure.  If one character is specified, ft_DispMsg() waits for one keypress, restores the screen and returns.  If multiple characters are specified, ft_DispMsg() remains in a loop until one of the specified keys has been pressed, then restores the screen and returns.</div>
  <div>&lt;nTopBoxRow&gt; is the upper row for the message box.  If omitted, the box is centered vertically.</div>
  <div>&lt;nLeftBoxColumn&gt; is the leftmost column for the box.  If omitted, the box is centered horizontally.</div>
  <div>&lt;cnBoxType&gt; is a string of characters or a variable for the box border.  See the DispBox() function.  If omitted, a double box is drawn.</div>
  <div>&lt;lShadow&gt; is a logical variable.  If true (.T.) or omitted, it uses ft_Shadow() to add a transparent shadow to the box.  If false (.F.), the box is drawn without the shadow.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>If &lt;Key2Check&gt; is not specified, ft_DispMsg() will return false (.F.).</div>
  <div>If &lt;Key2Check&gt; is a one-character string, ft_DispMsg() will return true (.T.) if the user presses that key, or false (.F.) if any other key is pressed.</div>
  <div>If &lt;Key2Check&gt; consists of multiple characters, it will lock the user in a loop until one of those keys are pressed and return the Inkey() value of the keypress.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">ft_DispMsg() is a multi-purpose pop-up for user messages. Multiple lines may be displayed, each with a different attribute. The box will be automatically centered on the screen, or the row and/or column can be specified by the programmer.  It also centers each line of the message within the box.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following example displays a simple two-line message
// and returns immediately to the calling routine.

ft_DispMsg( { { &quot;Printing Report&quot;, ;
   &quot;Press [ESC] To Interrupt&quot; }, ;
   { &quot;W+/B*&quot;, &quot;W/B&quot;, &quot;GR+/B&quot; } } )

// The next example displays a message and waits for a key press.

ft_DispMsg( { { &quot;Press [D] To Confirm Deletion&quot;, ;
   &quot;Or Any Other Key To Abort&quot; }, ;
   { &quot;W+/B&quot;, &quot;W+/B&quot;, &quot;GR+/B&quot; } }, ;
   &quot;D&quot; )

// The next example displays a one-line message centered on row 5
// and returns to the calling procedure.

ft_DispMsg( { { &quot;Please Do Not Interrupt&quot; }, ;
   { &quot;W+/B&quot;, &quot;GR+/B&quot; } }, ;
   , 5, )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_fill">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/menu1.txt">Improve this doc</a></span>
<h4><code>ft_Fill()</code></h4>
<div class="d-ol">Declare menu options for ft_Menu1()</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Fill( &lt;aSubArrayName&gt;, &lt;cMenuSelection&gt;, &lt;bFunction&gt;,</code><code>&lt;lSelectable&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aSubArrayName&gt; is a sub-array of &lt;acOptions&gt; in ft_Menu1() denoting the group in which to include the selection -- e.g., acOptions[ 1 ]</div>
  <div>&lt;cMenuSelection&gt; is the character string that will appear on the menu.</div>
  <div>&lt;bFunction&gt; is the code block to be executed when that menu option is selected.  i.e. {|| MyFunction() } would execute the function called MyFunction().  {|| .F. } would exit the ft_Menu1() and return to the calling routine.  {|| .T. } would do nothing.</div>
  <div>&lt;lSelectable&gt; is a logical variable that determines whether the corresponding menu option is selectable or not.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">ft_Fill() is a function used to set up the menu options prior to calling ft_Menu1().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_Fill( aOptions[ 1 ], &quot;A. Execute A Dummy Procedure&quot; , {|| fubar() }, .T. )

The above would be added to the sub-menu associated with the first menu
bar item, would execute the function FUBAR() when that option was
selected, and would be selectable.


ft_Fill( aOptions[ 3 ], &quot;B. Enter Daily Charges&quot;       , {|| .T. },     .F. )

The above would be added to the sub-menu associated with the third menu
bar item, and would be unselectable.


ft_Fill( aOptions[ 2 ], &quot;C. Enter Payments On Accounts&quot;, {|| .T. },     .T. )

The above would be added to the sub-menu associated with the second menu
bar item, and would be selectable, but would do nothing when selected.


ft_Fill( aOptions[ 4 ], &quot;C. Exit&quot;                      , {|| .F. },     .T. )

The above would be added to the sub-menu associated with the fourth menu
bar item, and would be selectable, and would exit ft_Menu1() when chosen.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_menu1">ft_Menu1()</a></code></div>
</section>

<section id="ft_menu1">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/menu1.txt">Improve this doc</a></span>
<h4><code>ft_Menu1()</code></h4>
<div class="d-ol">Pulldown menu system</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Menu1( &lt;acBarNames&gt;, &lt;acOptions&gt;, &lt;acAction&gt;,</code><code>&lt;acColors&gt; [, &lt;nTopRow&gt; ], [ &lt;lShadow&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;acBarNames&gt; is a character array containing the names to appear on the menu bar.</div>
  <div>&lt;acOptions&gt; is a multi-dimensional array with one element for each selection to appear on the pulldown menus.</div>
  <div>&lt;acColors&gt; is an array containing the colors for the menu groups.</div>
  <div>&lt;nTopRow&gt; is a numeric value that determines the row for the menu bar.  If omitted, it defaults to 0.</div>
  <div>&lt;lShadow&gt; is a logical variable.  If true (.T.) or omitted, it uses ft_Shadow() to add a transparent shadow to the each pulldown menu.  If false (.F.), the menu is drawn without the shadow.</div>
  <div>All arguments except nTopRow and lShadow are required.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Menu1() is a function that displays a pulldown menu for each item on the menu bar and executes the corresponding function for the item selected.  When a called function returns false, ft_Menu1() returns control to the calling program.</div>
  <div><p>Valid keystrokes and their corresponding actions:</div>
  <div><p>Home             -  Activates Pulldown for first item on the menu bar End              -  Activates Pulldown for last item on the menu bar Left Arrow       -  Activates next Pulldown to the left Right Arrow      -  Activates next Pulldown to the right Tab              -  Same as Right Arrow Shift-Tab        -  Same as Left Arrow Page Up          -  Top item on current Pulldown menu Page Down        -  Bottom item on current Pulldown menu Enter            -  Selects current item Alpha Character  -  Moves to closest match and selects Alt-&lt;Key&gt;        -  Moves to corresponding menu bar item Escape           -  Prompts for confirmation and either returns to</div>
  <div><p>the calling routine or resumes</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Declare arrays
LOCAL aColors  := {}
LOCAL aBar     := { &quot; ENTER/EDIT &quot;, &quot; REPORTS &quot;, &quot; DISPLAY &quot; }

// Include the following two lines of code in your program, as is.
// The first creates aOptions with the same length as aBar.  The
// second assigns a three-element array to each element of aOptions.
LOCAL aOptions[ Len( aBar ) ]
AEval( aBar, {| x, i | aOptions[ i ] := { {}, {}, {} } } )

// fill color array
// Box Border, Menu Options, Menu Bar, Current Selection, Unselected
aColors := iif( lColor, ;
   { &quot;W+/G&quot;, &quot;N/G&quot;, &quot;N/G&quot;, &quot;N/W&quot;, &quot;N+/G&quot; }, ;
   { &quot;W+/N&quot;, &quot;W+/N&quot;, &quot;W/N&quot;, &quot;N/W&quot;, &quot;W/N&quot; } )

// array for first pulldown menu
ft_Fill( aOptions[ 1 ], &quot;A. Execute A Dummy Procedure&quot; , {|| fubar() }, .T. )
ft_Fill( aOptions[ 1 ], &quot;B. Enter Daily Charges&quot;       , {|| .T. },     .F. )
ft_Fill( aOptions[ 1 ], &quot;C. Enter Payments On Accounts&quot;, {|| .T. },     .T. )

// array for second pulldown menu
ft_Fill( aOptions[ 2 ], &quot;A. Print Member List&quot;         , {|| .T. },     .T. )
ft_Fill( aOptions[ 2 ], &quot;B. Print Active Auto Charges&quot; , {|| .T. },     .T. )

// array for third pulldown menu
ft_Fill( aOptions[ 3 ], &quot;A. Transaction Totals Display&quot;, {|| .T. },     .T. )
ft_Fill( aOptions[ 3 ], &quot;B. Display Invoice Totals&quot;    , {|| .T. },     .T. )
ft_Fill( aOptions[ 3 ], &quot;C. Exit To DOS&quot;               , {|| .F. },     .T. )

// Call ft_Fill() once for each item on each pulldown menu, passing it
// three parameters:

ft_Fill( &lt;cMenuSelection&gt;, &lt;bCodeBlock&gt;, &lt;lSelectable&gt;

// &lt;cMenuSelection&gt; is a character string which will be displayed on
// the pulldown menu.

// &lt;bCodeBlock&gt; should contain one of the following:

//   A function name to execute, which in turn should return .T. or .F.
//   ft_Menu1() WILL RETURN CONTROL TO THE CALLING PROGRAM IF .F. IS
//   RETURNED OR CONTINUE IF .T. IS RETURNED.

//   .F. WHICH WILL CAUSE ft_Menu1() TO RETURN CONTROL TO THE CALLING
//   PROGRAM.

//   .T. WHICH WILL DO NOTHING.  THIS ALLOWS THE DEVELOPER TO DESIGN A
//   SKELETON MENU STRUCTURE PRIOR TO COMPLETING ALL OF THE SUBROUTINES.

// CALL ft_Menu1()
ft_Menu1( aBar, aOptions, aColors, 0 )

// NOTE: ft_Menu1() disables Alt-C and Alt-D in order to make them
//       available for the menu bar.  It enables Alt-D and resets
//       Alt-C to its previous state prior to calling each function.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_fill">ft_Fill()</a></code></div>
</section>

<section id="ft_menu2">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/vertmenu.txt">Improve this doc</a></span>
<h4><code>ft_Menu2()</code></h4>
<div class="d-ol">Vertical lightbar menu</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Menu2( &lt;aMenuarray&gt; [, &lt;cColors&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;aMenuarray&gt; is an array of menu options, messages, and action</div>
  <div>blocks.</div>
  <div>Each element in this array is a nested array with the structure:</div>
  <div>element[ x, 1 ] = menu option element[ x, 2 ] = message to be displayed when option is highlighted element[ x, 3 ] = code block to be executed when option is selected</div>
  <div>&lt;cColors&gt; is a string containing colors for the prompts, in the same format as that returned by Set( _SET_COLOR ).  If not supplied, colors default to the current color setting.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function greatly simplifies the process of displaying light-bar menus.  All prompts are padded out with spaces so they are the same length, a box is drawn around the prompts, the box is automatically centered on the screen, and the underlying screen is restored after a menu selection has been made.</div>
  <div><p>Additionally, because you can tie action blocks to each menu option, you can save on a lot of DO CASE or IF..ELSEIF code in your main program.  See the test code for a succinct demonstration.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL mainmenu := { ;
   { &quot;Data Entry&quot;,  &quot;Enter data&quot;,    {|| ft_Menu2( datamenu )  } }, ;
   { &quot;Reports&quot;,     &quot;Hard copy&quot;,     {|| ft_Menu2( repmenu )   } }, ;
   { &quot;Maintenance&quot;, &quot;Reindex files&quot;, {|| ft_Menu2( maintmenu ) } }, ;
   { &quot;Quit&quot;, &quot;See ya later&quot; } }
ft_Menu2( mainmenu )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_menuto">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/menutonf.txt">Improve this doc</a></span>
<h4><code>ft_MenuTo()</code></h4>
<div class="d-ol">Execute light bar menu using prompts created with @...PROMPT</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>#include &quot;ftmenuto.ch&quot;</code><code>MENU TO &lt;var&gt; [COLD]</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;var&gt; is the name of the variable to which the result of the menu selection should be assigned.</div>
  <div>[COLD] is optional and if specified indicates that trigger characters should be treated as &quot;cold,&quot; i.e. rather than causing the menu item to be selected it only causes the light bar to move to that selection.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This enhanced version of MENU TO requires the inclusion of the header file ftmenuto.ch in any source file that uses it.  It may be used in place of the standard Clipper MENU TO command.  However, in the interests of functionality it is NOT 100% compatible (in particular, you should make sure that the target memvar exists before executing the menu -- the Clipper version will create a PRIVATE memvar for you if it does not already exist, but this version does not).  No whining! If compatibility is such a big deal then use the standard Clipper command.</div>
  <div><p>Note that this command can also be called using function-style syntax.  See the entry for ft_MenuTo() for further details.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#include &quot;ftmenuto.ch&quot;

// Simple command
MENU TO memvar
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_prompt">ft_Prompt()</a></code></div>
</section>

<section id="ft_pending">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/pending.txt">Improve this doc</a></span>
<h4><code>ft_Pending()</code></h4>
<div class="d-ol">Display same-line pending messages after a wait.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Pending( &lt;cMsg&gt;, [ &lt;nRow&gt; ], [ &lt;nCol&gt; ], ;</code><code>[ &lt;nWait&gt; ], [ &lt;cColor&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cMsg&gt; is the message string to display.</div>
  <div>&lt;nRow&gt; is an optional screen row for message display, default row 24.</div>
  <div>&lt;nCol&gt; is an optional screen col for message display, default col 0.</div>
  <div>&lt;nWait&gt; is an optional wait (sec) between messages, default 5 sec.</div>
  <div>&lt;cColor&gt; is an optional color string for displayed messages, default</div>
  <div>is white text over red background.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>A good way to display information messages during the running of an application is to send them all to the SAME line on the screen where users are expected to look for them. In order to give users a chance to read the current message before the next one is displayed we may need to insert a delay after each message.</div>
  <div><p>ft_Pending() function displays messages by keeping track of the time of the last message and providing a delay ONLY if the next pending message is issued much too soon after the current one.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_Pending( &quot;Message one&quot;, 20, 0, 3, &quot;W+/G&quot; ) // Displays &quot;Message one.&quot;
                                              // sets row to 20, col to 0.
                                              // wait to 3 and color to
                                              // bright white over green.
ft_Pending( &quot;Message two&quot; )   // Displays &quot;Message two&quot;, after 5 sec.
ft_Pending( &quot;Message three&quot; ) // Displays &quot;Message three&quot;, after 5 sec.


// Note that default row, col, wait time and color need to be set only
// once in the very first call to ft_Pending() and only if the internal
// default values are not appropriate.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_pickday">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/pickday.txt">Improve this doc</a></span>
<h4><code>ft_PickDay()</code></h4>
<div class="d-ol">Picklist of days of week</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_PickDay() &rarr; cDayOfWeek</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">Character string containing day of week</div>
<div class="d-d">Description</div>
<div class="d-it">This function is ideal if you need the user to select a day.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_PickDay()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_prompt">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/menutonf.txt">Improve this doc</a></span>
<h4><code>ft_Prompt()</code></h4>
<div class="d-ol">Define a menu item for use with ft_MenuTo()</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>#include &quot;ftmenuto.ch&quot;</code><code>@ &lt;nRow&gt;, &lt;nCol&gt; PROMPT &lt;cPrompt&gt;                     ;</code><code>[COLOR &lt;cColor&gt;]                     ; [MESSAGE &lt;cMessage&gt;]                 ; [MSGROW &lt;nMsgRow&gt;]                   ; [MSGCOL &lt;nMsgCol&gt;]                   ; [MSGCOLOR &lt;cMsgColor&gt;]               ; [TRIGGER &lt;nTrigger&gt;]                 ; [TRIGGERCOLOR &lt;cTriggerColor&gt;]       ; [HOME &lt;nHome&gt;]                       ; [END &lt;nEnd&gt;]                         ; [UP &lt;nUp&gt;]                           ; [DOWN &lt;nDown&gt;]                       ; [LEFT &lt;nLeft&gt;]                       ; [RIGHT &lt;nRight&gt;]                     ; [EXECUTE &lt;bExec&gt;]                    ;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nRow&gt; is the row at which the prompt is to appear.</div>
  <div>&lt;nCol&gt; is the column at which the prompt will appear.</div>
  <div>&lt;cPrompt&gt; is the menu item string.</div>
  <div>&lt;cColor&gt; is optional and is the color attribute of the prompt.  Note that two colors are required; one for the standard setting and one for the enhanced setting (i.e. the light bar color).  See the example below if this isn't clear.  If &lt;cColor&gt; is not specified then the current SetColor() value is used by default.</div>
  <div>&lt;cMessage&gt; is optional and is the message associated with the prompt. If not specified, then no message will be displayed.</div>
  <div>&lt;nMsgRow&gt; is optional and is the row at which the message, if any, will appear.  If not specified, the default is the current setting of the SET MESSAGE TO command.</div>
  <div>&lt;nMsgCol&gt; is optional and is the column at which the message, if any, will appear.  If not specified, the default is either zero or centered, depending on the current setting of the CENTER option of the SET MESSAGE TO command.</div>
  <div>&lt;cMsgColor&gt; is optional and is the color attribute of the message. If not specified, the default is the same as the prompt color.</div>
  <div>&lt;nTrigger&gt; is optional and is the position within the prompt string where the trigger character is located.  If not specified, the default is one.</div>
  <div>&lt;cTriggerColor&gt; is optional and is the color attribute of the trigger character.  Note that two colors are required; one for the standard setting and one for the enhanced setting (i.e. the light bar color). See the example below if this isn't clear.  If &lt;cTriggerColor&gt; is not specified then the default is the same color as the rest of the prompt.</div>
  <div>&lt;nHome&gt; is optional and specifies which prompt becomes active when the home key is pressed.  If not specified, the default is the first prompt.</div>
  <div>&lt;nEnd&gt; is optional and specifies which prompt becomes active when the end key is pressed.  If not specified, the default is the last prompt.</div>
  <div>&lt;nUp&gt; is optional and specifies which prompt becomes active when the up arrow key is pressed.  If not specified, the default is the previous prompt.  The current setting of SET WRAP TO is obeyed.</div>
  <div>&lt;nDown&gt; is optional and specifies which prompt becomes active when the down arrow key is pressed.  If not specified, the default is the next prompt.  The current setting of SET WRAP TO is obeyed.</div>
  <div>&lt;nRight&gt; is optional and specifies which prompt becomes active when the right arrow key is pressed.  If not specified, the default is the next prompt.  The current setting of SET WRAP TO is obeyed.</div>
  <div>&lt;nLeft&gt; is optional and specifies which prompt becomes active when the left arrow is pressed.  If not specified, the default is the previous prompt.  The current setting of SET WRAP TO is obeyed.</div>
  <div>&lt;bExec&gt; is optional and is a code block to evaluate whenever the menu item to which it belongs is selected.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Clipper's @...PROMPT and MENU TO commands are fine as far as they go.  But many times you need more flexibility.  As you'll no doubt notice if you read the argument list, this function is almost completely flexible. You can adjust locations and colors for every part of the prompt and its associated message.  In addition, since you can control the effect of the arrow keys, you can allow both horizontal and vertical movement, or even disable certain arrow keys if you so desire.  Support for nested menus is also available, since the prompts are stored in stack-based static arrays.</div>
  <div><p>Note that this command can also be called using function-style syntax.  See the entry for ft_Prompt() for further details.</div>
  <div><p>This enhanced version of @...PROMPT requires the inclusion of the header file ftmenuto.ch in any source file that uses it. It is may be used in place of the standard Clipper @...PROMPT command.  However, in the interests of functionality it is NOT 100% compatible.  No whining!  If compatibility is such a big deal then use the standard Clipper commands.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
#include &quot;ftmenuto.ch&quot;

// Simple prompt
@  1, 1 PROMPT &quot;Menu choice #1&quot;

// Prompt with color
@  3, 1 PROMPT &quot;Menu choice #2&quot; COLOR &quot;W+/R,W+/B&quot;

// Prompt with a message
@  5, 1 PROMPT &quot;Menu choice #3&quot; MESSAGE &quot;Go to lunch&quot;

// Prompt with pinpoint message control
@  7, 1 PROMPT &quot;Menu choice #4&quot; MESSAGE &quot;Drop Dead&quot; ;
   MSGROW 22 MSGCOL 4 MSGCOLOR &quot;GR+/N&quot;

// Prompt with a trigger character (&quot;#&quot; character)
@ 11, 1 PROMPT &quot;Menu choice #6&quot; TRIGGER 13

// Prompt with trigger character color control
@ 13, 1 PROMPT &quot;Menu Choice #7&quot; TRIGGER 13 TRIGGERCOLOR &quot;R+/BG,G+/N&quot;

// Prompt with right and left arrow keys disabled
@ 15, 1 PROMPT &quot;Menu Choice #8&quot; RIGHT 8 LEFT 8
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_sleep">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/sleep.txt">Improve this doc</a></span>
<h4><code>ft_Sleep()</code></h4>
<div class="d-ol">Wait for a specified amount of time</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Sleep( &lt;nSeconds&gt;, [&lt;nInitial&gt;] ) &rarr; nil</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nSeconds&gt; is the number of seconds to pause</div>
  <div>&lt;nInitial&gt; is an optional clock value (from a call to Seconds())</div>
  <div>from which the &lt;nSeconds&gt; seconds are to elapse. Useful for setting a minimum time between the start of events which could take a variable amount of time due to the execution of intervening code.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This routine will wait a specified period of time. It provides resolution based upon the execution of the Seconds() function. It does not use an input state such as Inkey(). The specified time is the minimum time sleeping and will usually be slightly longer.</div>
  <div><p>The second optional argument allows one to begin timing an event prior to executing some operation. This is useful when, for example, you input a key or mouse click and wish to do something but still want to note if the user double entered (mouse or key) within a certain time which in turn may have meaning within your program's context.</div>
  <div><p>The routine correctly handles passing through midnight but will not work for more than 24 hours.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Example 1:
ft_Sleep( 10.0 )     // Sleep for 10.0 seconds
// Example 2:
nTime := Seconds()   // usually after some interupt from mouse or
                     // keyboard

// ... intervening code ...

// ft_Sleep( 0.5, nTime ) // Sleep until the sytem clock is
                          // nTime+0.5 seconds.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_xbox">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/xbox.txt">Improve this doc</a></span>
<h4><code>ft_XBox()</code></h4>
<div class="d-ol">Display a self-sizing message box and message</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_XBox( [ &lt;cJustType&gt; ], [ &lt;cRetWait&gt; ], [ &lt;cBorType&gt; ],   ;</code><code>[ &lt;cBorColor&gt; ], [ &lt;cBoxColor&gt; ], [ &lt;nStartRow&gt; ], ; [ &lt;nStartCol&gt; ], &lt;cLine1&gt;,  &lt;cLine2&gt;, &lt;cLine3&gt;,    ; &lt;cLine4&gt;, &lt;cLine5&gt;, &lt;cLine6&gt;, &lt;cLine7&gt;, &lt;cLine8&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cJustType&gt; is a character indicating the type of text justification. &quot;L&quot; or &quot;l&quot; will cause the text to be left-justified in the box. Centered text is the default.</div>
  <div>&lt;cRetWait&gt; is a character which determines if the function will wait for a keypress after displaying the box.  &quot;W&quot; or &quot;w&quot; will cause the function to wait for a keypress before returning control to the calling routine.  Not waiting is the default</div>
  <div>&lt;cBorType&gt; is a character which determines whether a single or double border will be displayed.  &quot;D&quot; or &quot;d&quot; will cause a double border to be displayed.  A single border is the default.</div>
  <div>&lt;cBorColor&gt; is a character string denoting the border color.  'N/W' is the default if this parameter is not a string.</div>
  <div>&lt;cBoxColor&gt; is a character string denoting the text color.  'W/N' is the default if this parameter is not a string.</div>
  <div>&lt;nStartRow&gt; is a number denoting the starting row.  If '99' is passed, the box is centered vertically.  If necessary, nStartRow is decreased so the entire box can be displayed.</div>
  <div>&lt;nStartCol&gt; is a number denoting the starting column.  If '99' is passed, the box is centered horizontally.  If necessary, nStartCol is decreased so the entire box can be displayed.</div>
  <div>&lt;cLine1&gt; thru &lt;cLine8&gt; are 1 to 8 character strings to be displayed. They are truncated to fit on the screen if necessary.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_XBox() allows the programmer to display a message box on the screen without needing to calculate the dimensions of the box.  Only the upper left corner needs to be defined.  The function will calculate the lower right corner based on the number and length of strings passed.</div>
  <div><p>A maximum of eight strings can be displayed.  If a string is too long to fit on the screen it is truncated.</div>
  <div><p>The first seven parameters are optional.  The default settings are:</div>
  <div><p>Lines of text are centered. Control is returned to the calling routine immediately. A single line border is painted. The border is black on white. The text is white on black. The box is centered both vertically and horizontally.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following displays a two-line box with default settings:

ft_XBox( ,,,,,,, &quot;This is a test&quot;, &quot;of the ft_XBox() function&quot; )

// The following uses all optional parameters and displays a three-line
// box.  The box is left-justified with a double border.  It has a yellow
// on red border and white on blue text.  The function will wait for a
// keypress before returning control to the calling routine.

ft_XBox( &quot;L&quot;, &quot;W&quot;, &quot;D&quot;, &quot;GR+/R&quot;, &quot;W/B&quot;, 5, 10, ;
   &quot;It is so nice&quot;, ;
   &quot;to not have to do the messy chore&quot;, ;
   &quot;of calculating the box size!&quot; )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Menus/Prompts</div>
</section>

<section id="ft_nwlstat">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwlstat.txt">Improve this doc</a></span>
<h4><code>ft_NWLStat()</code></h4>
<div class="d-ol">Return the current Novell NetWare logical station number</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWLStat() &rarr; nStatNum</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">A numeric corresponding to the current logical station number assigned by NetWare.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>In order to find out information about a particular node logged in to a NetWare server, you will need the logical station number, also known as a &quot;connection number.&quot;  This function will return that number.  This will be a number from 1 to 100 under NetWare 286, or from 1 to 250 under NetWare 386.  This is <strong>not</strong> the same as a physical station number.</div>
  <div><p>This function requires ft_int86().</div>
  <div><p>This function does NOT test for the existence of the NetWare shell. The behavior is undefined if no shell is loaded.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? &quot;Logical station:&quot;, ft_NWLStat()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
</section>

<section id="ft_nwsemclose">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwsem.txt">Improve this doc</a></span>
<h4><code>ft_NWSemClose()</code></h4>
<div class="d-ol">Close a NetWare semaphore</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWSemClose( &lt;nHandle&gt; )  &rarr; nRc</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nHandle&gt; is the semaphore handle, returned from a previous call to ft_NWSemOpen().</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>nRc, a numeric, as follows:</div>
  <div>0 - success</div>
  <div>255 - invalid semaphore handle</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">Call ft_NWSemClose() when the app is finished.  This decrements the open count for the semaphore.  If the open count hits zero, the semaphore is deleted by NetWare.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? &quot;Close returns:&quot;, ft_NWSemClose( nHandle )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_nwsemopen">ft_NWSemOpen()</a></code>, <code><a href="#ft_nwsemex">ft_NWSemEx()</a></code>, <code><a href="#ft_nwsemwait">ft_NWSemWait()</a></code>, <code><a href="#ft_nwsemsig">ft_NWSemSig()</a></code>, <code><a href="#ft_nwsemlock">ft_NWSemLock()</a></code></div>
</section>

<section id="ft_nwsemex">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwsem.txt">Improve this doc</a></span>
<h4><code>ft_NWSemEx()</code></h4>
<div class="d-ol">Examine a NetWare semaphore's value and open count</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWSemEx( &lt;nHandle&gt;, &lt;@nValue&gt;, &lt;@nOpenCnt&gt; ) &rarr; nRc</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nHandle&gt; is the semaphore handle, returned from a previous call to ft_NWSemOpen().</div>
  <div>&lt;@nValue&gt; will get the current semaphore value.  THIS NUMERIC ARGUMENT MUST BE PASSED BY REFERENCE!</div>
  <div>&lt;@nOpenCnt&gt; will get the current number of workstations that have opened the semaphore.  THIS NUMERIC ARGUMENT MUST BE PASSED BY REFERENCE!</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>nRc, a numeric, as follows:</div>
  <div>0 - success</div>
  <div>255 - invalid semaphore handle</div>
  <div>In addition, nValue will be set to the semaphore's current value, and nOpenCnt will be set to the number of stations that have opened the semaphore.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">See the description for ft_NWSemOpen().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
nInitVal := 2
nHandle  := 0
nOpenCnt := 0

ft_NWSemOpen( &quot;Semaphore Test&quot;, nInitVal, @nHandle, @nOpenCnt )

nRc := ft_NWSemWait( nHandle )
IF nRc == 254
   ? &quot;All slots for this resource are currently in use&quot;
   RETURN
ENDIF

ft_NWSemEx( nHandle, @nValue, @nOpenCnt )
? &quot;Semaphore test -&gt; Open at [&quot; + ;
   hb_ntos( nOpenCnt ) + ;
   &quot;] stations, value is [&quot; + ;
   hb_ntos( nValue ) + &quot;]&quot;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_nwsemopen">ft_NWSemOpen()</a></code>, <code><a href="#ft_nwsemwait">ft_NWSemWait()</a></code>, <code><a href="#ft_nwsemsig">ft_NWSemSig()</a></code>, <code><a href="#ft_nwsemclose">ft_NWSemClose()</a></code>, <code><a href="#ft_nwsemlock">ft_NWSemLock()</a></code></div>
</section>

<section id="ft_nwsemlock">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwsem.txt">Improve this doc</a></span>
<h4><code>ft_NWSemLock()</code></h4>
<div class="d-ol">Perform a semaphore &quot;lock&quot;</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWSemLock( &lt;cSemaphore&gt;, &lt;@nHandle&gt; ) &rarr; lRet</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cSemaphore&gt; is the name of a semaphore you want to &quot;lock.&quot; &lt;nHandle&gt; is the semaphore's handle, if you get the lock. THIS MUST BE PASSED BY REFERENCE!</div>
<div class="d-d">Returns</div>
<div class="d-it">lRet == .T. if you get the lock, .T. if you don't. If the lock succeeds, &lt;nHandle&gt; will contain the semaphore handle.  If it fails, the value of &lt;nHandle&gt; is undefined.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_NWSemLock() uses the Nanforum Toolkit's NetWare Semaphore API functions in order to provide a general purpose &quot;lock&quot; you can use in a NetWare environment.</div>
  <div><p>An interesting byproduct of NetWare's semaphore functions is the &quot;open count&quot; which tells you how many connections have this semaphore open.  This is different from the semaphore's <i>value</i>, which is set when the semaphore is opened and changed with Signal() and wait().</div>
  <div><p>The point of semaphores is that you don't care how many users are using the resource; you merely wait on a semaphore until the resource becomes available or you give up.  When you're done, you signal it and off you go.</div>
  <div><p>Back to the open count.  ft_NWSemLock() opens the semaphore as named in &lt;cSemaphore&gt;.  After it is opened, the open count is checked.  If it is anything other than 1, that means someone else has it (or you failed in your open) so the semaphore is closed and the &quot;lock&quot; is refused.  If the value is 1, then your app is that 1 station so the &quot;lock&quot; is granted.</div>
  <div><p>You can use a semaphore lock to control access to anything that Clipper's RLock() and FLock() can't help you with, such as text files written with the low level file i/o functions, etc.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL nHandle := 0
IF ft_NWSemLock( &quot;error.log&quot;, @nHandle )
   // Note, you aren't actually LOCKING this file, you are
   // just locking a semaphore by the same name.  As long as
   // all apps that might be using this file are cooperating
   // with the same kind of semaphore lock, you can effectively
   // control access to the file.
ELSE
   ? &quot;Couldn't lock file.&quot;
ENDIF
// Processing, then:
ft_NWSemUnlock( nHandle )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_nwsemopen">ft_NWSemOpen()</a></code>, <code><a href="#ft_nwsemex">ft_NWSemEx()</a></code>, <code><a href="#ft_nwsemwait">ft_NWSemWait()</a></code>, <code><a href="#ft_nwsemsig">ft_NWSemSig()</a></code>, <code><a href="#ft_nwsemunlock">ft_NWSemUnlock()</a></code></div>
</section>

<section id="ft_nwsemopen">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwsem.txt">Improve this doc</a></span>
<h4><code>ft_NWSemOpen()</code></h4>
<div class="d-ol">Open or create a NetWare semaphore</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWSemOpen( &lt;cName&gt;, &lt;nInitVal&gt;, &lt;@nHandle&gt;, &lt;@nOpenCnt&gt; ) &rarr; nRc</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cName&gt; is the semaphore name, maximum length is 127 characters.</div>
  <div>&lt;nInitVal&gt; is the initial value for the semaphore.  It must start as a positive number, to a maximum of 127.</div>
  <div>&lt;@nHandle&gt; is the semaphore handle.  THIS MUST BE PASSED BY REFERENCE!  On exit, &lt;nHandle&gt; will contain a numeric value that refers to the opened semaphore.  You will need it to pass to other semaphore functions!  PASS IT BY REFERENCE!</div>
  <div>&lt;@nOpenCnt&gt; is the number of stations that have opened the semaphore.  THIS MUST BE PASSED BY REFERENCE! On exit, &lt;nOpenCnt&gt; will contain a numeric value.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>nRc, a numeric result code, as follows:</div>
  <div>0 - success</div>
  <div>254 - Invalid semaphore name length 255 - Invalid semaphore value</div>
  <div>&lt;nHandle&gt; will contain the semaphore handle, and &lt;nOpenCnt&gt; will contain the number of stations that have opened the semaphore.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>A semaphore is simply a label that indirectly controls network activity.  There is a semaphore name, which can be up to 127 characters, and an associated value, which can range from 0 to 127.</div>
  <div><p>A semaphore can be used for many things, but is most often used to limit the number of users in an application, and to control access to a network resource.</div>
  <div><p>A semaphore essentially allows you to place locks on resources other than files.</div>
  <div><p>An application begins the process by calling ft_NWSemOpen(). If the semaphore doesn't exist, NetWare will create it. ft_NWSemOpen() returns a handle that is used in other semaphore calls.</div>
  <div><p>Applications use ft_NWSemWait() to wait for a semaphore to become available.  ft_NWSemWait() decrements the semaphore's value by 1.  If the value &gt; 0, then the application should be allowed to access the semaphore's resource.  If the value goes negative, then the application is placed in a queue. How long your app is in the queue is determined by how you set the timeout parameter.  If you can't get the resource in the time you allot, you're let out of the queue and the value increments by 1 again.</div>
  <div><p>When an application finishes with a semaphore, it should call ft_NWSemSig() to increment the value, and then ft_NWSemClose() to close the semaphore.  When the semaphore's open count goes to 0, NetWare deletes it.</div>
  <div><p>ft_NWSemEx() can be used to examine the value and open count without affecting them.</div>
  <div><p>For an interesting discussion on the operating system aspects of semaphores, check &quot;Operating Systems Design and Implementation&quot; by A. Tanenbaum, page 60.  For more details on NetWare's semaphore facilities, refer to Charles Rose's &quot;Programmer's Guide to NetWare&quot;.  The &quot;Programmer's Guide&quot; will make an excellent companion guide to the source code for all NetWare functions in the Nanforum Toolkit.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL nInitVal, nRc, nHandle, nOpenCnt

nInitVal := 2
nRc      := ft_NWSemOpen( &quot;Semaphore Test&quot;, nInitVal, ;
                          @nHandle, @nOpenCnt )

IF nRc != 0
   ? &quot;Error:&quot;, nRc
   RETURN
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_nwsemex">ft_NWSemEx()</a></code>, <code><a href="#ft_nwsemwait">ft_NWSemWait()</a></code>, <code><a href="#ft_nwsemsig">ft_NWSemSig()</a></code>, <code><a href="#ft_nwsemclose">ft_NWSemClose()</a></code>, <code><a href="#ft_nwsemlock">ft_NWSemLock()</a></code></div>
</section>

<section id="ft_nwsemsig">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwsem.txt">Improve this doc</a></span>
<h4><code>ft_NWSemSig()</code></h4>
<div class="d-ol">Signal a NetWare semaphore (increment)</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWSemSig( nHandle ) &rarr; nRc</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nHandle&gt; is the semaphore handle, returned from a previous call to ft_NWSemOpen().</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>nRc, a numeric, as follows</div>
  <div>0 - success 1 - semaphore overflow ( value &gt; 127 )</div>
  <div>255 - invalid semaphore handle</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Use ft_NWSemSig() when your app has finished with the resource locked by a semaphore.  This will increase the value (thus making a slot available to another app).</div>
  <div><p>For more information, see the description under ft_NWSemOpen().</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? &quot;Signal returns:&quot;, ft_NWSemSig( nHandle )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_nwsemopen">ft_NWSemOpen()</a></code>, <code><a href="#ft_nwsemex">ft_NWSemEx()</a></code>, <code><a href="#ft_nwsemwait">ft_NWSemWait()</a></code>, <code><a href="#ft_nwsemclose">ft_NWSemClose()</a></code>, <code><a href="#ft_nwsemlock">ft_NWSemLock()</a></code></div>
</section>

<section id="ft_nwsemunlock">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwsem.txt">Improve this doc</a></span>
<h4><code>ft_NWSemUnlock()</code></h4>
<div class="d-ol">&quot;Unlock&quot; a semaphore locked by ft_NWSemLock()</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWSemUnlock( &lt;nHandle&gt; ) &rarr; lRet</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nHandle&gt; is the semaphore handle returned from ft_NWSemLock()</div>
<div class="d-d">Returns</div>
<div class="d-it">lRet == .T. if you successfully unlock the semaphore, .F. if you don't.  If this call fails, it could be that you're passing an invalid semaphore handle.</div>
<div class="d-d">Description</div>
<div class="d-it">This call unlocks a semaphore prevsiously locked via ft_NWSemLock(). It is important that you get a valid semaphore handle from ft_NWSemLock() before you use this call.  Make sure when you call ft_NWSemLock() that you pass a numeric parameter in for the handle BY REFERENCE.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
LOCAL nHandle := 0
IF ft_NWSemLock( &quot;error.log&quot;, @nHandle )
   // Note, you aren't actually LOCKING this file, you are
   // just locking a semaphore by the same name.  As long as
   // all apps that might be using this file are cooperating
   // with the same kind of semaphore lock, you can effectively
   // control access to the file.
ELSE
   ? &quot;Couldn't lock file.&quot;
ENDIF
// Processing, then:
ft_NWSemUnlock( nHandle )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_nwsemopen">ft_NWSemOpen()</a></code>, <code><a href="#ft_nwsemex">ft_NWSemEx()</a></code>, <code><a href="#ft_nwsemwait">ft_NWSemWait()</a></code>, <code><a href="#ft_nwsemsig">ft_NWSemSig()</a></code>, <code><a href="#ft_nwsemlock">ft_NWSemLock()</a></code></div>
</section>

<section id="ft_nwsemwait">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwsem.txt">Improve this doc</a></span>
<h4><code>ft_NWSemWait()</code></h4>
<div class="d-ol">Wait on a NetWare semaphore (decrement)</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWSemWait( &lt;nHandle&gt; [, nTimeout ] ) &rarr; nRc</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nHandle&gt; is the semaphore handle, returned from a previous call to ft_NWSemOpen().</div>
  <div>&lt;nTimeOut&gt; is an optional parameter telling how long you wish to wait on this semaphore.  This is a numeric indicating the number of clock ticks (approx 1/18 sec ) to wait.  A zero (the default) means &quot;don't wait.&quot;</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>nRc, a numeric, as follows:</div>
  <div>0 - success</div>
  <div>254 - timeout failure 255 - invalid semaphore handle</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">See the description for the ft_NWSemOpen() function.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_NWSemOpen( &quot;Semaphore Test&quot;, nInitVal, @nHandle, @nOpenCnt )

nRc := ft_NWSemWait( nHandle )
IF nRc == 254
   ? &quot;All slots for this resource are currently in use&quot;
   RETURN
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_nwsemopen">ft_NWSemOpen()</a></code>, <code><a href="#ft_nwsemex">ft_NWSemEx()</a></code>, <code><a href="#ft_nwsemsig">ft_NWSemSig()</a></code>, <code><a href="#ft_nwsemclose">ft_NWSemClose()</a></code>, <code><a href="#ft_nwsemlock">ft_NWSemLock()</a></code></div>
</section>

<section id="ft_nwuid">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nwuid.txt">Improve this doc</a></span>
<h4><code>ft_NWUID()</code></h4>
<div class="d-ol">Return the current Novell NetWare User ID</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NWUID( [ &lt;nConnection&gt; ] ) &rarr; cUid</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nConnection&gt; is a connection number, or logical station number, to find a userid for.  Under NetWare 286, this number can be from 1 to 100.  Under NetWare 386, 1-250.  If not supplied, ft_NWUID() defaults to the current connection (i.e., the connection running the application).</div>
<div class="d-d">Returns</div>
<div class="d-it">A string containing the userid, or &quot;login name.&quot; The maximum length of this string, as defined by current versions of Novell NetWare, is 48 characters.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_NWUID() returns the current NetWare userid, or &quot;login name.&quot;  This is useful for implementing security or audit trail procedures within your programs.</div>
  <div><p>There is no simple way a user can &quot;fool&quot; this function into retrieving an incorrect value, provided a NetWare shell is loaded.</div>
  <div><p>This function requires ft_int86() and ft_NWLStat()</div>
  <div><p>This function does NOT test for the existence of the NetWare shell. The behavior is undefined if no shell is loaded. You'll usually get garbage.  This function has not been tested on NetWare 386.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? &quot;I am:&quot;, ft_NWUID()

FOR x := 1 TO 100
   cUid := ft_NWUID( x )
   IF ! Empty( cUid )
      ? Str( x, 3 ), cUid
   ENDIF
NEXT
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">NetWare</div>
</section>

<section id="ft_at2">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/at2.txt">Improve this doc</a></span>
<h4><code>ft_At2()</code></h4>
<div class="d-ol">Find position of the nth occurrence of a substring</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_At2( &lt;cSearch&gt;, &lt;cTarget&gt; [, &lt;nOccurs&gt; [, &lt;lCaseSens&gt; ] ] ) &rarr; nPos</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cSearch&gt; is the character substring to search for.</div>
  <div>&lt;cTarget&gt; is the character string to search.</div>
  <div>&lt;nOccurs&gt; is the occurrence of cSearch to look for,</div>
  <div>defaults to 1.</div>
  <div>&lt;lCaseSens&gt; is a logical value denoting case sensitivity.</div>
  <div>If .F., then search is NOT sensitive to case, defaults to .T.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The position of the nth occurrence of a substring</div>
<div class="d-d">Description</div>
<div class="d-it">This function will find the nth occurrence of a substring within a string.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
cSearch := &quot;t&quot;
cTarget := &quot;This is the day that the Lord has made.&quot;

? ft_At2( cSearch, cTarget )            // Returns 9
? ft_At2( cSearch, cTarget, 2 )         // Returns 17
? ft_At2( cSearch, cTarget, 2, .F. )    // Returns 9
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_findith">ft_FindITh()</a></code>, <code><a href="#ft_rat2">ft_RAt2()</a></code></div>
</section>

<section id="ft_bitclr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/bitclr.txt">Improve this doc</a></span>
<h4><code>ft_BitClr()</code></h4>
<div class="d-ol">Clear (reset) selected bit in a byte</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_BitClr( &lt;cByte&gt;, &lt;nBitPos&gt; ) &rarr; cByte</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cByte&gt; is a character from hb_BChar( 0 ) to hb_BChar( 255 ).</div>
  <div>&lt;nBitPos&gt; is a number from 0 to 7 conforming to standard right-to-left bit numbering convention and representing the position of the bit within the byte.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">Returns new byte, with designated bit cleared (reset). If parameters are faulty, returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>In effect, ANDs argument byte with a byte that has all bits set except the target bit.  If bit is already clear (0), it remains clear. Note: Calls ft_IsBit() which is also in this Library.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code would clear bit 4 in a byte represented by hb_BChar( 115 ):

cNewByte := ft_BitClr( hb_BChar( 115 ), 4 )
? hb_BCode( cNewbyte )    // result: 99
? cNewByte                // result: &quot;c&quot;

// This code would clear bit 5 in the byte represented by letter &quot;A&quot;:

? ft_BitClr( &quot;A&quot;, 5 )     // result: &quot;A&quot;, since bit 5 already clear
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_bitset">ft_BitSet()</a></code>, <code><a href="#ft_isbit">ft_IsBit()</a></code></div>
</section>

<section id="ft_bitset">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/bitset.txt">Improve this doc</a></span>
<h4><code>ft_BitSet()</code></h4>
<div class="d-ol">Set selected bit in a byte</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_BitSet( &lt;cByte&gt;, &lt;nBitPos&gt; ) &rarr; cByte</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cByte&gt; is a character from hb_BChar( 0 ) to hb_BChar( 255 ).</div>
  <div>&lt;nBitPos&gt; is a number from 0 to 7 conforming to standard right-to-left bit numbering convention and representing the position of the bit within the byte.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">Returns new byte, with designated bit set.  If parameters are faulty, returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>In effect, ORs argument byte with a byte that has only the target bit set.  If bit is already set, it remains set. Note: Calls ft_IsBit() which is also in this Library.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code would set bit 4 in a byte represented by hb_BChar( 107 ):

cNewbyte := ft_BitSet( hb_BChar( 107 ), 4 )
? hb_BCode( cNewbyte )        // result: 123
? cNewbyte                    // result: &quot;{&quot;


// This code would set bit 5 in the byte represented by the letter &quot;A&quot;.

? ft_BitSet( &quot;A&quot;, 5 )         // result: &quot;a&quot;
                              // bit 5 set
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_bitclr">ft_BitClr()</a></code>, <code><a href="#ft_isbit">ft_IsBit()</a></code></div>
</section>

<section id="ft_byteand">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/byteand.txt">Improve this doc</a></span>
<h4><code>ft_ByteAnd()</code></h4>
<div class="d-ol">Perform bit-wise AND on two ASCII characters (bytes)</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ByteAnd( &lt;cByte1&gt;, &lt;cByte2&gt; ) &rarr; cByte</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cByte1&gt; and &lt;cByte2&gt; are characters from hb_BChar( 0 ) to hb_BChar( 255 ). May be passed in hb_BChar() form, as character literals, or as expressions evaluating to character values.</div>
<div class="d-d">Returns</div>
<div class="d-it">Returns resulting byte, as a string.  If parameters are faulty, returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Can be used for any bit-wise masking operation.  In effect, this is a bit-by-bit AND operation.  Equivalent to AND assembler instruction.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code would mask out the high nibble (four most significant bits)
// of the byte represented by hb_BChar( 123 ) and leave the low nibble
// bits as in the parameter byte.

cNewbyte := ft_ByteAnd( hb_BChar( 123 ), hb_BChar( 15 ) )
? hb_BCode( cNewByte )     // result: 11
? cNewByte                 // result: non-printable character
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_byteor">ft_ByteOr()</a></code>, <code><a href="#ft_bytexor">ft_ByteXor()</a></code>, <code><a href="#ft_bytenot">ft_ByteNot()</a></code>, <code><a href="#ft_byteneg">ft_ByteNeg()</a></code></div>
</section>

<section id="ft_byteneg">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/byteneg.txt">Improve this doc</a></span>
<h4><code>ft_ByteNeg()</code></h4>
<div class="d-ol">Perform bit-wise negation on an ASCII character</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ByteNeg( &lt;cByte&gt; ) &rarr; cNewByte</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cByte&gt; is a character from hb_BChar( 0 ) to hb_BChar( 255 ). May be passed in hb_BChar() form, as character literals, or as expressions evaluating to character values.</div>
<div class="d-d">Returns</div>
<div class="d-it">Returns resulting byte, as a string.  If parameters are faulty, returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Can be used for bit-wise byte manipulation.  In effect, this is a bit-by-bit NEG (two's complement) operation.  Equivalent to NEG assembler instruction.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code performs a bit-wise NEG on byte represented by hb_BChar( 32 ):

cNewByte := ft_ByteNot( hb_BChar( 32 ) )
? hb_BCode( cNewByte )     // result: 224
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_byteor">ft_ByteOr()</a></code>, <code><a href="#ft_bytexor">ft_ByteXor()</a></code>, <code><a href="#ft_bytenot">ft_ByteNot()</a></code>, <code><a href="#ft_byteand">ft_ByteAnd()</a></code></div>
</section>

<section id="ft_bytenot">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/bytenot.txt">Improve this doc</a></span>
<h4><code>ft_ByteNot()</code></h4>
<div class="d-ol">Perform bit-wise NOT on an ASCII character (byte)</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ByteNot( &lt;cByte&gt; ) &rarr; cNewByte</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cByte&gt; is a character from hb_BChar( 0 ) to hb_BChar( 255 ). May be passed in hb_BChar() form, as character literals, or as expressions evaluating to character values.</div>
<div class="d-d">Returns</div>
<div class="d-it">Returns resulting byte, as a string.  If parameters are faulty, returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Can be used for bitwise byte manipulation.  In effect, this is a bit-by-bit NOT (one's complement) operation.  Equivalent to the NOT assembler instruction.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code performs a bitwise NOT on byte represented by hb_BChar( 32 ):

cNewByte := ft_ByteNot( hb_BChar( 32 ) )
? hb_BCode( cNewByte )     // result: 223
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_byteor">ft_ByteOr()</a></code>, <code><a href="#ft_bytexor">ft_ByteXor()</a></code>, <code><a href="#ft_byteneg">ft_ByteNeg()</a></code>, <code><a href="#ft_byteand">ft_ByteAnd()</a></code></div>
</section>

<section id="ft_byteor">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/byteor.txt">Improve this doc</a></span>
<h4><code>ft_ByteOr()</code></h4>
<div class="d-ol">Perform bit-wise OR on two ASCII characters (bytes)</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ByteOr( &lt;cByte1&gt;, &lt;cByte2&gt; ) &rarr; cNewByte</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cByte1&gt; and &lt;cByte2&gt; are characters from hb_BChar( 0 ) to hb_BChar( 255 ). May be passed in hb_BChar() form, as character literals, or as expressions evaluating to character values.</div>
<div class="d-d">Returns</div>
<div class="d-it">Returns resulting byte, as a string.  If parameters are faulty, returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Can be used for bit-wise byte manipulation.  In effect, this is a bit-by-bit OR operation.  Equivalent to OR assembler instruction.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code performs a bit-wise OR on two bytes represented
// by hb_BChar( 20 ) and hb_BChar( 10 ):

cNewByte := ft_ByteOr( hb_BChar( 20 ), hb_BChar( 10 ) )
? hb_BCode( cNewByte )     // result: 30
? cNewByte                 // result: non-printable character
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_bytexor">ft_ByteXor()</a></code>, <code><a href="#ft_bytenot">ft_ByteNot()</a></code>, <code><a href="#ft_byteneg">ft_ByteNeg()</a></code>, <code><a href="#ft_byteand">ft_ByteAnd()</a></code></div>
</section>

<section id="ft_bytexor">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/bytexor.txt">Improve this doc</a></span>
<h4><code>ft_ByteXor()</code></h4>
<div class="d-ol">Perform bit-wise XOR on two ASCII characters (bytes)</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_ByteXor( &lt;cByte1&gt;, &lt;cByte2&gt; ) &rarr; cNewByte</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cByte1&gt; and &lt;cByte2&gt; are characters from hb_BChar( 0 ) to hb_BChar( 255 ). May be passed in hb_BChar() form, as character literals, or as expressions evaluating to character values.</div>
<div class="d-d">Returns</div>
<div class="d-it">Returns resulting byte, as a string.  If parameters are faulty, returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Can be used for bit-wise byte manipulation.  In effect, this is a bit-by-bit XOR operation.  Equivalent to XOR assembler instruction.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c or .asm versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code performs a bit-wise XOR on two bytes represented
// by hb_BChar( 32 ) and hb_BChar( 55 ):

cNewByte := ft_ByteXor( hb_BChar( 32 ), hb_BChar( 55 ) )
? hb_BCode( cNewByte )     // result: 23
? cNewByte                 // result: non-printable character
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_byteor">ft_ByteOr()</a></code>, <code><a href="#ft_bytenot">ft_ByteNot()</a></code>, <code><a href="#ft_byteneg">ft_ByteNeg()</a></code>, <code><a href="#ft_byteand">ft_ByteAnd()</a></code></div>
</section>

<section id="ft_color2n">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/color2n.txt">Improve this doc</a></span>
<h4><code>ft_Color2N()</code></h4>
<div class="d-ol">Returns the numeric complement of a Clipper color string</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Color2N( &lt;cColor&gt; ) &rarr; nValue</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cColor&gt; is a Clipper color string</div>
<div class="d-d">Returns</div>
<div class="d-it">The numeric complement of a color string or 0 if passed color is invalid.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful when calling other functions that expect a numeric color parameter.  It is often more convenient to pass a converted color string than having to calculate or look up the corresponding number.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
nColor := ft_Color2N( &quot;gr+/b&quot; )         // returns 30

ft_SetAttr( 0, 0, 10, 10, nColor )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_n2color">ft_N2Color()</a></code></div>
</section>

<section id="ft_findith">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/findith.txt">Improve this doc</a></span>
<h4><code>ft_FindITh()</code></h4>
<div class="d-ol">Find the &quot;ith&quot; occurrence of a substring within a string</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_FindITh( &lt;cCheckFor&gt;, &lt;cCheckIn&gt;, &lt;nWhichOccurrence&gt; ;</code><code>[, &lt;lIgnoreCase&gt; ] ) &rarr; &lt;nStringPosition&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cCheckFor&gt; is the string to search for.</div>
  <div>&lt;cCheckIn&gt; is the string to search.</div>
  <div>&lt;nWhichOccurrence&gt; is the number of the occurrence to find.</div>
  <div>&lt;lIgnoreCase&gt; is a logical indicating if the search is to be case</div>
  <div>sensitive.  The default is no case sensitivity (.T.).</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The position in the string cCheckIn of the ith occurrence of cCheckFor.</div>
<div class="d-d">Description</div>
<div class="d-it">This function finds the position in a string of the &quot;ith&quot; time another string appears in it.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Find the Position in cMemoString of
// the 10th Occurrence of &quot;the&quot;, case
// insensitive

? ft_FindITh( &quot;the&quot;, cMemoString, 10 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_at2">ft_At2()</a></code></div>
</section>

<section id="ft_isbit">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/isbit.txt">Improve this doc</a></span>
<h4><code>ft_IsBit()</code></h4>
<div class="d-ol">Test the status of an individual bit</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_IsBit( &lt;cByte&gt;, &lt;nBitPos&gt; ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cByte&gt; is a character from hb_BChar( 0 ) to hb_BChar( 255 ).</div>
  <div>&lt;nBitPos&gt; is a number from 0 to 7 conforming to standard right-to-left</div>
  <div>bit-numbering convention and representing the position of the bit within the byte.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>.T. if designated bit is set (1), .F. if not set (0), NIL if</div>
  <div>invalid parameters.</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Tests for status of any selected bit in the byte passed as a parameter. Byte must be presented in hb_BChar() form, as a literal constant, or as the one-byte character result of an expression.</div>
  <div><p>This function is presented to illustrate that bit-wise operations are possible with Clipper code.  For greater speed, write .c versions and use the Clipper Extend system.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// This code tests whether bit 3 is set in the byte represented by
// hb_BChar( 107 ):

lBitflag := ft_IsBit( hb_BChar( 107 ), 3 )
? lBitflag                  // result: .T.

// This code tests whether bit 5 is set in the byte represented by ASCII
// 65 (letter &quot;A&quot;)

? ft_IsBit( &quot;A&quot;, 5 )        // result: .F.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_bitset">ft_BitSet()</a></code>, <code><a href="#ft_bitclr">ft_BitClr()</a></code></div>
</section>

<section id="ft_isbiton">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/isbiton.txt">Improve this doc</a></span>
<h4><code>ft_IsBitOn()</code></h4>
<div class="d-ol">Determine the state of individual bits in a number</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_IsBitOn( &lt;nNumber&gt;, &lt;nBit&gt; ) &rarr; lResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nNumber&gt; is an integer for which a bit state needs to be checked.</div>
  <div>&lt;nBit&gt; is a number from 0 to 15 that indicates which bit to test.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">.T. if the specified bit was on., .F. if off.</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful when dealing with binary integers.  It will come in very handy if you use the ft_int86() function, because the CPU flags are returned as a series of bits.  Using this function, you can determine the state of each CPU flag.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
IF ft_IsBitOn( nCPUFlags, 0 )
   ? &quot;The carry flag was set.&quot;
ENDIF

IF ft_IsBitOn( nCPUFlags, 7 )
   ? &quot;The sign flag was set.&quot;
ENDIF
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
</section>

<section id="ft_metaph">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/metaph.txt">Improve this doc</a></span>
<h4><code>ft_Metaph()</code></h4>
<div class="d-ol">Convert a character string to MetaPhone format</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Metaph( &lt;cName&gt; [, &lt;nSize&gt; ] ) &rarr; cMetaPhone</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cName&gt; is the character string to convert</div>
  <div>&lt;nSize&gt; is the length of the character string to be returned.</div>
  <div>If not specified the default length is 4 bytes.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">A phonetically spelled character string</div>
<div class="d-d">Description</div>
<div class="d-it">This function is a character function use to index and search for sound-alike or phonetic matches.  It is an alternative to the SoundEx() function, and addresses some basic pronunciation rules, by looking at surrounding letters to determine how parts of the string are pronounced.  ft_Metaph() will group sound-alikes together, and forgive shortcomings in spelling ability.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
USE persons
INDEX ON ft_Metaph( LastName ) TO lastname
SEEK ft_Metaph( &quot;Philmore&quot; )
? Found(), field-&gt;LastName       // Result: .T. Philmore
SEEK ft_Metaph( &quot;Fillmore&quot; )
? Found(), field-&gt;LastName       // Result: .T. Philmore
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
</section>

<section id="ft_n2color">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/n2color.txt">Improve this doc</a></span>
<h4><code>ft_N2Color()</code></h4>
<div class="d-ol">Returns the string complement of a Clipper color number</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Color2N( &lt;nColor&gt; ) &rarr; cColor</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nColor&gt; a number representing a Clipper color</div>
<div class="d-d">Returns</div>
<div class="d-it">The string complement of a number representing a Clipper or a null string if the parameter is invalid</div>
<div class="d-d">Description</div>
<div class="d-it">This function is useful for converting a number to a Clipper color string.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
? ft_Color2N( 239 )         // returns &quot;*+w/gr&quot;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_n2color">ft_N2Color()</a></code></div>
</section>

<section id="ft_nooccur">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/nooccur.txt">Improve this doc</a></span>
<h4><code>ft_NoOccur()</code></h4>
<div class="d-ol">Find the number of times one string occurs in another</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_NoOccur( &lt;cCheckFor&gt;, &lt;cCheckIn&gt; ;</code><code>[, &lt;lIgnoreCase&gt; ] ) &rarr; &lt;nOccurrences&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cCheckFor&gt; is the string to search for</div>
  <div>&lt;cCheckIn&gt; is the string to search</div>
  <div>&lt;lIgnoreCase&gt; is a boolean variable to force case sensitivity (optional, defaults to .T.).</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The number of times &lt;cCheckFor&gt; appears in &lt;cCheckIn&gt;</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function finds the number of times a string occurs in a</div>
  <div><p>second string.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Find the number of times &quot;the&quot; appears in cMemoString, case
// insensitive
? ft_NoOccur( &quot;the&quot;, cMemoString )

// Find the number of times &quot;the&quot; appears in cMemoString, case
// sensitive
? ft_NoOccur( &quot;the&quot;, cMemoString, .F. )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
</section>

<section id="ft_pchr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/pchr.txt">Improve this doc</a></span>
<h4><code>ft_PChr()</code></h4>
<div class="d-ol">Convert printer control codes</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_PChr( &lt;cString&gt; )  &rarr;  &lt;cPrinterFormat&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cString&gt; is the representation of the printer control codes in text, numeric, hexadecimal, Epson command format, or any combination separated by commas.</div>
<div class="d-d">Returns</div>
<div class="d-it">A character string of printer control codes.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is useful for allowing the user to enter printer control codes in text (enclosed in double quotes), numeric, hexadecimal, or Epson commands preceded by a slash and returns the printer control code equivalent.</div>
  <div><p>NOTES&quot;</div>
  <div><p>- Combinations of text, numbers, hex, and commands must be</div>
  <div><p>separated by commas (&quot;A&quot;,27,&amp;1B,/RESET).</div>
  <div><p>- Text must be enclosed in double quotes (&quot;x&quot;). - Hexadecimal must be preceded by an ampersand (&amp;1B). - Epson commands, listed below, must be preceded by a forward</div>
  <div><p>slash (/RESET).</div>
  <div><p>Epson commands: (slash commands are specific to the Epson)</div>
  <div><p>Job Control:</div>
  <div><p>/RESET or /INIT   Reset or initialize the printer /BELL  or /BEEP   Cause the printer's speaker to beep (not HS) /CAN              Clear print buffers (not MX) /SLOW             Set low speed mode (not CR, HS, MX) /FAST             Cancel low speed mode (not CR, HS, MX) /ONE              Select Unidirectional mode /TWO              Select Directional mode /ON               Activate printer /OFF              Turn off printer</div>
  <div><p>/FF or /EJECT     Form Feed</div>
  <div><p>Page Control:</div>
  <div><p>/1/6              Set 6 lines per inch /1/8              Set 8 lines per inch /SKIP             Set Skip perforation ON /SKIPOFF          Set Skip perforation OFF</div>
  <div><p>Font Selection and Manipulation:</div>
  <div><p>/ITALIC           Select italic char. set  (only FX86, EX, LX,</div>
  <div><p>no LQ-1500, SX)</div>
  <div><p>/GRAPHIC          Select graphic char. set (only FX86, EX, LX,</div>
  <div><p>no LQ-1500, SX)</div>
  <div><p>/ROMAN            Choose Roman font /SANS             Choose Sans Serif font /DRAFT            Choose draft /NLQ              Choose near letter quality /PICA             Choose 10 chars per inch /ELITE            Choose 12 chars per inch /COND or /SI      Choose 15 chars per inch /EMPH             Turn emphasize on /EMPHOFF          Turn emphasize off /SPANISH          Select spanish international char set /USA              Select USA international char set</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
SET PRINTER ON
cSetUp := &quot;27,116,1&quot;
? ft_PChr( cSetUp )        // -&gt; hb_BChar( 27 ) + hb_BChar( 116 ) + hb_BChar( 1 )
                           //     &lt;select Epson char. graphics&gt;

? ft_PChr( '27,&quot;x&quot;,0' )    // -&gt; hb_BChar( 27 ) + hb_BChar( 120 ) + hb_BChar( 0 )
                           //     &lt;Epson draft mode&gt;

? ft_PChr( '&amp;1B,&quot;E&quot;'  )    // -&gt; hb_BChar( 27 ) + hb_BChar( 69 )
                           //     &lt;HP reset&gt;

? ft_PChr( &quot;/ELITE,/NLQ&quot; ) // -&gt; hb_BChar( 27 ) + hb_BChar( 77 ) + ;
                           //    hb_BChar( 27 ) + hb_BChar( 120 ) + hb_BChar( 1 )
                           //     &lt;Epson elite &amp; near letter quality&gt;
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
</section>

<section id="ft_proper">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/proper.txt">Improve this doc</a></span>
<h4><code>ft_Proper()</code></h4>
<div class="d-ol">Convert a string to proper-name case</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Proper( &lt;cString&gt; ) &rarr; cProperName</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;cString&gt; is the string to be converted.</div>
<div class="d-d">Returns</div>
<div class="d-it">A string of the same length as &lt;cString&gt;, only converted to proper name case (upper/lower case).</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_Proper() uses a brute-force algorithm to convert a string to propername case.  First, it capitalizes the first letter of all words starting after a blank, dash, or apostrophe.  This catches most names, including special cases such as names beginning with O' (O'Malley, O'Reilly) and hyphenated names (such as Susan Chia-Mei Lo).</div>
  <div><p>Next, it does a specific adjustment for words beginning in &quot;Mc&quot; It finds the first 'Mc' and capitalizes the next character after it.  It does this for all occurrences of Mc.</div>
  <div><p>The original ft_Proper() was written in Clipper by Glenn Scott and Mark Zechiel; it was re-written in C (and thus, optimized and enhanced) by Robert DiFalco.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
PROCEDURE Main( cStr )
   ? ft_Proper( cStr )
   RETURN
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
</section>

<section id="ft_rat2">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/at2.txt">Improve this doc</a></span>
<h4><code>ft_RAt2()</code></h4>
<div class="d-ol">Find position of the reversed nth occurrence of a substring</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RAt2( &lt;cSearch&gt;, &lt;cTarget&gt; [, &lt;nOccurs&gt; [, &lt;lCaseSens&gt; ] ] ) &rarr; nPos</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cSearch&gt; is the character substring to search for.</div>
  <div>&lt;cTarget&gt; is the character string to search.</div>
  <div>&lt;nOccurs&gt; is the occurrence of cSearch to look for,</div>
  <div>defaults to 1.</div>
  <div>&lt;lCaseSens&gt; is a logical value denoting case sensitivity.</div>
  <div>If .F., then search is NOT sensitive to case, defaults to .T.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">The position of the nth occurrence of a reversed substring</div>
<div class="d-d">Description</div>
<div class="d-it">This function will find the nth occurrence of a reversed substring within a string.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
cSearch := &quot;t&quot;
cTarget := &quot;This is the day that the Lord has made.&quot;

? ft_RAt2( cSearch, cTarget )           // Returns 22
? ft_RAt2( cSearch, cTarget, 2 )        // Returns 20
? ft_RAt2( cSearch, cTarget, 2, .F. )   // Returns 22
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">String</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_findith">ft_FindITh()</a></code>, <code><a href="#ft_at2">ft_At2()</a></code></div>
</section>

<section id="ft_adapter">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/adapter.txt">Improve this doc</a></span>
<h4><code>ft_Adapter()</code></h4>
<div class="d-ol">Report the type of video adapter installed</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Adapter() &rarr; nResult</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>Integer representing type of video adapter</div>
  <div>0 - monochrome 1 - CGA 2 - EGA 3 - VGA</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is valuable if you use a graphics library and need to know what type of graphics adapter is installed.</div>
  <div><p>The source code is written to adhere to Turbo Assembler's IDEAL mode. To use another assembler, you will need to rearrange the PROC and SEGMENT directives, and also the ENDP and ENDS directives (a very minor task).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
iVideo := ft_Adapter()

DO CASE
CASE iVideo == 0
   ? &quot;You have a monochrome adapter.&quot;
CASE iVideo == 1
   ? &quot;You have a CGA adapter.&quot;
CASE iVideo == 2
   ? &quot;You have an EGA adapter.&quot;
CASE iVideo == 3
   ? &quot;You have a VGA adapter.&quot;
ENDCASE
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_setmode">ft_SetMode()</a></code></div>
</section>

<section id="ft_cls">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/video1.txt">Improve this doc</a></span>
<h4><code>ft_CLS()</code></h4>
<div class="d-ol">Clear screen</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_CLS( &lt;nTRow&gt;, &lt;nLCol&gt;, &lt;nBRow&gt;, &lt;nRCol&gt;, &lt;nColor&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nTRow&gt;, &lt;nLCol&gt;, &lt;nBRow&gt; and  &lt;nRCol&gt; are the screen coordinates to clear.</div>
  <div>&lt;nColor&gt; is an integer representing the color attribute. The formula is:</div>
  <div>nFore + ( nBack * 16 )</div>
  <div>The default is black.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This is a high speed function to clear the screen at the given coordinates with the given color attribute.  This does not change Clipper's color settings.  It uses direct video writes for speed.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_CLS( 0, 0, MaxRow(), MaxCol(), 165 )

// This example will clear the entire screen with the colors
// bright white on magenta.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_getmode">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/vidmode.txt">Improve this doc</a></span>
<h4><code>ft_GetMode()</code></h4>
<div class="d-ol">Get the video mode</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_GetMode() &rarr; nVMode</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None.</div>
<div class="d-d">Returns</div>
<div class="d-it">The video mode, as a numeric.</div>
<div class="d-d">Description</div>
<div class="d-it">Use this function to find out what mode your display adapter is in. Uses DOS interrupt 10h to get the mode.  For a table of modes available on various graphics adapters, refer to a book such as Wilton's &quot;Programmer's Guide to PC &amp; PS/2 Video Systems&quot; (Microsoft Press)</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
PROCEDURE Main( cMode )
   ft_SetMode( Val( cMode ) )
   ? &quot;Video mode is:&quot;, ft_GetMode()
   RETURN
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_getvcur">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/vidcur.txt">Improve this doc</a></span>
<h4><code>ft_GetVCur()</code></h4>
<div class="d-ol">Return info about the cursor on a specified video page</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_GetVCur( [&lt;nPage&gt;] ) &rarr; &lt;aCurInfo&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nPage&gt; is the video page to get the cursor information for. Defaults to the current page, as returned by ft_GetVPg().</div>
<div class="d-d">Returns</div>
<div class="d-it">
  <div>A four-element array (&lt;aCurInfo&gt;), set up as follows:</div>
  <div>aCurInfo[ 1 ] = Top line of cursor aCurInfo[ 2 ] = Bottom line of cursor aCurInfo[ 3 ] = Character row aCurInfo[ 4 ] = Character column</div>
</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_GetVCur() uses ft_int86() to invoke interrupt 10h, function 3, to return the character cursor location for the specified video page.</div>
  <div><p>The top line and bottom line of cursor are set depending on the current cursor mode, and are only meaningful in alphanumeric video modes.</div>
  <div><p>For more information on graphics programming, cursors, and cursor modes, refer to Richard Wilton's <i>Programmer's Guide to PC and PS/2 Video Systems</i> (Microsoft Press).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
aCurInfo := getVCur( 1 )    // Get info on cursor pos in page 1
? &quot;Row:&quot;, aCurInfo[ 3 ], &quot; Col:&quot;, aCurInfo[ 4 ]
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_getvpg">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/page.txt">Improve this doc</a></span>
<h4><code>ft_GetVPg()</code></h4>
<div class="d-ol">Get the currently selected video page</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_GetVPg() &rarr; &lt;nPage&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None.</div>
<div class="d-d">Returns</div>
<div class="d-it">The video page, as a numeric.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Get the currently selected video page</div>
  <div><p>For more information on graphics programming and video pages, consult a reference such as <i>Programmer's Guide to PC and PS/2 Video Systems</i> (Microsoft Press).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
nPage := ft_GetVPg()
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_setvpg">ft_SetVPg()</a></code></div>
</section>

<section id="ft_popvid">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/pvid.txt">Improve this doc</a></span>
<h4><code>ft_PopVid()</code></h4>
<div class="d-ol">Restore previously saved video states.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_PopVid() &rarr; &lt;nStackSize&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">The number of items remaining in the internal stack.</div>
<div class="d-d">Description</div>
<div class="d-it">This is the complementary function to ft_PushVid().  At some time after saving the video states it will probably be necessary to restore them.  This is done by restoring the settings from the last call to ft_PushVid().  The number of items on the internal stack is then reduced by one.  Note that the use of stack logic means that items on the stack are retrieved in Last In First Out order.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_PopVid()          // Restore video states
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_pushvid">ft_PushVid()</a></code></div>
</section>

<section id="ft_pushvid">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/pvid.txt">Improve this doc</a></span>
<h4><code>ft_PushVid()</code></h4>
<div class="d-ol">Save current video states on internal stack.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_PushVid() &rarr; &lt;nStackSize&gt;</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">None</div>
<div class="d-d">Returns</div>
<div class="d-it">The current size of the internal stack (i.e. the number of times ft_PushVid() has been called).</div>
<div class="d-d">Description</div>
<div class="d-it">Menus, picklists, browses, and other video-intensive items often require you to save certain video states -- screen image, cursor position, and so forth.  Constantly saving and restoring these items can get very tedious.  This function attempts to alleviate this problem.  When called, it saves the cursor position, color setting, screen image, cursor style, blink setting, scoreboard setting, snow setting, and maximum row and column to a series of static arrays.  All that is needed to restore the saved settings is a call to ft_PopVid().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_PushVid()          // Save the current video states
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_popvid">ft_PopVid()</a></code></div>
</section>

<section id="ft_restatt">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/ftattr.txt">Improve this doc</a></span>
<h4><code>ft_RestAtt()</code></h4>
<div class="d-ol">Restore the attribute bytes of a specified screen region.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RestAtt( &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt;, &lt;cAttributes&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, and &lt;nRight&gt; define the screen region. &lt;cAttributes&gt; is a character string containing the attribute bytes</div>
  <div>for the screen region.  This will most often be a string previously returned by ft_SaveAtt(), but any character string may be used (provided it is of the proper size).</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is similar to Clipper's RestScreen(), except that it only restores the attribute bytes.  This is useful if you want to change the screen color without affecting the text.</div>
  <div><p><strong>*</strong> INTERNALS ALERT <strong>*</strong></div>
  <div><p>This function calls the Clipper internals __gtSave and __gtRest to manipulate the the screen image.  If you're too gutless to use internals, then this function isn't for you.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Restore attributes of row 4
ft_RestAtt( 4, 0, 4, MaxCol(), cBuffer )

// Restore attributes to middle of screen
ft_RestAtt( 10, 20, 14, 59, cBuffer )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_saveatt">ft_SaveAtt()</a></code></div>
</section>

<section id="ft_revattr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/video1.txt">Improve this doc</a></span>
<h4><code>ft_RevAttr()</code></h4>
<div class="d-ol">Reverse colors of specified screen coordinates</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RevAttr( &lt;nTRow&gt;, &lt;nLCol&gt;, &lt;nBRow&gt;, &lt;nRCol&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nTRow&gt;, &lt;nLCol&gt;, &lt;nBRow&gt;, and &lt;nRCol&gt; are the coordinates of the screen region.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This is a high speed function to reverse the color of a specified screen region without disturbing any text on the screen.  This function will correctly reverse the color attributes in a region containing multiple color combinations.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_RevAttr( 0, 0, MaxRow(), MaxCol() )

// This example will change the entire screen's colors to their reverse
// attributes without changing  or overwriting any text.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_revchr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/video1.txt">Improve this doc</a></span>
<h4><code>ft_RevChr()</code></h4>
<div class="d-ol">Reverse the color of a single character on the screen</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RevChr( &lt;nTRow&gt;, &lt;nLCol&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nTRow&gt;, &lt;nLCol&gt; are the screen coordinates of the character.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This is a high speed function to reverse the color of a single character on the screen without changing the character itself. This function is the same as ft_RevAttr() except that it changes only one character on screen and hence is faster and uses less memory.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_RevChr( 10, 20 )

// This example will change the text and background at 10, 20 to it's
// reverse color attributes without changing or overwriting the
// character itself.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_rgnstack">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/scregion.txt">Improve this doc</a></span>
<h4><code>ft_RgnStack()</code></h4>
<div class="d-ol">Push or pop a saved screen region on or off the stack</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RgnStack( &lt;cAction&gt;, [ &lt;nTop&gt; ], [ &lt;nLeft&gt; ], [ &lt;nBottom&gt; ],</code><code>[ &lt;nRight&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cAction&gt; determines what action ft_RgnStack() will take.  The allowable values for this parameter are &quot;push&quot;, &quot;pop&quot;, and &quot;pop all&quot;. If the function is called with any other string as the first parameter no action is performed.</div>
  <div>&lt;cAction&gt; with a value of &quot;push&quot; will push a saved screen region onto the stack.  A value of &quot;pop&quot; will restore the most recently pushed screen region.  &quot;pop all&quot; tells the function to restore all screen images which are currently on the stack.</div>
  <div>The use of &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, and &lt;nRight&gt; depends on the &lt;cAction&gt; parameter.  If &lt;cAction&gt; is &quot;push&quot;, the next four parameters define the screen region to save.  If &lt;cAction&gt; is &quot;pop&quot; or &quot;pop all&quot; the following four parameters are ignored.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">ft_RgnStack() returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_RgnStack() allows multiple screens to be saved and restored from a stack.  The stack is implemented with Clipper static array that is visible only to ft_RgnStack().</div>
  <div><p>The purpose of ft_RgnStack() is to allow multiple screen regions to be managed without the need to remember the original coordinates or to create variables for each one.</div>
  <div><p>When called with &quot;push&quot;, ft_RgnStack() places the saved screen area at the end of the static array.  The array size is incremented by one to accommodate the new screen area.</div>
  <div><p>When called with &quot;pop&quot;, the function restores the screen image stored in the last element of the array, and the array size is decremented by one.  If &quot;pop all&quot; is specified, all the saved screens are restored until the array is empty.</div>
  <div><p>ft_RgnStack() calls ft_SavRgn() and ft_RstRgn().  Refer to the documentation for these two functions for more information.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following example uses ft_RgnStack() to save and restore various
// sections of the screen.

@ 0, 0, 24, 79 BOX &quot;111111111&quot;             // fill the screen with 1's
ft_RgnStack( &quot;push&quot;, 10,  5, 15, 15 )      // push a region
@ 0, 0, 24, 79 BOX &quot;222222222&quot;             // fill the screen with 2's
ft_RgnStack( &quot;push&quot;, 10, 20, 15, 30 )      // push a region
@ 0, 0, 24, 79 BOX &quot;333333333&quot;             // fill the screen with 3's
ft_RgnStack( &quot;push&quot;, 10, 35, 15, 45 )      // push a region
@ 0, 0, 24, 79 BOX &quot;444444444&quot;             // fill the screen with 4's
ft_RgnStack( &quot;push&quot;, 10, 50, 15, 60 )      // push a region
@ 0, 0, 24, 79 BOX &quot;555555555&quot;             // fill the screen with 5's
ft_RgnStack( &quot;push&quot;, 10, 65, 15, 75 )      // push a region
CLEAR
ft_RgnStack( &quot;pop&quot; )        // restore the 5's region
ft_RgnStack( &quot;pop&quot; )        // restore the 4's region
ft_RgnStack( &quot;pop all&quot; )    // restore the 3's, 2's and 1's regions
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_savrgn">ft_SavRgn()</a></code>, <code><a href="#ft_rstrgn">ft_RstRgn()</a></code></div>
</section>

<section id="ft_rstrgn">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/scregion.txt">Improve this doc</a></span>
<h4><code>ft_RstRgn()</code></h4>
<div class="d-ol">Restore region of the screen saved with ft_SavRgn()</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_RstRgn( &lt;cScreen&gt;, [ &lt;nTop&gt; ], [ &lt;nLeft&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;cScreen&gt; is a screen region previously returned from ft_SavRgn().</div>
  <div>&lt;nTop&gt; and &lt;nLeft&gt; are optional parameters that define a new location for the upper left corner of the screen area contained in &lt;cScreen&gt;. Allowable values are 0 through 255.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">ft_RstRgn() returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_RstRgn() restores a screen region previously saved with ft_SavRgn().  Calling ft_RstRgn() with &lt;cScreen&gt; as the only parameter will restore the saved region to its original location. &lt;nTop&gt; and &lt;nLeft&gt; may be used to define a new location for the upper left corner of the saved region.</div>
  <div><p>&lt;nTop&gt; and &lt;nLeft&gt; are dependent upon each other. You may not specify one without the other.</div>
  <div><p>ft_RstRgn() calls Clipper's RestScreen().  Refer to the Clipper documentation for more information regarding this function.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following example uses ft_RstRgn() to restore a saved portion
// of the screen to different locations.

@ 0, 0, 24, 79 BOX &quot;111111111&quot;         // fill the screen with 1's
cScreen := ft_SavRgn( 10, 10, 20, 30 ) // save a region
@ 0, 0, 24, 79 BOX &quot;222222222&quot;         // fill the screen with 2's
ft_RstRgn( cScreen )                   // restore the 1's region
@ 0, 0, 24, 79 BOX &quot;222222222&quot;         // fill the screen with 2's
ft_RstRgn( cScreen, 15, 15 )           // restore to a different location
@ 0, 0, 24, 79 BOX &quot;222222222&quot;         // fill the screen with 2's
ft_RstRgn( cScreen, 20, 60 )           // restore to a different location
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_savrgn">ft_SavRgn()</a></code>, <code><a href="#ft_rgnstack">ft_RgnStack()</a></code></div>
</section>

<section id="ft_saveatt">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/ftattr.txt">Improve this doc</a></span>
<h4><code>ft_SaveAtt()</code></h4>
<div class="d-ol">Save the attribute bytes of a specified screen region.</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SaveAtt( &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt; ) &rarr; cAttributes</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, and &lt;nRight&gt; define the screen region.</div>
<div class="d-d">Returns</div>
<div class="d-it">A character string containing the screen attribute bytes for the specified region.  If the memory to store the return value could not be allocated, the function returns NIL.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function is similar to Clipper's SaveScreen(), except that it only saves the attribute bytes.  This is useful if you want to change the screen color without affecting the text.</div>
  <div><p><strong>*</strong> INTERNALS ALERT <strong>*</strong></div>
  <div><p>This function calls the Clipper internal __gtMaxCol to obtain the maximum column value for the current video mode.  If you're too gutless to use internals, then this function isn't for you.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Save attributes of row 4
cBuffer := ft_SaveAtt( 4, 0, 4, MaxCol() )

// Save attributes from middle of screen
cBuffer := ft_SaveAtt( 10, 20, 14, 59 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_restatt">ft_RestAtt()</a></code></div>
</section>

<section id="ft_savrgn">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/scregion.txt">Improve this doc</a></span>
<h4><code>ft_SavRgn()</code></h4>
<div class="d-ol">Save a screen region for later display</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SavRgn( &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt; ) &rarr; cScreen</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, and &lt;nRight&gt; define the portion of the screen to save.  Allowable values are 0 through 255.</div>
<div class="d-d">Returns</div>
<div class="d-it">ft_SavRgn() returns the saved screen region and its coordinates as a character string.</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_SavRgn() is similar to Clipper's SaveScreen(), but it saves the screen coordinates as well as the display information.  The saved area can be restored by passing the returned string to ft_RstRgn().</div>
  <div><p>Note that the strings returned from ft_SavRgn() and Clipper's SaveScreen() are not interchangeable.  A screen region saved with with ft_SavRgn() must be restored using ft_RstRgn().</div>
  <div><p>ft_SavRgn() calls Clipper's SaveScreen().  Refer to the Clipper documentation for more information regarding this function.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following example uses ft_SavRgn() and ft_RstRgn() to save
// and restore a portion of the screen.

@ 0, 0, 24, 79 BOX &quot;111111111&quot;          // fill the screen with 1's
cScreen := ft_SavRgn( 10, 10, 20, 30 )  // save a region
@ 0, 0, 24, 79 BOX &quot;222222222&quot;          // fill the screen with 2's
ft_RstRgn( cScreen )                    // restore the 1's region
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_rstrgn">ft_RstRgn()</a></code>, <code><a href="#ft_rgnstack">ft_RgnStack()</a></code></div>
</section>

<section id="ft_setattr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/video1.txt">Improve this doc</a></span>
<h4><code>ft_SetAttr()</code></h4>
<div class="d-ol">Change color attributes of screen region</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetAttr( &lt;nTRow&gt;, &lt;nLCol&gt;, &lt;nBRow&gt;, &lt;nRCol&gt;, &lt;nColor&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nTRow&gt;, &lt;nLCol&gt;, &lt;nBRow&gt;, and &lt;nRCol&gt; are the coordinates of the screen region.</div>
  <div>&lt;nColor&gt; is an integer representing the new color attribute. The formula is:</div>
  <div>nFore + ( nBack * 16 )</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This is a high speed function to change the colors of a specified region of the screen without disturbing any text.  Uses direct video writes.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_SetAttr( 0, 0, MaxRow(), MaxCol(), 95 )

// This example will change the entire screen's colors to bright white on
// magenta without changing or overwriting any text on the screen.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_setmode">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/vidmode.txt">Improve this doc</a></span>
<h4><code>ft_SetMode()</code></h4>
<div class="d-ol">Set the video mode</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetMode( &lt;nMode&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nMode&gt; is one of the DOS video modes.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">Use this function to put your display adapter into a video mode. Uses DOS interrupt 10h to set the mode.  For a table of modes available on various graphics adapters, refer to a book such as Wilton's &quot;Programmer's Guide to PC &amp; PS/2 Video Systems&quot; (Microsoft Press)</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
PROCEDURE Main( cMode )
   ft_SetMode( Val( cMode ) )
   ? &quot;Video mode is:&quot;, ft_GetMode()
   RETURN
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_adapter">ft_Adapter()</a></code></div>
</section>

<section id="ft_setvcur">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/vidcur.txt">Improve this doc</a></span>
<h4><code>ft_SetVCur()</code></h4>
<div class="d-ol">Set the cursor position on a specified video page</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetVCur( [ &lt;nPage&gt; ], [ &lt;nRow&gt; ], [ &lt;nCol&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nPage&gt; is the video page (defaults to current page, determined</div>
  <div>by ft_GetVPg()</div>
  <div>&lt;nRow&gt;  is the row coordinate (defaults to 0 )</div>
  <div>&lt;nCol&gt;  is the column coordinate (defaults to 0 )</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>ft_SetVCur() sets the cursor position on a specific video page. It uses ft_int86() to invoke interrupt 10h, function 2.</div>
  <div><p>For more information on graphics programming, cursors, and video pages, refer to Richard Wilton's <i>Programmer's Guide to PC and PS/2 Video Systems</i> (Microsoft Press).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// Set the position to row 5, column 10 on video page 1:

ft_SetVCur( 1, 5, 10 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_setvpg">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/page.txt">Improve this doc</a></span>
<h4><code>ft_SetVPg()</code></h4>
<div class="d-ol">Set the current video page</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_SetVPg( &lt;nPage&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">&lt;nMode&gt; is a valid video page.</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>Selects the video page.</div>
  <div><p>For more information on graphics programming and video pages, consult a reference such as &quot;Programmer's Guide to PC and PS/2 Video Systems&quot; (Microsoft Press).</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
// The following sets the current video page to 1

ft_SetVPg( 1 )
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
<div class="d-d">See also</div>
<div class="d-it"><code><a href="#ft_getvpg">ft_GetVPg()</a></code></div>
</section>

<section id="ft_shadow">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/shadow.txt">Improve this doc</a></span>
<h4><code>ft_Shadow()</code></h4>
<div class="d-ol">Draw a non-destructive shadow on the screen</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_Shadow( &lt;nTop&gt;, &lt;nLeft&gt;, &lt;nBottom&gt;, &lt;nRight&gt; [ ,&lt;nAttr&gt;] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nTop&gt;    is the top row of the shadow area. &lt;nLeft&gt;   is the upper left column of the shadow area. &lt;nBottom&gt; is the bottom row of the shadow area. &lt;nRight&gt;  is the lower right column of the shadow area. &lt;nAttr&gt;   is optional and is the screen attribute to use for drawing</div>
  <div>the shadow.  If not specified, the default is 8.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">
  <div><p>This function allows you to implement the popular &quot;shadow effect.&quot;  It draws a shadow using the specified screen coordinates.  The shadow is drawn along the bottom and right side of the specified region.</div>
  <div><p>The source code is written to TASM IDEAL mode.</div>
</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_Shadow( 10, 10, 15, 50, 8 )   // draw a dim shadow

ft_Shadow( 10, 10, 15, 40, 47 )  // draw a green shadow
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_vidstr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/video1.txt">Improve this doc</a></span>
<h4><code>ft_VidStr()</code></h4>
<div class="d-ol">Display string on screen in specified attribute</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_VidStr( &lt;nRow&gt;, &lt;nCol&gt;, &lt;cString&gt; [, &lt;nColor&gt; ] ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nRow&gt; and &lt;nCol&gt; are the screen coordinates.</div>
  <div>&lt;cString&gt; is the string to be printed on the screen.</div>
  <div>&lt;nColor&gt; is an integer representing the color attribute. The formula is:</div>
  <div>nFore + ( nBack * 16 )</div>
  <div>ft_VidStr() will display the string in the current color if &lt;nColor&gt; is not passed.</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This is a high speed function to display a string of any ASCII characters on screen in a specified color attribute.  This function is useful for constructing screens with a lot of text or repetitive screen prints where speed is important.</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
ft_VidStr( 10, 20, &quot;Enter Name :&quot;, 165 )

// This example will print the specified text at coordinates 10, 20
// in bright white on top of Magenta.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

<section id="ft_wrtchr">
<span class="entry-button"><a href="#">Top</a> | <a href="index.html">Index</a> | <a href="https://github.com/vszakats/harbour-core/edit/master/contrib/hbnf/doc/en/video1.txt">Improve this doc</a></span>
<h4><code>ft_WrtChr()</code></h4>
<div class="d-ol">Display character on screen</div>
<div class="d-d">Syntax</div>
<div class="d-it"><code>ft_WrtChr( &lt;nRow&gt;, &lt;nCol&gt;, &lt;cChar&gt;, &lt;nColor&gt; ) &rarr; NIL</code></div>
<div class="d-d">Argument(s)</div>
<div class="d-it">
  <div>&lt;nRow&gt; and &lt;nCol&gt; are the screen coordinates.</div>
  <div>&lt;cChar&gt; is the single character to print on the screen.</div>
  <div>&lt;nColor&gt; is an integer representing the color attribute. The formula is:</div>
  <div>nFore + ( nBack * 16 )</div>
</div>
<div class="d-d">Returns</div>
<div class="d-it">NIL</div>
<div class="d-d">Description</div>
<div class="d-it">This is a high speed function to display a single ASCII character on screen in a specified color attribute.  This function is useful for constructing screens with a lot of text or repetitive screen prints where speed is important.  It is faster and requires less memory than ft_VidStr().</div>
<div class="d-d">Example(s)</div>
<pre class="d-ex">
FOR nX := 1 TO MaxRow()
   FOR nY := 1 TO MaxCol()
      ft_WrtChr( nX, nY, &quot;∙&quot;, ( nX - 1 ) + ( nY * 16 ) )
   NEXT
NEXT

This example will write the ASCII character 249 TO every location
ON SCREEN in every possible COLOR combination.  It will recognize
the status of SetBlink().  It uses direct video writes FOR speed.
</pre>
<div class="d-d">Tag(s)</div>
<div class="d-it">Video</div>
</section>

</main>

<footer>
<div>Generated by hbdoc on 2016-10-28 16:15 UTC</div>
<div>Based on revision <a href="https://github.com/vszakats/harbour-core/tree/9b82cba">9b82cba</a></div>
</footer>
